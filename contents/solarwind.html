<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>20&nbsp; Solar Wind – Key Notes in Plasma Physics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../contents/shock.html" rel="next">
<link href="../contents/geometry.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark-b53751a350365c71b6c909e95f209ed1.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-a34d670291f06f286357e447776a572a.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark-eeb65414527888753efd28190bdf447d.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../contents/solarwind.html"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Solar Wind</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Key Notes in Plasma Physics</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/henry2004y/KeyNotes/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/about.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">About</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/math.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Math</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/theoretical_mechanics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Theoretical Mechanics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/relativity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Relativity</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/unit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Unit Conversion</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/single.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Single-Particle Motions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/fluid.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Plasmas as Fluid</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/diffres.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Diffusion and Resisvity</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/wave.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Waves</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/emhd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">EMHD</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/kinetic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Kinetic Theory</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/stability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Stability</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/kmhd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Kinetic MHD</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/gyrokinetics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Gyrokinetics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/flr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Field Line Resonance</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/nonlinear.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Nonlinear Effects</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/turbulence.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Turbulence</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/geometry.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Geometry</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/solarwind.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Solar Wind</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/shock.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Shock</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/magnetosphere.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Magnetosphere</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/ionosphere.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Ionosphere</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/radiationbelt.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Radiation Belt</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/aurora.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Aurora</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/gc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Guiding Center</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/cr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Cosmic Ray</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/boundary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Boundary Conditions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/pic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Particle-in-Cell</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/hybrid.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Hybrid Methods</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/raytracing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Ray Tracing</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Tests</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/inductance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Inductance</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/capacitance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Capacitance</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/appendix.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Appendix</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">References</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#parker-solar-wind-model" id="toc-parker-solar-wind-model" class="nav-link active" data-scroll-target="#parker-solar-wind-model"><span class="header-section-number">20.1</span> Parker Solar Wind Model</a></li>
  <li><a href="#parker-spiral" id="toc-parker-spiral" class="nav-link" data-scroll-target="#parker-spiral"><span class="header-section-number">20.2</span> Parker Spiral</a></li>
  <li><a href="#anisotropy-in-the-solar-wind" id="toc-anisotropy-in-the-solar-wind" class="nav-link" data-scroll-target="#anisotropy-in-the-solar-wind"><span class="header-section-number">20.3</span> Anisotropy in the Solar Wind</a></li>
  <li><a href="#switchbacks" id="toc-switchbacks" class="nav-link" data-scroll-target="#switchbacks"><span class="header-section-number">20.4</span> Switchbacks</a></li>
  <li><a href="#mhd-description" id="toc-mhd-description" class="nav-link" data-scroll-target="#mhd-description"><span class="header-section-number">20.5</span> MHD Description</a></li>
  <li><a href="#wave-modes-in-the-solar-wind" id="toc-wave-modes-in-the-solar-wind" class="nav-link" data-scroll-target="#wave-modes-in-the-solar-wind"><span class="header-section-number">20.6</span> Wave Modes in the Solar Wind</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/henry2004y/KeyNotes/edit/master/contents/solarwind.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-solarwind" class="quarto-section-identifier"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Solar Wind</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>The <em>solar wind</em> is a high-speed particle stream continuously blown out from the Sun into interplanetary space. It extends far beyond the orbit of the Earth, and terminates in a shock front, called the heliopause, where it interfaces with the weakly ionized interstellar medium. The heliopause is predicted to lie between 110 and 160 AU (1 Astronomical Unit is <span class="math inline">\(1.5\times 10^{11}\)</span>m) from the center of the Sun. Voyager 1 &amp; 2, which were launched in 1977, have passed through the heliopause, and are still functional!</p>
<p>In the vicinity of the Earth, (i.e., at about 1 AU from the Sun) the solar wind velocity typically ranges between 300 and 1400 <span class="math inline">\(\mathrm{km}\,\mathrm{s}^{-1}\)</span>. The average value is approximately <span class="math inline">\(500\,\mathrm{km}\,\mathrm{s}^{-1}\)</span>, which corresponds to about a 4 day time of flight from the Sun. Note that the solar wind is both <em>super-sonic</em> and <em>super-Alfvénic</em>.</p>
<p>The solar wind is predominately composed of protons and electrons. Generally helium (<span class="math inline">\(\mathrm{He}^{++}\)</span>) is about 4%, and oxygen (<span class="math inline">\(\mathrm{O}^+\)</span>) is less than 1%.</p>
<p>Amazingly enough, the solar wind was predicted theoretically by Eugine Parker in 1958, a number of years before its existence was confirmed using satellite data. Parker’s prediction of a super-sonic outflow of gas from the Sun is a fascinating scientific detective story, as well as a wonderful application of plasma physics.</p>
<p>The solar wind originates from the solar corona. The solar corona is a hot, tenuous plasma surrounding the Sun, with characteristic temperatures and particle densities of about <span class="math inline">\(10^6\)</span>K and <span class="math inline">\(10^{14}\,\mathrm{m}^{-3}\)</span>, respectively. Note that the corona is <em>far hotter</em> than the solar atmosphere, or photosphere. In fact, the temperature of the photosphere is only about 6000 K. It is thought that the corona is heated by Alfvén waves emanating from the photosphere together with a turbulent cascading process. The solar corona is most easily observed during a total solar eclipse, when it is visible as a white filamentary region immediately surrounding the Sun.</p>
<p>Let us start, following Chapman, by attempting to construct a model for a static solar corona. The equation of hydrostatic equilibrium for the corona takes the form <span id="eq-corona_static"><span class="math display">\[
\frac{\mathrm{d}p}{\mathrm{d}r} = - \rho\,\frac{G\,M_\odot}{r^2}
\tag{20.1}\]</span></span> where <span class="math inline">\(G= 6.67\times 10^{-11}\,\mathrm{m}^{3}\,\mathrm{s}^{-2}\,\mathrm{kg}^{-1}\)</span> is the gravitational constant, and <span class="math inline">\(M_\odot=2\times 10^{30}\,\mathrm{kg}\)</span> is the solar mass. The plasma density is written <span id="eq-corona_mass_density"><span class="math display">\[
\rho\simeq n\,m_p
\tag{20.2}\]</span></span> where <span class="math inline">\(n\)</span> is the number density of protons. If both protons and electrons are assumed to possess a common temperature, <span class="math inline">\(T(r)\)</span>, then the coronal pressure is given by <span id="eq-corona_pressure_constT"><span class="math display">\[
p = 2nk_B T
\tag{20.3}\]</span></span></p>
<p>The thermal conductivity of the corona is dominated by the electron thermal conductivity, and takes the form (???) <span class="math display">\[
\kappa = \kappa_0\,T^{5/2}
\]</span> where <span class="math inline">\(\kappa_0\)</span> is a relatively weak function of density and temperature. For typical coronal conditions this conductivity is extremely high: i.e., it is about twenty times the thermal conductivity of copper at room temperature. The coronal heat flux density is written <span class="math display">\[
\mathbf{q} = -\kappa\nabla T
\]</span></p>
<p>For a static corona, in the absence of energy sources or sinks, we require <span class="math display">\[
\nabla\cdot\mathbf{q} = 0
\]</span></p>
<p>Assuming spherical symmetry, this expression reduces to <span class="math display">\[
\frac{1}{r^2}\frac{\mathrm{d}}{\mathrm{d}r}\left(r^2\kappa_0\, k_B T^{5/2}\,\frac{dT}{\mathrm{d}r}\right) =0
\]</span></p>
<p>Adopting the sensible boundary condition that the coronal temperature must tend to zero at large distances from the Sun, we obtain <span id="eq-corona_T_static"><span class="math display">\[
T(r) = T(a)\left(\frac{a}{r}\right)^{2/7}
\tag{20.4}\]</span></span></p>
<p>The reference level <span class="math inline">\(r=a\)</span> is conveniently taken to be the base of the corona, where <span class="math inline">\(a\sim 7\times 10^5\,\mathrm{km}\)</span>, <span class="math inline">\(n\sim 2\times 10^{14}\,\mathrm{m}^{-3}\)</span>, and <span class="math inline">\(T\sim 2\times 10^{6}\)</span>K.</p>
<p><a href="#eq-corona_static" class="quarto-xref">Equation&nbsp;<span>20.1</span></a>, <a href="#eq-corona_mass_density" class="quarto-xref">Equation&nbsp;<span>20.2</span></a>, <a href="#eq-corona_pressure_constT" class="quarto-xref">Equation&nbsp;<span>20.3</span></a>, and <a href="#eq-corona_T_static" class="quarto-xref">Equation&nbsp;<span>20.4</span></a> can be combined and integrated to give <span class="math display">\[
p(r) = p(a) \exp\left\{\frac{7}{5}\,\frac{G\,M_\odot\,m_p}{2k_B T(a)\,a} \left[\left(\frac{a}{r}\right)^{5/7}-1\right]\right\}
\]</span></p>
<p>Note that as <span class="math inline">\(r\rightarrow\infty\)</span> the coronal pressure tends towards a finite constant value: <span class="math display">\[
p(\infty) = p(a)\,\exp\left\{-\frac{7}{5}\,\frac{G\,M_\odot\,m_p}{2k_B T(a)\,a} \right\}
\]</span></p>
<p>There is, of course, nothing at large distances from the Sun which could contain such a pressure (the pressure of the interstellar medium is negligibly small). Thus, we conclude, with Parker, that the static coronal model is unphysical.</p>
<p>Since we have just demonstrated that a static model of the solar corona is unsatisfactory, let us now attempt to construct a dynamic model in which material flows outward from the Sun.</p>
<section id="parker-solar-wind-model" class="level2" data-number="20.1">
<h2 data-number="20.1" class="anchored" data-anchor-id="parker-solar-wind-model"><span class="header-section-number">20.1</span> Parker Solar Wind Model</h2>
<p>By symmetry, we expect a purely radial coronal outflow. The radial momentum conservation equation for the corona takes the form <span id="eq-corona_dynamic_mass_cons"><span class="math display">\[
\rho\,u\,\frac{du}{\mathrm{d}r} = -\frac{\mathrm{d}p}{\mathrm{d}r} - \rho\,\frac{G\,M_\odot}{r^2}
\tag{20.5}\]</span></span> where <span class="math inline">\(u\)</span> is the radial expansion speed. The continuity equation reduces to <span id="eq-corona_dynamic_continuity_reduced"><span class="math display">\[
\frac{1}{r^2}\frac{\mathrm{d}(r^2\,\rho\,u)}{\mathrm{d}r} = 0
\tag{20.6}\]</span></span></p>
<p>In order to obtain a closed set of equations, we now need to adopt an equation of state for the corona, relating the pressure, <span class="math inline">\(p\)</span>, and the density, <span class="math inline">\(\rho\)</span>. For the sake of simplicity, we adopt the simplest conceivable equation of state, which corresponds to an <em>isothermal</em> corona. Thus, we have <span id="eq-corona_dynamic_isothermal"><span class="math display">\[
p = \frac{2k_B\rho T}{m_p}
\tag{20.7}\]</span></span> where <span class="math inline">\(T\)</span> is a constant. Note that more realistic equations of state complicate the analysis, but do not significantly modify any of the physics results.</p>
<p><a href="#eq-corona_dynamic_continuity_reduced" class="quarto-xref">Equation&nbsp;<span>20.6</span></a> can be integrated to give <span id="eq-corona_dynamic_continuity_integrated"><span class="math display">\[
r^2\,\rho\,u = I
\tag{20.8}\]</span></span> where <span class="math inline">\(I\)</span> is a constant. The above expression simply states that the mass flux per unit solid angle, which takes the value <span class="math inline">\(I\)</span>, is independent of the radius, <span class="math inline">\(r\)</span>. <a href="#eq-corona_dynamic_mass_cons" class="quarto-xref">Equation&nbsp;<span>20.5</span></a>, <a href="#eq-corona_dynamic_isothermal" class="quarto-xref">Equation&nbsp;<span>20.7</span></a>, and <a href="#eq-corona_dynamic_continuity_integrated" class="quarto-xref">Equation&nbsp;<span>20.8</span></a> can be combined together to give <span id="eq-corona_dynamic_governing"><span class="math display">\[
\frac{1}{u} \,\frac{du}{\mathrm{d}r}\left(u^2 - \frac{2k_B T}{m_p}\right) = \frac{4k_B T}{m_p\,r} - \frac{G\,M_\odot}{r^2}
\tag{20.9}\]</span></span></p>
<p>Let us restrict our attention to coronal temperatures which satisfy <span class="math display">\[
T &lt; T_c \equiv \frac{G\,M_\odot\,m_p}{4k_B\,a}
\]</span> where <span class="math inline">\(a\)</span> is the radius of the base of the corona. <span class="math inline">\(T_c\)</span> is the defined temperature where the right-hand side of <a href="#eq-corona_dynamic_governing" class="quarto-xref">Equation&nbsp;<span>20.9</span></a> is zero at <span class="math inline">\(r=a\)</span>. For typical coronal parameters (see previous section), <span class="math inline">\(T_c\simeq 5.8\times 10^6\)</span>K, which is certainly greater than the temperature of the corona at <span class="math inline">\(r=a\)</span>. For <span class="math inline">\(T&lt;T_c\)</span>, the right-hand side of <a href="#eq-corona_dynamic_governing" class="quarto-xref">Equation&nbsp;<span>20.9</span></a> is negative for <span class="math inline">\(a&lt;r&lt;r_c\)</span>, where (???) <span id="eq-corona_T_r"><span class="math display">\[
\frac{r_c}{a} = \frac{T_c}{T}
\tag{20.10}\]</span></span> and positive for <span class="math inline">\(r_c&lt;r&lt;\infty\)</span>. The right-hand side of <a href="#eq-corona_dynamic_governing" class="quarto-xref">Equation&nbsp;<span>20.9</span></a> is zero at <span class="math inline">\(r=r_c\)</span>, implying that the left-hand side is also zero at this radius, which is usually termed the “critical radius”. There are two ways in which the left-hand side of <a href="#eq-corona_dynamic_governing" class="quarto-xref">Equation&nbsp;<span>20.9</span></a> can be zero at the critical radius. Either <span id="eq-corona_dynamic_critical1"><span class="math display">\[
u^2(r_c) = u_c^2 \equiv \frac{2k_B T}{m_p}
\tag{20.11}\]</span></span> or <span id="eq-corona_dynamic_critical2"><span class="math display">\[
\frac{du(r_c)}{\mathrm{d}r} = 0
\tag{20.12}\]</span></span></p>
<p>Note that <span class="math inline">\(u_c\)</span> is the coronal sound speed.</p>
<p>As is easily demonstrated, if <a href="#eq-corona_dynamic_critical1" class="quarto-xref">Equation&nbsp;<span>20.11</span></a> is satisfied then <span class="math inline">\(du/\mathrm{d}r\)</span> has the same sign for all <span class="math inline">\(r\)</span>, and <span class="math inline">\(u(r)\)</span> is either a monotonically increasing, or a monotonically decreasing, function of <span class="math inline">\(r\)</span>. On the other hand, if <a href="#eq-corona_dynamic_critical2" class="quarto-xref">Equation&nbsp;<span>20.12</span></a> is satisfied then <span class="math inline">\(u^2-u_c^2\)</span> has the same sign for all <span class="math inline">\(r\)</span>, and <span class="math inline">\(u(r)\)</span> has an extremum close to <span class="math inline">\(r=r_c\)</span>. The flow is either super-sonic for all <span class="math inline">\(r\)</span>, or sub-sonic for all <span class="math inline">\(r\)</span>. These possibilities lead to the existence of four classes of solutions to <a href="#eq-corona_dynamic_governing" class="quarto-xref">Equation&nbsp;<span>20.9</span></a>, with the following properties:</p>
<ol type="1">
<li><span class="math inline">\(u(r)\)</span> is sub-sonic throughout the domain <span class="math inline">\(a&lt;r&lt;\infty\)</span>. <span class="math inline">\(u(r)\)</span> increases with <span class="math inline">\(r\)</span>, attains a maximum value around <span class="math inline">\(r=r_c\)</span>, and then decreases with <span class="math inline">\(r\)</span>.</li>
<li>a unique solution for which <span class="math inline">\(u(r)\)</span> increases monotonically with <span class="math inline">\(r\)</span>, and <span class="math inline">\(u(r_c) = u_c\)</span>.</li>
<li>a unique solution for which <span class="math inline">\(u(r)\)</span> decreases monotonically with <span class="math inline">\(r\)</span>, and <span class="math inline">\(u(r_c) = u_c\)</span>.</li>
<li><span class="math inline">\(u(r)\)</span> is super-sonic throughout the domain <span class="math inline">\(a&lt;r&lt;\infty\)</span>. <span class="math inline">\(u(r)\)</span> decreases with <span class="math inline">\(r\)</span>, attains a minimum value around <span class="math inline">\(r=r_c\)</span>, and then increases with <span class="math inline">\(r\)</span>.</li>
</ol>
<p>These four classes of solutions are illustrated in <a href="#fig-parker-sol" class="quarto-xref">Figure&nbsp;<span>20.1</span></a>.</p>
<div id="fig-parker-sol" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-parker-sol-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://farside.ph.utexas.edu/teaching/plasma/lectures/img2794.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-parker-sol-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;20.1: The four classes of Parker outflow solutions for the solar wind.
</figcaption>
</figure>
</div>
<p>Each of the classes of solutions described above fits a different set of boundary conditions at <span class="math inline">\(r=a\)</span> and <span class="math inline">\(r\rightarrow\infty\)</span>. The physical acceptability of these solutions depends on these boundary conditions. For example, both Class 3 and Class 4 solutions can be ruled out as plausible models for the solar corona since they predict super-sonic flow at the base of the corona, which is not observed, and is also not consistent with a static solar photosphere. Class 1 and Class 2 solutions remain acceptable models for the solar corona on the basis of their properties around <span class="math inline">\(r=a\)</span>, since they both predict sub-sonic flow in this region. However, the Class 1 and Class 2 solutions behave quite differently as <span class="math inline">\(r\rightarrow\infty\)</span>, and the physical acceptability of these two classes hinges on this difference.</p>
<p><a href="#eq-corona_dynamic_governing" class="quarto-xref">Equation&nbsp;<span>20.9</span></a> can be rearranged to give <span class="math display">\[
\frac{du^2}{\mathrm{d}r}\left(1-\frac{u_c^{~2}}{u^2}\right) = \frac{4\,u_c^{~2}}{r} \left(1-\frac{r_c}{r}\right)
\]</span> where <a href="#eq-corona_T_r" class="quarto-xref">Equation&nbsp;<span>20.10</span></a> and the definition of <span class="math inline">\(T_c\)</span> have been used. The above expression can be integrated to give <span id="eq-corona_dynamic_sol"><span class="math display">\[
\left(\frac{u}{u_c}\right)^2 -\ln\!\left(\frac{u}{u_c}\right)^2 = 4\,\ln\frac{r}{r_c} + 4\,\frac{r_c}{r} + C
\tag{20.13}\]</span></span> where <span class="math inline">\(C\)</span> is a constant of integration.</p>
<p>Let us consider the behaviour of Class 1 solutions in the limit <span class="math inline">\(r\rightarrow\infty\)</span>. It is clear from <a href="#fig-parker-sol" class="quarto-xref">Figure&nbsp;<span>20.1</span></a> that, for Class 1 solutions, <span class="math inline">\(u/u_c\)</span> is less than unity and monotonically decreasing as <span class="math inline">\(r\rightarrow\infty\)</span>. In the large-<span class="math inline">\(r\)</span> limit, <a href="#eq-corona_dynamic_sol" class="quarto-xref">Equation&nbsp;<span>20.13</span></a> reduces to <span class="math display">\[
\ln\frac{u}{u_c} \simeq -2\,\ln\frac{r}{r_c}
\]</span> so that <span class="math display">\[
u\propto \frac{1}{r^2}
\]</span></p>
<p>It follows from <a href="#eq-corona_dynamic_continuity_integrated" class="quarto-xref">Equation&nbsp;<span>20.8</span></a> that the coronal density, <span class="math inline">\(\rho\)</span>, approaches a finite, constant value, <span class="math inline">\(\rho_\infty\)</span>, as <span class="math inline">\(r\rightarrow\infty\)</span>. Thus, the Class 1 solutions yield a finite pressure, <span class="math display">\[
p_\infty= \frac{2k_B\,\rho_\infty\,T}{m_p}
\]</span> at large <span class="math inline">\(r\)</span>, which cannot be matched to the much smaller pressure of the interstellar medium. Clearly, Class 1 solutions are unphysical.</p>
<p>Let us consider the behaviour of the Class 2 solution in the limit <span class="math inline">\(r\rightarrow\infty\)</span>. It is clear from <a href="#fig-parker-sol" class="quarto-xref">Figure&nbsp;<span>20.1</span></a> that, for the Class 2 solution, <span class="math inline">\(u/u_c\)</span> is greater than unity and monotonically increasing as <span class="math inline">\(r\rightarrow\infty\)</span>. In the large-<span class="math inline">\(r\)</span> limit, <a href="#eq-corona_dynamic_sol" class="quarto-xref">Equation&nbsp;<span>20.13</span></a> reduces to <span class="math display">\[
\left(\frac{u}{u_c}\right)^2 \simeq 4\,\ln\frac{r}{r_c}
\]</span> so that <span class="math display">\[
u \simeq 2\,u_c\,\left(\ln\frac{r}{r_c}\right)^{1/2}
\]</span></p>
<p>It follows from <a href="#eq-corona_dynamic_continuity_integrated" class="quarto-xref">Equation&nbsp;<span>20.8</span></a> that <span class="math inline">\(\rho\rightarrow 0\)</span> and <span class="math inline">\(r\rightarrow\infty\)</span>. Thus, the Class 2 solution yields <span class="math inline">\(p\rightarrow 0\)</span> at large <span class="math inline">\(r\)</span>, and can, therefore, be matched to the low pressure interstellar medium.</p>
<p>We conclude that the only solution to <a href="#eq-corona_dynamic_governing" class="quarto-xref">Equation&nbsp;<span>20.9</span></a> which is consistent with physical boundary conditions at <span class="math inline">\(r=a\)</span> and <span class="math inline">\(r\rightarrow\infty\)</span> is the Class 2 solution. This solution predicts that the solar corona expands radially outward at relatively modest, sub-sonic velocities close to the Sun, and gradually accelerates to super-sonic velocities as it moves further away from the Sun. Parker termed this continuous, super-sonic expansion of the corona the <em>solar wind</em>.</p>
<p>Note that while the velocity prediction accords well with satellite observations, the Parker model’s prediction for the density of the solar wind at the Earth is significantly too high compared to satellite observations. Consequently, there have been many further developments of this model. In particular, the unrealistic assumption that the solar wind plasma is isothermal has been relaxed, and two-fluid effects have been incorporated into the analysis.</p>
</section>
<section id="parker-spiral" class="level2" data-number="20.2">
<h2 data-number="20.2" class="anchored" data-anchor-id="parker-spiral"><span class="header-section-number">20.2</span> Parker Spiral</h2>
<p>The <em>interplanetary magnetic field</em> (IMF), also called <em>Parker spiral</em>, is the component of the solar magnetic field that is dragged out from the solar corona by the solar wind flow to fill the Solar System. Depending on the polarity of the photospheric footpoint, the heliospheric magnetic field spirals inward or outward; the magnetic field follows the same shape of spiral in the northern and southern parts of the heliosphere, but with opposite field direction. These two magnetic domains are separated by a current sheet (an electric current that is confined to a curved plane). This heliospheric current sheet has a shape similar to a twirled ballerina skirt (<a href="#fig-helio-current-sheet" class="quarto-xref">Figure&nbsp;<span>20.2</span></a>), and changes in shape through the solar cycle as the Sun’s magnetic field reverses about every 11 years.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode jl code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>KeyNotes.<span class="fu">plot_IMF_ecliptic</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode jl code-with-copy"><code class="sourceCode julia"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>KeyNotes.<span class="fu">plot_IMF_3D</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div id="fig-helio-current-sheet" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-helio-current-sheet-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="../images/Heliospheric-current-sheet.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-helio-current-sheet-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;20.2: The heliospheric current sheet is a three-dimensional form of a Parker spiral that results from the influence of the Sun’s rotating magnetic field on the plasma in the interplanetary medium.
</figcaption>
</figure>
</div>
</section>
<section id="anisotropy-in-the-solar-wind" class="level2" data-number="20.3">
<h2 data-number="20.3" class="anchored" data-anchor-id="anisotropy-in-the-solar-wind"><span class="header-section-number">20.3</span> Anisotropy in the Solar Wind</h2>
<p>Observationally, Pioneer 6 showed that the ion temperature anisotropy in the solar wind at 1AU generally has <span class="math inline">\(T_\parallel &gt; T_\perp\)</span>, together with other two interesting discoveries:</p>
<ol type="1">
<li>high fluctuations of flow velocity outside the solar ecliptic plane;</li>
<li>anisotropic ion thermal distribution (<span class="math inline">\(T_\parallel / T_\perp \sim [2,5]\)</span>);</li>
<li>presence of a 3rd species, helium, from charge-to-mass ratio analysis of the angular and energy distributions.</li>
</ol>
<p>It may possibly be explained by the conservation of the 1st adiabatic invariant <a href="This paper shows how pioneers in our field did real elegant physics!"><span class="citation" data-cites="scarf1967plasma">Scarf, Wolfe, and Silva (<span>1967</span>)</span></a>.</p>
<p>The magnetic moment <span class="math inline">\(\mu = m v_\perp^2/2B\)</span> is conserved as the collisionless solar wind flows outward from the sun. Near the solar equator the mean field magnitude declines with <span class="math display">\[
B_r(r) \simeq B_r(r_0)\Big( \frac{r_0}{r} \Big)^2
\]</span> and <span class="math display">\[
B_\phi(r) \simeq \frac{\Omega_r}{u(r)}B_r(r)
\]</span></p>
<p>from the Parker spiral solar wind model and <span class="math inline">\(\Omega_r = 2.94\times 10^{-6}\)</span> rad/s being the angular frequency of the rotation of the sun.</p>
<p>The adiabatic equation in the perpendicular direction indicates that the perpendicular thermal energy <span class="math inline">\(\langle m v_\perp^2/2\rangle = k_B T_\perp\)</span> declines with B. Assuming in the rest frame the distribution function is a bi-Maxwellian of the form <span class="math display">\[
f(v) = \Big( \frac{m}{2\pi}  \Big)^{3/2}\frac{1}{k_B T_\perp (k_B T_\parallel)^{1/2}} \exp\Big( -\frac{mv_\perp^2}{2k_B T_\perp} -\frac{mv_\parallel^2}{2k_B T_\parallel} \Big)
\]</span></p>
<p>The conservation of the total thermal energy <span class="math display">\[
W = \int \mathrm{d}^3v \frac{mv^2}{2}f(v)
\]</span> yields <span class="math display">\[
W = k_B T_\perp + k_B T_\parallel/2 = \text{const}.
\]</span></p>
<p>These allows us to evaluate the variations in <span class="math inline">\(T_\perp\)</span> and <span class="math inline">\(T_\parallel\)</span> originating from isotropic distribution on the surface of the sun. Starting from <span class="math inline">\(T_\perp(0.3 AU) = T_\parallel(0.3 AU)\simeq 1.3\times 10^{5}\textrm{K}\)</span>, the predicted anisotropy <span class="math inline">\(T_\parallel / T_\perp\)</span> at Earth can go beyond 20! Therefore, in fact, the reasonable question to ask is why the actual solar wind anisotropy factor is so small. In simulations, we always apply isotropic distribution in the upstream solar wind condition, which is primarily due to the fact that we are mostly using fluid models (i.e.&nbsp;MHD) for global magnetosphere-solar wind interactions. For kinetic models, <em>we need more realistic distribution setups</em>.</p>
<p>Well, we know now when pressure anisotropy develops, two kinds of plasma instabilities can be triggered: firehose when <span class="math inline">\(T_\perp &lt; T_\parallel\)</span> and mirror when <span class="math inline">\(T_\perp &gt; T_\parallel\)</span>. Further studies require kinetic theory to describe their behaviors.</p>
<p>On the other hand, the opposite case, <span class="math inline">\(T_\perp &gt; T_\parallel\)</span>, is also observed and believed to be related to local ion heating by macroscale compressions (e.g.&nbsp;high/low speed streams interaction) or plasma instabilities <span class="citation" data-cites="bame1975evidence">(<a href="#ref-bame1975evidence" role="doc-biblioref">Bame et al. 1975</a>)</span>.</p>
<p>The mirror instability criterion as an additional relation to determine the pressure anisotropy downstream of the shock from the book Plasma instabilities and nonlinear effects by Hasegawa 1975, <span class="math display">\[
1 + \sum_{\textrm{species}} \beta_\perp \big( 1 - \frac{\beta_\perp}{\beta_\parallel} \big) &lt; 0
\]</span></p>
</section>
<section id="switchbacks" class="level2" data-number="20.4">
<h2 data-number="20.4" class="anchored" data-anchor-id="switchbacks"><span class="header-section-number">20.4</span> Switchbacks</h2>
<p>When Parker Solar Probe (PSP) sent back the first observations from its voyage to the Sun, scientists found signs of a wild ocean of currents and waves quite unlike the near-Earth space much closer to our planet. This ocean was spiked with what became known as <em>switchbacks</em>: rapid flips in the Sun’s magnetic field that reversed direction like a zig-zagging mountain road.&nbsp;</p>
<div id="fig-switchbacks" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-switchbacks-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://www.nasa.gov/sites/default/files/thumbnails/image/switchbacks-sun-web.gif" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-switchbacks-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;20.3: Animation of traveling disturbances in the solar wind that caused the magnetic field to bend back on itself known as switchbacks. <strong>Credits: NASA’s Goddard Space Flight Center/Conceptual Image Lab/Adriana Manrique Gutierrez</strong>
</figcaption>
</figure>
</div>
<p>Our current understanding is that switchbacks may be generated from either magnetic reconnection, turbulence, or plasma velocity shears. There are models for each, but they all requires more testing from future PSP data.</p>
<div id="fig-switchbacks-mechanisms" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-switchbacks-mechanisms-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="https://www.nasa.gov/sites/default/files/thumbnails/image/rsz_switchbacks_infographic.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-switchbacks-mechanisms-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;20.4: Illustration of five current theories explaining how switchbacks form. <strong>Credits: NASA’s Goddard Space Flight Center/Miles Hatfield/Lina Tran/Mary-Pat Hrybyk Keith</strong>
</figcaption>
</figure>
</div>
<p>See more in <a href="https://www.nasa.gov/feature/goddard/2021/switchbacks-science-explaining-parker-solar-probe-s-magnetic-puzzle">Switchbacks Science: Explaining Parker Solar Probe’s Magnetic Puzzle</a>.</p>
</section>
<section id="mhd-description" class="level2" data-number="20.5">
<h2 data-number="20.5" class="anchored" data-anchor-id="mhd-description"><span class="header-section-number">20.5</span> MHD Description</h2>
<p>Because of the presence of a strong magnetic field carried by the wind, low-frequency fluctuations in the solar wind are usually described with MHD. However, due to some peculiar characteristics, the solar wind turbulence contains some features hardly classified within a general theoretical framework. (Tu and Marsch 1995) presents a thorough review of the turbulent phenomena in the solar wind from observations in the ecliptic. In the 1990s, with the launch of the Ulysses spacecraft, investigations have been extended to the high-latitude regions of the heliosphere.</p>
<p>Ruelle and Takens (1971) who showed that a strange attractor in the phase space of the system is the best model for the birth of turbulence. This gave a strong impulse to the investigation of the phenomenology of turbulence from the point of view of dynamical systems. Turbulence in the solar wind has been used as a big wind tunnel to investigate scaling laws of turbulent fluctuations, multifractals models, etc. Therefore, the solar wind can be seen as a very big laboratory where fully developed turbulence can be investigated not only per se, rather as far as basic theoretical aspects are concerned.</p>
</section>
<section id="wave-modes-in-the-solar-wind" class="level2" data-number="20.6">
<h2 data-number="20.6" class="anchored" data-anchor-id="wave-modes-in-the-solar-wind"><span class="header-section-number">20.6</span> Wave Modes in the Solar Wind</h2>
<p>Observations in the solar wind suggest that the compressive component of inertial-range solar-wind turbulence is dominated by slow modes. The low collisionality of the solar wind allows for nonthermal features to survive, which suggests the requirement of a kinetic plasma description.</p>
<p>The role of kinetic slow waves (KSWs) have largely been ignored as it is heavily damped for the typical plasma parameters of the solar wind (Barnes, 1966; Narita &amp; Marsch, 2015). Recently, KSWs (or pressure balanced structures) have often been invoked to explain the compressible fluctuations and the anticorrelation of magnetic field strength <span class="math inline">\(B\)</span> and the density <span class="math inline">\(n\)</span> at fluid scales <span class="citation" data-cites="howes2012slow verscharen2017kinetic">(<a href="#ref-howes2012slow" role="doc-biblioref">Howes et al. 2012</a>; <a href="#ref-verscharen2017kinetic" role="doc-biblioref">Verscharen, Chen, and Wicks 2017</a>)</span> and have also been revisited at sub-ion scales to explain the observed increase in compressibility <span class="citation" data-cites="lacombe2017anisotropies">(<a href="#ref-lacombe2017anisotropies" role="doc-biblioref">Lacombe, Alexandrova, and Matteini 2017</a>)</span>.</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-bame1975evidence" class="csl-entry" role="listitem">
Bame, SJ, JR Asbridge, WC Feldman, S Peter Gary, and Michael D Montgomery. 1975. <span>“Evidence for Local Ion Heating in Solar Wind High Speed Streams.”</span> <em>Geophysical Research Letters</em> 2 (9): 373–75. <a href="https://doi.org/10.1029/GL002i009p00373">https://doi.org/10.1029/GL002i009p00373</a>.
</div>
<div id="ref-howes2012slow" class="csl-entry" role="listitem">
Howes, GG, SD Bale, KG Klein, CHK Chen, CS Salem, and JM TenBarge. 2012. <span>“The Slow-Mode Nature of Compressible Wave Power in Solar Wind Turbulence.”</span> <em>The Astrophysical Journal Letters</em> 753 (1): L19. <a href="https://doi.org/10.1088/2041-8205/753/1/L19">https://doi.org/10.1088/2041-8205/753/1/L19</a>.
</div>
<div id="ref-lacombe2017anisotropies" class="csl-entry" role="listitem">
Lacombe, Catherine, Olga Alexandrova, and Lorenzo Matteini. 2017. <span>“Anisotropies of the Magnetic Field Fluctuations at Kinetic Scales in the Solar Wind: Cluster Observations.”</span> <em>The Astrophysical Journal</em> 848 (1): 45. <a href="https://doi.org/10.3847/1538-4357/aa8c06">https://doi.org/10.3847/1538-4357/aa8c06</a>.
</div>
<div id="ref-scarf1967plasma" class="csl-entry" role="listitem">
Scarf, FL, JH Wolfe, and RW Silva. 1967. <span>“A Plasma Instability Associated with Thermal Anisotropies in the Solar Wind.”</span> <em>Journal of Geophysical Research</em> 72 (3): 993–1005. <a href="https://doi.org/10.1029/JZ072i003p00993">https://doi.org/10.1029/JZ072i003p00993</a>.
</div>
<div id="ref-verscharen2017kinetic" class="csl-entry" role="listitem">
Verscharen, Daniel, Christopher HK Chen, and Robert T Wicks. 2017. <span>“On Kinetic Slow Modes, Fluid Slow Modes, and Pressure-Balanced Structures in the Solar Wind.”</span> <em>The Astrophysical Journal</em> 840 (2): 106. <a href="https://doi.org/10.3847/1538-4357/aa6a56">https://doi.org/10.3847/1538-4357/aa6a56</a>.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../contents/geometry.html" class="pagination-link" aria-label="Geometry">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Geometry</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../contents/shock.html" class="pagination-link" aria-label="Shock">
        <span class="nav-page-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Shock</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/henry2004y/KeyNotes/edit/master/contents/solarwind.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li></ul></div></div></div></footer></body></html>