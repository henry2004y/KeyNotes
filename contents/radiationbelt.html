<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.361">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Key Notes in Plasma Physics - 20&nbsp; Radiation Belt</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../contents/aurora.html" rel="next">
<link href="../contents/ionosphere.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../contents/radiationbelt.html"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Radiation Belt</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Key Notes in Plasma Physics</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/henry2004y/KeyNotes/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/about.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">About</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/math.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Math</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/single.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Single-Particle Motions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/fluid.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Plasmas as Fluid</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/diffres.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Diffusion and Resisvity</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/wave.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Waves</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/kinetic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Kinetic Theory</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/stability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Stability</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/kmhd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Kinetic MHD</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/gyrokinetics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Gyrokinetics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/flr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Field Line Resonance</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/nonlinear.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Nonlinear Effects</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/turbulence.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Turbulence</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/geometry.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Geometry</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/solarwind.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Solar Wind</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/shock.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Shock</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/magnetosphere.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Magnetosphere</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/ionosphere.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Ionosphere</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/radiationbelt.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Radiation Belt</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/aurora.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Aurora</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/boundary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Boundary Conditions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/pic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Particle-in-Cell</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/hybrid.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Hybrid Methods</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/raytracing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Ray Tracing</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Tests</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/appendix.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Appendix</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">References</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#waves-in-the-radiation-belt" id="toc-waves-in-the-radiation-belt" class="nav-link active" data-scroll-target="#waves-in-the-radiation-belt"><span class="header-section-number">20.1</span> Waves in the Radiation Belt</a>
  <ul class="collapse">
  <li><a href="#sources-of-waves" id="toc-sources-of-waves" class="nav-link" data-scroll-target="#sources-of-waves"><span class="header-section-number">20.1.1</span> Sources of Waves</a></li>
  </ul></li>
  <li><a href="#modeling" id="toc-modeling" class="nav-link" data-scroll-target="#modeling"><span class="header-section-number">20.2</span> Modeling</a>
  <ul class="collapse">
  <li><a href="#coupling-physical-processes-at-different-time-scales" id="toc-coupling-physical-processes-at-different-time-scales" class="nav-link" data-scroll-target="#coupling-physical-processes-at-different-time-scales"><span class="header-section-number">20.2.1</span> Coupling physical processes at different time scales</a></li>
  </ul></li>
  <li><a href="#plasmasphere" id="toc-plasmasphere" class="nav-link" data-scroll-target="#plasmasphere"><span class="header-section-number">20.3</span> Plasmasphere</a></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/henry2004y/KeyNotes/edit/master/contents/radiationbelt.qmd" class="toc-action">Edit this page</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-radiation_belt" class="quarto-section-identifier"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Radiation Belt</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>A <a href="https://en.wikipedia.org/wiki/Van_Allen_radiation_belt">Van Allen radiation belt</a> is a zone of energetic charged particles, most of which originate from the solar wind, that are captured by and held around a planet by that planet’s magnetosphere. Earth possesses an inner belt and an outer belt.</p>
<ol type="1">
<li>the inner belt</li>
</ol>
<ul>
<li>MeV protons, 100 keV electrons</li>
<li>0.2 - 2 <span class="math inline">\(R_\text{E}\)</span> (L 1 - 3)</li>
</ul>
<ol start="2" type="1">
<li>the outer belt</li>
</ol>
<ul>
<li>0.1 - 10 MeV electrons</li>
<li>3 - 10 <span class="math inline">\(R_\text{E}\)</span> (outer boundary is the magnetopause)</li>
</ul>
<p>Our understanding of the physics mechanisms until 1990s:</p>
<ol type="1">
<li>Low energy electrons get injected into the magnetosphere from the solar wind.</li>
<li>Electrons transport towards the planet by reconnections, substorms and associated electric fields.</li>
<li>Electrons drift around the planet.</li>
<li>Magnetic fluctuations cause inward/outward diffusions.</li>
<li>Energy is gained by conservation of the 1st adiabatic invariant.</li>
<li>Loss by collisions with the atmosphere, reaching the magnetoapuse, and outward radial diffusion.</li>
</ol>
<p>During magnetic storms the magnetopause is compressed, so more electrons are lost to the magnetopause. If the mirror point is deep inside the atmosphere, charged particles will precipitate into the atmosphere and lost due to collisions. There are still many mysteries both due to lack of observations and theories. For example, the classical theory cannot explain the electron variation (intermittent injection, rapid loss) timescales!</p>
<p>In 1998, two new theories came out:</p>
<ol type="1">
<li>Enhanced radial diffusion</li>
</ol>
<ul>
<li>Solar wind flows past the magnetosphere, drives K-H instability, and in turn triggers ULF waves.</li>
<li>The ULF waves trigger FLR (<a href="flr.html"><span>Chapter&nbsp;12</span></a>).</li>
<li>The outcome is a faster radial diffusion process?</li>
</ul>
<ol start="2" type="1">
<li>Wave acceleration</li>
</ol>
<ul>
<li>Substorms, convection, plasma instabilities.</li>
<li>Waves accelerate electrons to MeV.</li>
</ul>
<p>The wave acceleration, or more specifically, wave-particle interaction, has been widely explored both theoretically and compared with observation data at Earth, Jupiter, and Saturn.</p>
<section id="waves-in-the-radiation-belt" class="level2" data-number="20.1">
<h2 data-number="20.1" class="anchored" data-anchor-id="waves-in-the-radiation-belt"><span class="header-section-number">20.1</span> Waves in the Radiation Belt</h2>
<div id="fig-radiation_belt_waves" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="https://media.springernature.com/lw685/springer-static/image/art%3A10.1186%2Fs40623-021-01508-y/MediaObjects/40623_2021_1508_Figa_HTML.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;20.1: Schematic diagram showing many of the wave modes that affect energetic electrons in the Earth’s radiation belts. Viewing from the north pole.</figcaption>
</figure>
</div>
<ul>
<li><p>Lower hybrid waves: ???</p></li>
<li><p>Whistler waves (<a href="wave.html#sec-CPDR"><span>Section&nbsp;7.6</span></a>)</p></li>
<li><p>Chorus waves</p>
<ul>
<li>1-5 kHz (<span class="math inline">\(0.1-1.0\,f_{ce}\)</span>), well-defined narrow band</li>
<li>highly nonlinear</li>
<li>not generated by lightning, but by natural plasma instabilities (same for hiss).</li>
<li>electron anisotropy</li>
<li>loss cone scattering</li>
</ul></li>
<li><p>Hiss waves</p>
<ul>
<li>broadband structureless signal in the plasmasphere and resembles audible hiss</li>
</ul></li>
</ul>
<div id="fig-arase_waves" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="https://www.eoportal.org/api/cms/documents/163813/3290385/ERG_Auto6.jpeg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;20.2: In-situ observation by the ERG (Arase) spacecraft. The ERG spacecraft observed chorus waves and scattered electrons in the magnetosphere, the origin of pulsation auroras. The scattered electrons precipitated into the atmosphere resulting in auroral illumination. Intermittent occurrence of chorus waves and associated electron scattering lead to auroral pulsation.</figcaption>
</figure>
</div>
<p>Before 1990s, waves in the radiation belts are known for transferring energy from charged particles, which act as a loss process to the particles. Richard Thorne, together with his collegues, proposed that they could also the sources of energetic particles ([Horne &amp; Thorne], 1998, 2003, 2005a,b). If that is the case, <em>the wave-particle interactions must break the adiabatic invariants</em>.</p>
<p>The theory of wave-particle interaction starts with hot plasma kinetic theory (<a href="kinetic.html#sec-HPDR"><span>Section&nbsp;8.10.1</span></a>). When the denominator goes to 0, the resonance condition is fulfilled. From observations, we learned that the wave frequencies are smaller than the gyro-frequencies. How can we have resonance then? The answer is, Doppler shift needs to be taken into account.</p>
<section id="sources-of-waves" class="level3" data-number="20.1.1">
<h3 data-number="20.1.1" class="anchored" data-anchor-id="sources-of-waves"><span class="header-section-number">20.1.1</span> Sources of Waves</h3>
<p>resonance can generate current =&gt; this current can generate higher frequency radiations?</p>
<p>Whistler waves can be explained by the linear theory. However, chorus and hiss waves are highly nonlinear and thus cannot be explained by a linear theory. We conjecture that they are caused by natural plasma instabilities, but we still have little idea what exactly these instabilities are.</p>
<p>As a rough physical picture, during the cyclotron resonance:</p>
<ol type="1">
<li>Waves diffuse source electrons into loss cone =&gt; electron loss and wave growth.</li>
<li>Waves diffuse trapped electrons =&gt; energy diffusion leads to electron acceleration.</li>
</ol>
</section>
</section>
<section id="modeling" class="level2" data-number="20.2">
<h2 data-number="20.2" class="anchored" data-anchor-id="modeling"><span class="header-section-number">20.2</span> Modeling</h2>
<p>3D Fokker-Planck diffusion model<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> (e.g. <span class="citation" data-cites="glauert2014three">(<a href="#ref-glauert2014three" role="doc-biblioref">Glauert, Horne, and Meredith 2014</a>)</span>) has been built to model the radiation belt electrons. In the Earth’s radiation belts, the evolution of the phase-averaged phase-space density <span class="math inline">\(f(p,r,t)\)</span> can be described by a diffusion equation (see also <a href="kinetic.html#eq-fokker_planck">Equation&nbsp;<span>8.19</span></a>): <span id="eq-fokker_planck_general"><span class="math display">\[
\frac{\partial f}{\partial t} = \sum_{i,j}\frac{\partial}{\partial J_i}\left[ D_{ij}\frac{\partial f}{\partial J_j} \right]
\tag{20.1}\]</span></span></p>
<p>Here <span class="math inline">\(D_{ij}\)</span> are diffusion coefficients and <span class="math inline">\(J_i\)</span> are the action integrals, <span class="math inline">\(J_1 = 2\pi m_e \mu/|q|\)</span>, <span class="math inline">\(J_2 = J\)</span>, and <span class="math inline">\(J_3 = q|\phi|\)</span>, where <span class="math inline">\(\mu,J\)</span>, and <span class="math inline">\(\phi\)</span> are the adiabatic invariants of charged particle motion, <span class="math inline">\(m_e\)</span> is the electron mass, and <span class="math inline">\(q\)</span> the charge. The adiabatic invariants are awkward variables to visualize and relate to data so many authors transform to other coordinates. One choice is to use pitch angle, energy, and <span class="math inline">\(L^\ast=2\pi M/(|\phi| R_\text{E})\)</span> (<a href="single.html#eq-Lstar">Equation&nbsp;<span>4.32</span></a>), where <span class="math inline">\(M=8.22\times 10^{22}\, \text{A}\,\text{m}^2\)</span> is the magnetic moment of the Earth’s dipole field and <span class="math inline">\(R_\text{E}\)</span> is the Earth’s radius, as the three independent variables.</p>
<p>Assuming a dipole field, changing coordinates to equatorial pitch angle <span class="math inline">\(\alpha\)</span>, kinetic energy <span class="math inline">\(E\)</span>, and <span class="math inline">\(L^\ast\)</span>, and neglecting some cross derivatives, <a href="kinetic.html#eq-fokker_planck">Equation&nbsp;<span>8.19</span></a> can be written as <span id="eq-fokker_planck_convenient"><span class="math display">\[
\begin{aligned}
\frac{\partial f}{\partial t} =&amp; \frac{1}{g(\alpha)}\frac{\partial}{\partial \alpha}\bigg\rvert_{E,L} g(\alpha)\left( D_{\alpha\alpha}\frac{\partial f}{\partial\alpha}\bigg\rvert_{E,L} + D_{\alpha E}\frac{\partial f}{\partial E}\bigg\rvert_{\alpha,L} \right) \\
&amp;+ \frac{1}{A(E)}\frac{\partial}{\partial E}\bigg\rvert_{\alpha,L} A(E) \left( D_{EE}\frac{\partial f}{\partial E}\bigg\rvert_{\alpha,L} + D_{E\alpha}\frac{\partial f}{\partial \alpha}\bigg\rvert_{E,L} \right) \\
&amp;+ L^2 \frac{\partial}{\partial L}\bigg\rvert_{\mu,J}\left( \frac{D_{LL}}{L^2}\frac{\partial f}{\partial L}\bigg\rvert_{\mu,J} \right)
\end{aligned}
\tag{20.2}\]</span></span> where <span class="math display">\[
\begin{aligned}
g(\alpha) = T(\alpha)\sin 2\alpha \\
A(E) = (E+E_0)(E(E+2E_0))^{1/2}
\end{aligned}
\]</span> and <span class="math inline">\(E_0\)</span> is the electron rest mass energy. <span class="math inline">\(T(\alpha)\)</span> is related to the bounce period and in a dipole field can be approximated by <span class="math display">\[
T(\alpha) = \big(1.3802 - 0.3198(\sin\alpha + \sin^{1/2} \alpha) \big)
\]</span></p>
<p><span class="math inline">\(D_{\alpha\alpha},\, D_{\alpha E}=D_{E\alpha},\, D_{EE}\)</span>, and <span class="math inline">\(D_{LL}\)</span> are the <em>drift-</em> and <em>bounce-averaged</em> pitch angle, mixed pitch angle energy, energy and radial diffusion coefficients, respectively. When we need to clarify the fact that they are drift and bounce averaged, they will be explicitly written as <span class="math inline">\(\left&lt; D_{\alpha\alpha} \right&gt;^d, \left&lt; D_{\alpha E} \right&gt;^d, \left&lt; D_{EE} \right&gt;^d\)</span>, and <span class="math inline">\(\left&lt; D_{LL} \right&gt;^d\)</span>, respectively.</p>
<p>The bounce-averaged pitch angle and energy diffusion rates are defined by <span class="math display">\[
\begin{aligned}
\left&lt; D_{\alpha\alpha} \right&gt; &amp;\equiv \left&lt; \frac{(\Delta\alpha)^2}{2\Delta t} \right&gt; \\
\left&lt; D_{\alpha E} \right&gt; &amp;\equiv \left&lt; \frac{(\Delta\alpha \Delta E)^2}{2\Delta t} \right&gt; \\
\left&lt; D_{EE} \right&gt; &amp;\equiv \left&lt; \frac{(\Delta E)^2}{2\Delta t} \right&gt;
\end{aligned}
\]</span> with units of <span class="math inline">\(\text{s}^{-1}, \text{J}\text{s}^{-1}\)</span>, and <span class="math inline">\(\text{J}^2\text{s}^{-1}\)</span>, respectively.</p>
<p>A loss term of the form <span class="math inline">\(f/\tau_L\)</span> can be added to represent losses to the atmosphere due to collisions. Here, <span class="math inline">\(\tau_L\)</span>, the loss timescale, is equal to 1/4 of the bounce time in the loss cone and infinite elsewhere. As a first-order approximation, we can neglect the cross terms and simplify <a href="#eq-fokker_planck_convenient">Equation&nbsp;<span>20.2</span></a> as <span id="eq-fokker_planck_nocrossterm"><span class="math display">\[
\begin{aligned}
\frac{\partial f}{\partial t} =&amp; \frac{1}{g(\alpha)}\frac{\partial}{\partial \alpha}\bigg\rvert_{E,L} g(\alpha)\left( D_{\alpha\alpha}\frac{\partial f}{\partial\alpha}\bigg\rvert_{E,L}\right) \\
&amp;+ \frac{1}{A(E)}\frac{\partial}{\partial E}\bigg\rvert_{\alpha,L} A(E) \left( D_{EE}\frac{\partial f}{\partial E}\bigg\rvert_{\alpha,L}\right) \\
&amp;+ L^2 \frac{\partial}{\partial L}\bigg\rvert_{\mu,J}\left( \frac{D_{LL}}{L^2}\frac{\partial f}{\partial L}\bigg\rvert_{\mu,J} \right) \\
&amp;- \frac{f}{\tau_L}
\end{aligned}
\tag{20.3}\]</span></span></p>
<p>The first three terms on the right-hand side represent pitch angle, energy, and radial diffusion, respectively. The final term accounts for losses to the atmosphere. Pitch angle diffusion has contributions from wave-particle interactions and Coulomb collisions with the atmosphere, though the latter are only significant inside the loss cone. Energy diffusion is due to wave-particle interactions and radial diffusion to interactions with large-scale fluctuations in the Earth’s magnetic and electric fields. The diffusion coefficients are based on statistical wave models derived from data. Depending on the choice of the diffusion coefficients, the Fokker-Planck equation can be linear, quasi-linear, or nonlinear.</p>
<p>Let us make our lives even simpler by considering only the radial diffusion and loss term. The quasi-linear assumptions are:</p>
<ul>
<li>Broadband wave spectrum (with random phase), typically assumed as a Gaussian centered around a single dominant mode</li>
<li>Low amplitude fluctuations (no nonlinear interactions)</li>
<li>“Resonance limit” (linear growth rate of instabilities goes to 0)</li>
<li>ULF wave-particle interactions lumped into the diffusion coefficient</li>
</ul>
<p>Even when quasi-linear theory works fine, there are multiple sources of uncertainties in the radial diffusion coefficient:</p>
<ul>
<li>Background magnetic field model</li>
<li>Bounce + drift average eliminates MLT dependence</li>
<li>Azimuthal wave structure (i.e.&nbsp;power distribution over mode numbers)</li>
</ul>
<p>Given the limited observation data, we want to estimate the unknown parameters <span class="math inline">\(D_{LL}, \tau_L\)</span>. This is called an <em>inverse problem</em>. In 2000, Brautigam and Albert proposed a dependence of the radial diffusion coefficent on <span class="math inline">\(K_p\)</span> and L: <span class="math display">\[
D_{LL} \approx 10^{-0.506 K_p(t) - 9.325}L^10
\]</span></p>
<p>The standard statistical approach is to apply a Bayesian parameter estimation, where we are looking for a distribution of parameters and correcting results based on new observations. However, it is difficult to apply in high dimensions, which typically requires the Markov-chain Monte Carlo (MCMC) approach. For example, our assumption is that the parameters can be written in the following forms: <span class="math display">\[
\begin{aligned}
D_{LL}(L, t) &amp;= 10^(a K_p(t) + b)L^c \\
\tau_L(L, t) &amp;= \left\{
\begin{array}{lr}
(a_0 + a_1 L + a_2 L^2) / K_p(t) &amp; \text{for } L\le L_{pp} \\ a_3 / K_p(t) &amp; \text{for } L &gt; L_{pp}
\end{array}
\right.
\end{aligned}
\]</span> where <span class="math inline">\(L_{pp}\)</span> is the plasmapause location, which can be estimated with some approximations. We introduce a bunch of random variables, and the posterior distributions of these variables after MCMC give us the best fits.</p>
<p>A new trend is to <a href="https://youtu.be/5C913ApaxUY">use physics-informed machine learning to learn the coefficients</a>. First we may need to constrain the forms of the coefficients to avoid an ill-posed inverse problem. Let the physical loss term be described by a drift coefficient <span class="math inline">\(C\)</span>: <span class="math display">\[
\frac{\partial f}{\partial t} = L^2 \frac{\partial}{\partial L}\bigg\rvert_{\mu,J}\left( \frac{D_{LL}}{L^2}\frac{\partial f}{\partial L}\bigg\rvert_{\mu,J} \right) - \frac{\partial Cf}{\partial L}
\]</span></p>
<p>The job of <em>Physical-Informed Neural Network</em> (PINN) is to deduce the optimal <span class="math inline">\(D_{LL}\)</span> and <span class="math inline">\(C\)</span> based on statistics by embedding the expected form of the equation into the loss term in the neural network. As this is statistics, we can build and test any kind of relations between variables without physical interpretation, which has been critizised a lot. For example, one may ask how you can let the phase space distribution <span class="math inline">\(f\)</span> depend only on <span class="math inline">\(t\)</span> and <span class="math inline">\(L\)</span>? The information is incomplete from a physics point of view, but datawise it may just “work”, in the sense that neural network is essentially a <em>universal high-dimensional function approximator</em>.</p>
<section id="coupling-physical-processes-at-different-time-scales" class="level3" data-number="20.2.1">
<h3 data-number="20.2.1" class="anchored" data-anchor-id="coupling-physical-processes-at-different-time-scales"><span class="header-section-number">20.2.1</span> Coupling physical processes at different time scales</h3>
<p>If we only look at low frequency regime, the high frequency wave-particle interactions behave as a diffusion process to the plasma. Thus the coupling idea is not to simulate everything on the same time scale, but simulate the radiation belt effect by macroscopic diffusion coefficients.</p>
</section>
</section>
<section id="plasmasphere" class="level2" data-number="20.3">
<h2 data-number="20.3" class="anchored" data-anchor-id="plasmasphere"><span class="header-section-number">20.3</span> Plasmasphere</h2>
<p>The plasmasphere is a region within the Earth’s magnetosphere that contains <em>dense, cold</em> plasma. It is located in the innermost part of the magnetosphere, and it extends from about 1,000 to 60,000 kilometers above the Earth’s surface. The plasmasphere is formed by the Earth’s magnetic field, which traps charged particles in the region, creating a donut-shaped structure around the planet.</p>
<div id="fig-plasmasphere" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="https://www.nasa.gov/sites/default/files/images/470173main_magnetosphere2_full.jpg" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">Figure&nbsp;20.3: Plasmapshere and radiation belt as the inner magnetosphere.</figcaption>
</figure>
</div>
<p>The plasma in the plasmasphere is composed mainly of ions and electrons, and it is much colder and denser than the plasma in other regions of the magnetosphere.</p>
<ul>
<li><span class="math inline">\(T \in [10^3, 10^4]\,\mathrm{K}\)</span></li>
<li><span class="math inline">\(N \in [10^1, 10^2]\,\mathrm{cm}^{-3}\)</span></li>
</ul>
<p>The plasmasphere plays an important role in the dynamics of the Earth’s magnetosphere and its interactions with the solar wind. It can affect the propagation of radio waves, particularly those used for communication and navigation, and it can also contribute to the formation of the aurora borealis and aurora australis.</p>


<div id="refs" class="references csl-bib-body hanging-indent" role="list">
<div id="ref-glauert2014three" class="csl-entry" role="listitem">
Glauert, Sarah A, Richard B Horne, and Nigel P Meredith. 2014. <span>“Three-Dimensional Electron Radiation Belt Simulations Using the BAS Radiation Belt Model with New Diffusion Models for Chorus, Plasmaspheric Hiss, and Lightning-Generated Whistlers.”</span> <em>Journal of Geophysical Research: Space Physics</em> 119 (1): 268–89. <a href="https://doi.org/10.1002/2013JA019281">https://doi.org/10.1002/2013JA019281</a>.
</div>
</div>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>The general form of the Fokker-Planck equation also includes an advection term, which is ignored here since the drift is negligible compared to diffusion.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../contents/ionosphere.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Ionosphere</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../contents/aurora.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Aurora</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>