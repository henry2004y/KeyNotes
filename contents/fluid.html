<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>8&nbsp; Plasmas as Fluid – Key Notes in Plasma Physics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../contents/diffres.html" rel="next">
<link href="../contents/single.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-e26003cea8cd680ca0c55a263523d882.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark-d166b450ba5a8e9f7a0ab969bf6592c1.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-cd7de1037569933fbb609f06423bd096.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark-fd69b20446523e875aa248e9b0df6aa9.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../contents/fluid.html"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Plasmas as Fluid</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Key Notes in Plasma Physics</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/henry2004y/KeyNotes/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/about.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">About</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/math.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Math</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/theoretical_mechanics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Theoretical Mechanics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/relativity.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Relativity</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/unit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Unit Conversion</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/single.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Single-Particle Motions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/fluid.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Plasmas as Fluid</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/diffres.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Diffusion and Resisvity</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/wave.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Waves</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/emhd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">EMHD</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/kinetic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Kinetic Theory</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/stability.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Stability</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/kmhd.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Kinetic MHD</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/gyrokinetics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Gyrokinetics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/flr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Field Line Resonance</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/nonlinear.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Nonlinear Effects</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/turbulence.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Turbulence</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/geometry.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Geometry</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/solarwind.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Solar Wind</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/shock.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Shock</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/magnetosphere.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Magnetosphere</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/ionosphere.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Ionosphere</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/radiationbelt.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Radiation Belt</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/aurora.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Aurora</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/gc.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Guiding Center</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/cr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Cosmic Ray</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/boundary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Boundary Conditions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/pic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Particle-in-Cell</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/hybrid.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Hybrid Methods</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/raytracing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Ray Tracing</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/test.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Tests</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/inductance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Inductance</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/capacitance.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Capacitance</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/appendix.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Appendix</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../contents/references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">References</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#definitions" id="toc-definitions" class="nav-link active" data-scroll-target="#definitions"><span class="header-section-number">8.1</span> Definitions</a></li>
  <li><a href="#relation-of-plasma-to-ordinary-electromagnetics" id="toc-relation-of-plasma-to-ordinary-electromagnetics" class="nav-link" data-scroll-target="#relation-of-plasma-to-ordinary-electromagnetics"><span class="header-section-number">8.2</span> Relation of Plasma to Ordinary Electromagnetics</a>
  <ul class="collapse">
  <li><a href="#maxwells-equations" id="toc-maxwells-equations" class="nav-link" data-scroll-target="#maxwells-equations"><span class="header-section-number">8.2.1</span> Maxwell’s Equations</a></li>
  <li><a href="#classical-treatment-of-magnetic-materials" id="toc-classical-treatment-of-magnetic-materials" class="nav-link" data-scroll-target="#classical-treatment-of-magnetic-materials"><span class="header-section-number">8.2.2</span> Classical Treatment of Magnetic Materials</a></li>
  <li><a href="#classical-treatment-of-dielectrics" id="toc-classical-treatment-of-dielectrics" class="nav-link" data-scroll-target="#classical-treatment-of-dielectrics"><span class="header-section-number">8.2.3</span> Classical Treatment of Dielectrics</a></li>
  <li><a href="#the-dielectric-constant-of-a-plasma" id="toc-the-dielectric-constant-of-a-plasma" class="nav-link" data-scroll-target="#the-dielectric-constant-of-a-plasma"><span class="header-section-number">8.2.4</span> The Dielectric Constant of a Plasma</a></li>
  </ul></li>
  <li><a href="#fluid-equations" id="toc-fluid-equations" class="nav-link" data-scroll-target="#fluid-equations"><span class="header-section-number">8.3</span> Fluid Equations</a>
  <ul class="collapse">
  <li><a href="#equation-of-continuity" id="toc-equation-of-continuity" class="nav-link" data-scroll-target="#equation-of-continuity"><span class="header-section-number">8.3.1</span> Equation of Continuity</a></li>
  <li><a href="#momentum-equation" id="toc-momentum-equation" class="nav-link" data-scroll-target="#momentum-equation"><span class="header-section-number">8.3.2</span> Momentum Equation</a></li>
  <li><a href="#equation-of-state" id="toc-equation-of-state" class="nav-link" data-scroll-target="#equation-of-state"><span class="header-section-number">8.3.3</span> Equation of State</a></li>
  </ul></li>
  <li><a href="#sec-2fluid" id="toc-sec-2fluid" class="nav-link" data-scroll-target="#sec-2fluid"><span class="header-section-number">8.4</span> Two-Fluid Model</a>
  <ul class="collapse">
  <li><a href="#five-moment" id="toc-five-moment" class="nav-link" data-scroll-target="#five-moment"><span class="header-section-number">8.4.1</span> Five-moment</a></li>
  <li><a href="#six-moment" id="toc-six-moment" class="nav-link" data-scroll-target="#six-moment"><span class="header-section-number">8.4.2</span> Six-moment</a></li>
  <li><a href="#fiveten-moment" id="toc-fiveten-moment" class="nav-link" data-scroll-target="#fiveten-moment"><span class="header-section-number">8.4.3</span> Five/Ten-moment</a></li>
  <li><a href="#characteristic-wave-speeds" id="toc-characteristic-wave-speeds" class="nav-link" data-scroll-target="#characteristic-wave-speeds"><span class="header-section-number">8.4.4</span> Characteristic wave speeds</a></li>
  </ul></li>
  <li><a href="#generalized-ohms-law" id="toc-generalized-ohms-law" class="nav-link" data-scroll-target="#generalized-ohms-law"><span class="header-section-number">8.5</span> Generalized Ohm’s Law</a>
  <ul class="collapse">
  <li><a href="#basic-definitions-and-assumptions" id="toc-basic-definitions-and-assumptions" class="nav-link" data-scroll-target="#basic-definitions-and-assumptions"><span class="header-section-number">8.5.1</span> Basic definitions and assumptions</a></li>
  <li><a href="#equation-of-motion-for-each-species" id="toc-equation-of-motion-for-each-species" class="nav-link" data-scroll-target="#equation-of-motion-for-each-species"><span class="header-section-number">8.5.2</span> Equation of motion for each species</a></li>
  <li><a href="#preconditions" id="toc-preconditions" class="nav-link" data-scroll-target="#preconditions"><span class="header-section-number">8.5.3</span> Preconditions</a></li>
  <li><a href="#derivation" id="toc-derivation" class="nav-link" data-scroll-target="#derivation"><span class="header-section-number">8.5.4</span> Derivation</a></li>
  <li><a href="#simplification-of-generalized-ohms-law" id="toc-simplification-of-generalized-ohms-law" class="nav-link" data-scroll-target="#simplification-of-generalized-ohms-law"><span class="header-section-number">8.5.5</span> Simplification of Generalized Ohm’s Law</a></li>
  <li><a href="#discussions" id="toc-discussions" class="nav-link" data-scroll-target="#discussions"><span class="header-section-number">8.5.6</span> Discussions</a></li>
  <li><a href="#ohms-law-in-a-multi-ion-system" id="toc-ohms-law-in-a-multi-ion-system" class="nav-link" data-scroll-target="#ohms-law-in-a-multi-ion-system"><span class="header-section-number">8.5.7</span> Ohm’s Law in a Multi-Ion System</a></li>
  </ul></li>
  <li><a href="#sec-mhd" id="toc-sec-mhd" class="nav-link" data-scroll-target="#sec-mhd"><span class="header-section-number">8.6</span> Magnetohydrodynamics</a>
  <ul class="collapse">
  <li><a href="#sec-mhd-ohm" id="toc-sec-mhd-ohm" class="nav-link" data-scroll-target="#sec-mhd-ohm"><span class="header-section-number">8.6.1</span> MHD Ohm’s law</a></li>
  <li><a href="#ideal-mhd" id="toc-ideal-mhd" class="nav-link" data-scroll-target="#ideal-mhd"><span class="header-section-number">8.6.2</span> Ideal MHD</a></li>
  <li><a href="#hall-mhd" id="toc-hall-mhd" class="nav-link" data-scroll-target="#hall-mhd"><span class="header-section-number">8.6.3</span> Hall MHD</a></li>
  </ul></li>
  <li><a href="#sec-fluid-drift-perp" id="toc-sec-fluid-drift-perp" class="nav-link" data-scroll-target="#sec-fluid-drift-perp"><span class="header-section-number">8.7</span> Fluid Drifts Perpendicular to B</a></li>
  <li><a href="#fluid-drifts-parallel-to-b" id="toc-fluid-drifts-parallel-to-b" class="nav-link" data-scroll-target="#fluid-drifts-parallel-to-b"><span class="header-section-number">8.8</span> Fluid Drifts Parallel to B</a></li>
  <li><a href="#sec-plasma_approximation" id="toc-sec-plasma_approximation" class="nav-link" data-scroll-target="#sec-plasma_approximation"><span class="header-section-number">8.9</span> The Plasma Approximation</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/henry2004y/KeyNotes/edit/master/contents/fluid.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-fluid" class="quarto-section-identifier"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Plasmas as Fluid</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>In a plasma the situation is much more complicated than that single particle orbits; the <span class="math inline">\(\mathbf{E}\)</span> and <span class="math inline">\(\mathbf{B}\)</span> fields are not prescribed but are determined by the positions and motions of the charges themselves. One must solve a self-consistent problem; that is, find a set of particle trajectories and field patterns such that the particles will generate the fields as they move along their orbits and the fields will cause the particles to move in those exact orbits. And this must be done in a time-varying situation. It sounds very hard, but it is not.</p>
<p>We have seen that a typical plasma density might be <span class="math inline">\(10^{18}\)</span> ion–electron pairs per <span class="math inline">\(\text{m}^3\)</span>. If each of these particles follows a complicated trajectory and it is necessary to follow each of these, predicting the plasma’s behavior would be a hopeless task. Fortunately, this is not usually necessary because, surprisingly, the majority-perhaps as much as 80%-of plasma phenomena observed in real experiments can be explained by a rather crude model. This model is that used in fluid mechanics, in which the identity of the individual particle is neglected, and only the motion of fluid elements is taken into account. Of course, in the case of plasmas, the fluid contains electrical charges. In an ordinary fluid, frequent collisions between particles keep the particles in a fluid element moving together. It is surprising that such a model works for plasmas, which generally have infrequent collisions. But we shall see that there is a reason for this.</p>
<p>A more refined treatment-the kinetic theory of plasmas-requires more mathematical calculation. An introduction to kinetic theory is given in <a href="kinetic.html" class="quarto-xref"><span>Chapter 12</span></a>.</p>
<p>In some plasma problems, neither fluid theory nor kinetic theory is sufficient to describe the plasma’s behavior. Then one has to fall back on the tedious process of following the individual trajectories. Brute-force computer simulation can play an important role in filling the gap between theory and experiment in those instances where even kinetic theory cannot come close to explaining what is observed.</p>
<section id="definitions" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="definitions"><span class="header-section-number">8.1</span> Definitions</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 45%">
<col style="width: 54%">
</colgroup>
<thead>
<tr class="header">
<th>Variable</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(m_s\)</span></td>
<td>mass</td>
</tr>
<tr class="even">
<td><span class="math inline">\(q_s\)</span></td>
<td>charge</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(n_s\)</span></td>
<td>number density</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\rho_s\)</span></td>
<td>mass density</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\sigma_s, \rho^\ast\)</span></td>
<td>charge density (<span class="math inline">\(=n_s q_s\)</span>)</td>
</tr>
<tr class="even">
<td><span class="math inline">\(T_s\)</span></td>
<td>temperature</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(p_s\)</span></td>
<td>scalar pressure</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\mathbf{u}_s\)</span></td>
<td>flow velocity</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\mathbf{J}_s\)</span></td>
<td>current density (<span class="math inline">\(=\rho_s^\ast \mathbf{u}_s\)</span>)</td>
</tr>
<tr class="even">
<td><span class="math inline">\(e_s\)</span></td>
<td>internal energy</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\phi_s\)</span></td>
<td>potential energy</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\epsilon_s\)</span></td>
<td>total energy (<span class="math inline">\(=e_s+\frac{\mathbf{u_s}^2}{2}+\phi_s\)</span>)</td>
</tr>
</tbody>
</table>
<p>where <span class="math inline">\(s\)</span> denotes the species (e.g.&nbsp;<span class="math inline">\(\text{H}^+, \text{O}^+\)</span>). Do not confuse <span class="math inline">\(\sigma\)</span> here with conductivity. Then the total quantities without subscripts can be written as</p>
<p><span class="math display">\[
\begin{aligned}
&amp;n=\sum_s{n_s} \\
&amp;\rho=\sum_{s}\rho_s=\sum_{s}{m_s n_s} \\
&amp;p=\sum_s{p_s} \\
&amp;T=\sum_s{\frac{n_s}{n}T_s} \\
&amp;\mathbf{u}=\frac{1}{\rho}\sum_s \rho_s \mathbf{u}_s \\
&amp;\mathbf{v}_s=\mathbf{u}_s -\mathbf{u},\quad \text{relative velocity of the } s^{th} \text{ species} \\
&amp;\sigma = \sum_s{\sigma_s}=\sum_s{q_s n_s} \\
&amp;\mathbf{J}=\sum_s{\mathbf{J}_s}=\sum_s{\sigma_s \mathbf{u}_s}=\sum_s{\sigma_s}\mathbf{v}_s+\mathbf{u}\sum_s{\sigma_s}=\sum_s{\sigma_s \mathbf{v}_s}+\sigma\mathbf{u}=\mathbf{J}_{cd}+ \mathbf{J}_{cv} \\
&amp;\quad \text{where } \mathbf{J}_{cd}=\sum_s{\sigma_s}\mathbf{v}_s \text{ is the conduction current density} \\
&amp;\quad \quad \quad \quad\mathbf{J}_{cv}=\sigma \mathbf{u} \text{ is the convection current density} \\
&amp;\epsilon=\frac{1}{\rho}\sum_s{\rho_s\epsilon_s}=e+\frac{u^2}{2}+\phi \text{ (internal + kinetic + potential)}
\end{aligned}
\]</span></p>
<p>It can be easily verified that</p>
<p><span class="math display">\[
\sum_s{\rho_s\mathbf{v}_s}=0
\]</span></p>
<p>In this note we tried to use <span class="math inline">\(\mathbf{v}\)</span> for all species/particle-based velocities, and <span class="math inline">\(\mathbf{u}\)</span> for all bulk velocities.</p>
<p>We have 5 independent unknown quantities for each species: <span class="math inline">\(n_j, \mathbf{u}_j, p_j\)</span>. The pressure can be replaced by temperature <span class="math inline">\(T_j\)</span>. Additionally, we have the 6 EM field quantities: <span class="math inline">\(\mathbf{B}, \mathbf{E}\)</span>. For a 2-fluid despcription with ions and electrons, altogether we have <span class="math inline">\(5*2+6=16\)</span> unknowns, so we need 16 equations to determine the system.</p>
</section>
<section id="relation-of-plasma-to-ordinary-electromagnetics" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="relation-of-plasma-to-ordinary-electromagnetics"><span class="header-section-number">8.2</span> Relation of Plasma to Ordinary Electromagnetics</h2>
<section id="maxwells-equations" class="level3" data-number="8.2.1">
<h3 data-number="8.2.1" class="anchored" data-anchor-id="maxwells-equations"><span class="header-section-number">8.2.1</span> Maxwell’s Equations</h3>
<p>In vacuum:</p>
<p><span id="eq-maxwell_vacuum"><span class="math display">\[
\begin{aligned}
\epsilon_0 \nabla\cdot\mathbf{E} &amp;= \sigma \\
\nabla\times\mathbf{E} &amp;= -\dot{\mathbf{B}} \\
\nabla\cdot\mathbf{B} &amp;= 0 \\
\nabla\times\mathbf{B} &amp;= \mu_0 (\mathbf{J}+\epsilon_0\dot{\mathbf{E}})
\end{aligned}
\tag{8.1}\]</span></span></p>
<p>In a medium:</p>
<p><span id="eq-maxwell_medium"><span class="math display">\[
\begin{aligned}
\nabla\cdot\mathbf{D} &amp;= \sigma \\
\nabla\times\mathbf{E} &amp;= -\dot{\mathbf{B}} \\
\nabla\cdot\mathbf{B} &amp;= 0 \\
\nabla\times\mathbf{H} &amp;= \mathbf{J}+\dot{\mathbf{D}} \\
\mathbf{D} &amp;= \epsilon\mathbf{E} \\
\mathbf{B} &amp;= \mu\mathbf{H}
\end{aligned}
\tag{8.2}\]</span></span></p>
<p><span class="math inline">\(\sigma\)</span> and <span class="math inline">\(\mathbf{J}\)</span> stand for the “free” charge and current densities. The “bound” charge and current densities arising from polarization and magnetization of the medium are included in the definition of the quantities <span class="math inline">\(\mathbf{D}\)</span> and <span class="math inline">\(\mathbf{H}\)</span> in terms of <span class="math inline">\(\epsilon\)</span> and <span class="math inline">\(\mu\)</span>. In a plasma, the ions and electrons comprising the plasma are the equivalent of the “bound” charges and currents. Since these charges move in a complicated way, it is impractical to try to lump their effects into two constants <span class="math inline">\(\epsilon\)</span> and <span class="math inline">\(\mu\)</span>. Consequently, in plasma physics, one generally works with the vacuum equations, in which <span class="math inline">\(\sigma\)</span> and <span class="math inline">\(\mathbf{J}\)</span> include <em>all</em> the charges and currents, both external and internal.</p>
<p>Note that we have used <span class="math inline">\(\mathbf{E}\)</span> and <span class="math inline">\(\mathbf{B}\)</span> in the vacuum equations rather than their counterparts <span class="math inline">\(\mathbf{D}\)</span> and <span class="math inline">\(\mathbf{H}\)</span>, which are related by the constants <span class="math inline">\(\epsilon_0\)</span> and <span class="math inline">\(\mu_0\)</span>. This is because the forces <span class="math inline">\(q\mathbf{E}\)</span> and <span class="math inline">\(\mathbf{J}\times\mathbf{B}\)</span> depend on <span class="math inline">\(\mathbf{E}\)</span> and <span class="math inline">\(\mathbf{B}\)</span> rather than <span class="math inline">\(\mathbf{D}\)</span> and <span class="math inline">\(\mathbf{H}\)</span>, and it is not necessary to introduce the latter quantities as long as one is dealing with the vacuum equations.</p>
</section>
<section id="classical-treatment-of-magnetic-materials" class="level3" data-number="8.2.2">
<h3 data-number="8.2.2" class="anchored" data-anchor-id="classical-treatment-of-magnetic-materials"><span class="header-section-number">8.2.2</span> Classical Treatment of Magnetic Materials</h3>
<p>Since each gyrating particle has a magnetic moment, it would seem that the logical thing to do would be to consider a plasma as a magnetic material with a permeability <span class="math inline">\(\mu_m\)</span>.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> To see why this is <em>not</em> done in practice, let us review the way magnetic materials are usually treated.</p>
<p>The ferromagnetic domains, say, of a piece of iron have magnetic moments <span class="math inline">\(\mu_i\)</span>, giving rise to a bulk magnetization <span class="math display">\[
\mathbf{M} = \frac{1}{V}\sum_i\mu_i
\]</span> per unit volume. This has the same effect as a bound current density equal to <span class="math display">\[
\mathbf{J}_b = \nabla\times\mathbf{M}
\]</span></p>
<p>In the vacuum Ampère’s law, we must include in <span class="math inline">\(\mathbf{J}\)</span> both this current and the “free”, or externally applied, current <span class="math inline">\(\mathbf{J}_f\)</span>:</p>
<p><span class="math display">\[
\mu_0^{-1}\nabla\times\mathbf{B} = \mathbf{J}_f + \mathbf{J}_b + \epsilon_0 \dot{\mathbf{E}}
\]</span></p>
<p>We wish to write this equation in the simple form <span class="math display">\[
\nabla\times\mathbf{H} = \mathbf{J}_f + \epsilon_0\dot{\mathbf{E}}
\]</span> by including <span class="math inline">\(\mathbf{J}_b\)</span> in the definition of <span class="math inline">\(\mathbf{H}\)</span>. This can be done if we let <span class="math display">\[
\mathbf{H} = \mu_0^{-1}\mathbf{B} - \mathbf{M}
\]</span></p>
<p>To get a simple relation between <span class="math inline">\(\mathbf{B}\)</span> and <span class="math inline">\(\mathbf{H}\)</span>, we assume <span class="math inline">\(\mathbf{M}\)</span> to be proportional to <span class="math inline">\(\mathbf{B}\)</span> or <span class="math inline">\(\mathbf{H}\)</span>: <span class="math display">\[
\mathbf{M} = \chi_m \mathbf{H}
\]</span></p>
<p>The constant <span class="math inline">\(\chi_m\)</span> is the magnetic susceptibility. We now have <span class="math display">\[
\mathbf{B} = \mu_0(1+\chi_m)\mathbf{H} \equiv \mu_m \mathbf{H}
\]</span></p>
<p>This simple relation between <span class="math inline">\(\mathbf{B}\)</span> and <span class="math inline">\(\mathbf{H}\)</span> is possible because of the linear relation between <span class="math inline">\(\mathbf{M}\)</span> and <span class="math inline">\(\mathbf{H}\)</span>.</p>
<p>In a plasma with a magnetic field, each particle has a magnetic moment <span class="math inline">\(\mu_\alpha\)</span>, and the quantity <span class="math inline">\(\mathbf{M}\)</span> is the sum of all these <span class="math inline">\(\mu_\alpha\)</span>’s in 1 <span class="math inline">\(\text{m}^3\)</span>. But now we have <span class="math display">\[
\mu_\alpha = \frac{mv_{\perp\alpha}^2}{2B}\propto \frac{1}{B}\quad \mathbf{M}\propto \frac{1}{B}
\]</span></p>
<p>The relation between <span class="math inline">\(\mathbf{M}\)</span> and <span class="math inline">\(\mathbf{H}\)</span> (or <span class="math inline">\(\mathbf{B}\)</span>) is no longer linear, and we cannot write <span class="math inline">\(\mathbf{B} = \mu_m\mathbf{H}\)</span> with <span class="math inline">\(\mu_m\)</span> constant. It is therefore not useful to consider a plasma as a magnetic medium.</p>
</section>
<section id="classical-treatment-of-dielectrics" class="level3" data-number="8.2.3">
<h3 data-number="8.2.3" class="anchored" data-anchor-id="classical-treatment-of-dielectrics"><span class="header-section-number">8.2.3</span> Classical Treatment of Dielectrics</h3>
<p>The polarization <span class="math inline">\(\mathbf{P}\)</span> per unit volume is the sum over all the individual moments <span class="math inline">\(\mathbf{p}_i\)</span> of the electric dipoles. This gives rise to a bound charge density</p>
<p><span id="eq-bound_charge_polarization"><span class="math display">\[
\sigma_b = -\nabla\cdot\mathbf{P}
\tag{8.3}\]</span></span></p>
<p>In the vacuum equation, we must include both the bound charge and the free charge:</p>
<p><span class="math display">\[
\epsilon_0\nabla\cdot\mathbf{E} = \sigma_f + \sigma_b
\]</span></p>
<p>We wish to write this in the simple form</p>
<p><span class="math display">\[
\nabla\cdot\mathbf{D} = \sigma_f
\]</span></p>
<p>by including <span class="math inline">\(\sigma_b\)</span> in the definition of <span class="math inline">\(\mathbf{D}\)</span>. This can be done by letting</p>
<p><span class="math display">\[
\mathbf{D} = \epsilon_0\mathbf{E} + \mathbf{P} \equiv \epsilon \mathbf{E}
\]</span></p>
<p>If <span class="math inline">\(\mathbf{P}\)</span> is linearly proportional to <span class="math inline">\(\mathbf{E}\)</span>,</p>
<p><span class="math display">\[
\mathbf{P} = \epsilon_0 \chi_e\mathbf{E}
\]</span></p>
<p>then <span class="math inline">\(\epsilon\)</span> is a constant given by</p>
<p><span class="math display">\[
\epsilon = (1+\chi_e)\epsilon_0
\]</span></p>
<p>There is no a priori reason why a relation like the above cannot be valid in a plasma, so we may proceed to try to get an expression for <span class="math inline">\(\epsilon\)</span> in a plasma.</p>
</section>
<section id="the-dielectric-constant-of-a-plasma" class="level3" data-number="8.2.4">
<h3 data-number="8.2.4" class="anchored" data-anchor-id="the-dielectric-constant-of-a-plasma"><span class="header-section-number">8.2.4</span> The Dielectric Constant of a Plasma</h3>
<p>We have seen in <a href="single.html#sec-time-varying_E" class="quarto-xref"><span>Section 7.4</span></a> that a fluctuating <span class="math inline">\(\mathbf{E}\)</span> field gives rise to a polarization current <span class="math inline">\(\mathbf{J}_p\)</span>. This leads, in turn, to a polarization charge given by the equation of continuity:</p>
<p><span class="math display">\[
\frac{\partial \sigma_p}{\partial t} + \nabla\cdot\mathbf{J}_p = 0
\]</span></p>
<p>This is the equivalent of <a href="#eq-bound_charge_polarization" class="quarto-xref">Equation&nbsp;<span>8.3</span></a>, except that, as we noted before, a polarization effect does not arise in a plasma unless the electric field is time varying. Since we have an explicit expression for <span class="math inline">\(\mathbf{J}_p\)</span> but not for <span class="math inline">\(\sigma_p\)</span>, it is easier to work with the Ampère’s law:</p>
<p><span class="math display">\[
\nabla\times\mathbf{B} = \mu_0(\mathbf{J}_f +\mathbf{J}_p + \epsilon\dot{\mathbf{E}})
\]</span></p>
<p>We wish to write this in the form</p>
<p><span class="math display">\[
\nabla\times\mathbf{B} = \mu_0(\mathbf{J}_f + \epsilon\dot{\mathbf{E}})
\]</span></p>
<p>This can be done if we let</p>
<p><span class="math display">\[
\epsilon = \epsilon_0 + \frac{j_p}{\dot{E}}
\]</span></p>
<p>From <a href="single.html#eq-polarization_current" class="quarto-xref">Equation&nbsp;<span>7.12</span></a> for <span class="math inline">\(\mathbf{J}_p\)</span>, we have</p>
<p><span id="eq-dielectric_constant_low-frequency"><span class="math display">\[
\epsilon = \epsilon_0 + \frac{\rho}{B^2}\quad \text{or}\quad \epsilon_R\equiv \frac{\epsilon}{\epsilon_0} = 1+\frac{\mu_0\rho c^2}{B^2}
\tag{8.4}\]</span></span></p>
<p>This is the <em>low-frequency plasma dielectric constant for transverse motions</em>. The qualifications are necessary because our expression for <span class="math inline">\(\mathbf{J}_p\)</span> is valid only for <span class="math inline">\(\omega^2\ll\omega_c^2\)</span> and for <span class="math inline">\(\mathbf{E}\)</span> perpendicular to <span class="math inline">\(\mathbf{B}\)</span>. The general expression for <span class="math inline">\(\epsilon\)</span>, of course, is very complicated and hardly fits on one page.</p>
<p>Note that as <span class="math inline">\(\rho\rightarrow 0\)</span>, <span class="math inline">\(\epsilon_R\)</span> approaches its vacuum value, unity, as it should. As <span class="math inline">\(B\rightarrow\infty\)</span>, <span class="math inline">\(\epsilon_R\)</span> also approaches unity. This is because the polarization drift <span class="math inline">\(\mathbf{v}_p\)</span> then vanishes, and the particles do not move in response to the transverse electric field. In a usual laboratory plasma, the second term in <a href="#eq-dielectric_constant_low-frequency" class="quarto-xref">Equation&nbsp;<span>8.4</span></a> is large compared with unity. For instance, if <span class="math inline">\(n=10^{16}\,\text{m}^{-3}\)</span> and <span class="math inline">\(B=0.1\,\text{T}\)</span> we have (for hydrogen) <span class="math display">\[
\frac{\mu_0\rho c^2}{B^2} = \frac{(4\pi\times 10^{-7})(10^{16})(1.67\times 10^{-27})(3\times 10^8)^2}{(0.1)^2} = 189
\]</span></p>
<p>This means that the electric fields due to the particles in the plasma greatly alter the fields applied externally. A plasma with large <span class="math inline">\(\epsilon\)</span> shields out alternating fields, just as a plasma with small <span class="math inline">\(\lambda_D\)</span> shields out dc fields.</p>
</section>
</section>
<section id="fluid-equations" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="fluid-equations"><span class="header-section-number">8.3</span> Fluid Equations</h2>
<p>In <span class="citation" data-cites="chen2016introduction">(<a href="#ref-chen2016introduction" role="doc-biblioref">Chen 2016</a>)</span>, this is introduced in the diffusion chapter 5.7, which is a bit weird. In <span class="citation" data-cites="bellan2008fundamentals">(<a href="#ref-bellan2008fundamentals" role="doc-biblioref">Bellan 2008</a>)</span>, this is introduced in chapter 2 where Vlasov equation is first derived and then follows the simplifications which lead to 2-fluid and MHD.</p>
<section id="equation-of-continuity" class="level3" data-number="8.3.1">
<h3 data-number="8.3.1" class="anchored" data-anchor-id="equation-of-continuity"><span class="header-section-number">8.3.1</span> Equation of Continuity</h3>
<p>The integral form of mass conservation for each species is <span class="math display">\[
\frac{\mathrm{d}}{\mathrm{d}t}\int_V \rho_s dx^3=0
\]</span></p>
<p>The conservation of matter requires that the total number of particles <span class="math inline">\(N_s\)</span> in a volume V can change only if there is a net flux of particles across the surface S bounding that volume. Since the particle flux density is <span class="math inline">\(n_s\mathbf{u}_s\)</span>, we have, by the divergence theorem, <span class="math display">\[
\frac{\partial N_s}{\partial t} = \int_V\frac{\partial n_s}{\partial t}dV = -\oint n\mathbf{u}_s\cdot \mathrm{d}\mathbf{S} = - \int_V \nabla\cdot(n_s\mathbf{u}_s)dV
\]</span></p>
<p>Since this must hold for any volume V, the integrands must be equal: <span id="eq-continuity-species"><span class="math display">\[
\frac{\partial n_s}{\partial t} + \nabla\cdot(n_s\mathbf{u}_s) = 0
\tag{8.5}\]</span></span></p>
<p>There is one such <em>equation of continuity</em> for each species. Any sources or sinks of particles are to be added to the right-hand side.</p>
</section>
<section id="momentum-equation" class="level3" data-number="8.3.2">
<h3 data-number="8.3.2" class="anchored" data-anchor-id="momentum-equation"><span class="header-section-number">8.3.2</span> Momentum Equation</h3>
<p>Maxwell’s equations tell us what <span class="math inline">\(\mathbf{E}\)</span> and <span class="math inline">\(\mathbf{B}\)</span> are for a given state of the plasma. To solve the self-consistent problem, we must also have an equation giving the plasma’s response to given <span class="math inline">\(\mathbf{E}\)</span> and <span class="math inline">\(\mathbf{B}\)</span>. In the fluid approximation, we consider the plasma to be composed of two or more interpenetrating fluids, one for each species. In the simplest case, when there is only one species of ion, we shall need two equations of motion, one for the positively charged ion fluid and one for the negatively charged electron fluid. In a partially ionized gas, we shall also need an equation for the fluid of neutral atoms. The neutral fluid will interact with the ions and electrons only through collisions. The ion and electron fluids will interact with each other even in the absence of collisions, because of the <span class="math inline">\(\mathbf{E}\)</span> and <span class="math inline">\(\mathbf{B}\)</span> fields they generate.</p>
<p>The equation of motion for a single particle is <span id="eq-single_motion"><span class="math display">\[
m\frac{\mathrm{d}\mathbf{v}}{\mathrm{d}t} = q(\mathbf{E}+\mathbf{v}\times\mathbf{B})
\tag{8.6}\]</span></span></p>
<p>Assume first that there are no collisions and no thermal motions. Then all the particles in a fluid element move together, and the average velocity <span class="math inline">\(\mathbf{u}\)</span> of the particles in the element is the same as the individual particle velocity <span class="math inline">\(\mathbf{v}\)</span>. The fluid equation is obtained simply by multiplying <a href="#eq-single_motion" class="quarto-xref">Equation&nbsp;<span>8.6</span></a> by the density <span class="math inline">\(n\)</span>: <span id="eq-single_fluid1"><span class="math display">\[
mn\frac{\mathrm{d}\mathbf{u}}{\mathrm{d}t} = qn(\mathbf{E}+\mathbf{u}\times\mathbf{B})
\tag{8.7}\]</span></span></p>
<p>This is, however, not a convenient form to use. In <a href="#eq-single_motion" class="quarto-xref">Equation&nbsp;<span>8.6</span></a>, the time derivative is to be taken <em>at the position of the particles</em>. On the other hand, we wish to have an equation for fluid elements <em>fixed in space</em>, because it would be impractical to do otherwise. Consider a drop of cream in a cup of coffee as a fluid element. As the coffee is stirred, the drop distorts into a filament and finally disperses all over the cup, losing its identity. A fluid element at a fixed spot in the cup, however, retains its identity although particles continually go in and out of it.</p>
<p>To make the transformation to variables in a fixed frame, consider <span class="math inline">\(\mathbf{G}(x,t)\)</span> to be any property of a fluid in one-dimensional x space. The change of <span class="math inline">\(\mathbf{G}\)</span> with time <em>in a frame moving with the fluid</em> is the sum of two terms: <span class="math display">\[
\frac{\mathrm{d}\mathbf{G}(x,t)}{\mathrm{d}t} = \frac{\partial \mathbf{G}}{\partial t} + \frac{\partial \mathbf{G}}{\partial x}\frac{\partial x}{\partial t} = \frac{\partial \mathbf{G}}{\partial t} + u_x\frac{\partial \mathbf{G}}{\partial x}
\]</span></p>
<p>The first term on the right represents the change of <span class="math inline">\(\mathbf{G}\)</span> at a fixed point in space, and the second term represents the change of G as the observer moves with the fluid into a region in which <span class="math inline">\(\mathbf{G}\)</span> is different. In three dimensions, this generalizes to <span class="math display">\[
\frac{\mathrm{d}\mathbf{G}}{\mathrm{d}t} = \frac{\partial \mathbf{G}}{\partial t} + (\mathbf{u}\cdot\nabla)\mathbf{G}
\]</span></p>
<p>This is called the <em>convective derivative</em> (<a href="math.html#eq-convective-derivative" class="quarto-xref">Equation&nbsp;<span>3.2</span></a>).</p>
<p>In the case of a plasma, we take <span class="math inline">\(\mathbf{G}\)</span> to be the fluid velocity <span class="math inline">\(\mathbf{u}\)</span> and write <a href="#eq-single_fluid1" class="quarto-xref">Equation&nbsp;<span>8.7</span></a> as <span class="math display">\[
mn\Big[\frac{\partial\mathbf{u}}{\partial t} + (\mathbf{u}\cdot\nabla)\mathbf{u}\Big] = qn(\mathbf{E}+\mathbf{u}\times\mathbf{B})
\]</span></p>
<p>where <span class="math inline">\(\partial\mathbf{u}/\partial t\)</span> is the time derivative in a fixed frame.</p>
<p><strong>Stress Tensor</strong> –&gt; scalar pressure</p>
<p><span id="eq-single_fluid2"><span class="math display">\[
mn\Big[\frac{\partial\mathbf{u}}{\partial t} + (\mathbf{u}\cdot\nabla)\mathbf{u}\Big] = qn(\mathbf{E}+\mathbf{u}\times\mathbf{B}) - \nabla p
\tag{8.8}\]</span></span></p>
<p>What we have shown here is only a special case: the transfer of <span class="math inline">\(x\)</span> momentum by motion in the <span class="math inline">\(x\)</span> direction; and we have assumed that the fluid is isotropic, so that the same result holds in the y and z directions. But it is also possible to transfer <span class="math inline">\(y\)</span> momentum by motion in the <span class="math inline">\(x\)</span> direction, for instance. This shear stress cannot be represented by a scalar <span class="math inline">\(p\)</span> but must be given by a tensor <span class="math inline">\(\mathbf{P}\)</span>, the stress tensor, whose components <span class="math inline">\(P_{ij}= mn\overline{v_i v_j}\)</span> specify both the direction of motion and the component of momentum involved. In the general case the term <span class="math inline">\(\nabla p\)</span> is replaced by <span class="math inline">\(-\nabla\cdot\mathbf{P}\)</span>.</p>
<p>When the distribution function is an isotropic Maxwellian, <span class="math inline">\(\mathbf{P}\)</span> is written <span class="math display">\[
\mathbf{P} = \begin{pmatrix}p &amp; 0 &amp; 0 \\ 0 &amp; p &amp; 0 \\ 0 &amp; 0 &amp; p\end{pmatrix}
\]</span></p>
<p><span class="math inline">\(-\nabla\cdot\mathbf{P} = \nabla p\)</span>. A plasma could have two temperatures <span class="math inline">\(T_\perp\)</span> and <span class="math inline">\(T_\parallel\)</span> in the presence of a magnetic field. In that case, there would be two pressures <span class="math inline">\(T_\perp\)</span> and <span class="math inline">\(T_\parallel\)</span> in the presence of a magnetic field. In that case, there would be two pressure <span class="math inline">\(p_\perp = nk_B T_\perp\)</span> and <span class="math inline">\(p_\parallel = nk_B T_\parallel\)</span>. The stress tensor is then <span class="math display">\[
\mathbf{P} = \begin{pmatrix}p_\perp &amp; 0 &amp; 0 \\ 0 &amp; p_\perp &amp; 0 \\ 0 &amp; 0 &amp; p_\parallel\end{pmatrix}
\]</span></p>
<p>where the coordinate of the third row or column is the direction of <span class="math inline">\(\mathbf{B}\)</span>. This is still diagonal and shows isotropy in a plane perpendicular to <span class="math inline">\(\mathbf{B}\)</span>.</p>
<p>In an ordinary fluid, the off-diagonal elements of <span class="math inline">\(\mathbf{P}\)</span> are usually associated with viscosity. When particles make collisions, they come off with an average velocity in the direction of the fluid velocity <span class="math inline">\(\mathbf{u}\)</span> at the point where they made their last collision. This momentum is transferred to another fluid element upon the next collision. This tends to equalize <span class="math inline">\(\mathbf{u}\)</span> at different points, and the resulting resistance to shear flow is what we intuitively think of as viscosity. The longer the mean free path, the farther momentum is carried, and the larger is the viscosity. In a plasma there is a similar effect which occurs even in the absence of collisions. The Larmor gyration of particles (particularly ions) brings them into different parts of the plasma and tends to equalize the fluid velocities there. The Larmor radius rather than the mean free path sets the scale of this kind of collisionless viscosity. It is a <em>finite-Larmor-radius effect</em> which occurs in addition to collisional viscosity and is closely related to the <span class="math inline">\(\mathbf{v}_E\)</span> drift in a nonuniform <span class="math inline">\(\mathbf{E}\)</span> field (<a href="single.html#eq-vE" class="quarto-xref">Equation&nbsp;<span>7.11</span></a>).</p>
<section id="collisions" class="level4" data-number="8.3.2.1">
<h4 data-number="8.3.2.1" class="anchored" data-anchor-id="collisions"><span class="header-section-number">8.3.2.1</span> Collisions</h4>
<p>If there is a neutral gas, the charged fluid will exchange momentum with it through collisions. The momentum lost per collision will be proportional to the relative velocity <span class="math inline">\(\mathbf{u}-\mathbf{u}_0\)</span>, where <span class="math inline">\(\mathbf{u}_0\)</span> is the velocity of the neutral fluid. If <span class="math inline">\(\tau\)</span>, the mean free time between collisions, is approximately constant, the resulting force term can be roughly written as <span class="math inline">\(-mn(\mathbf{u}-\mathbf{u}_0)/\tau\)</span>. The equation of motion can be generalized to include anisotropic pressure and neutral collisions as follows: <span id="eq-momentum_single"><span class="math display">\[
mn\Big[\frac{\partial\mathbf{u}}{\partial t} + (\mathbf{u}\cdot\nabla)\mathbf{u}\Big] = qn(\mathbf{E}+\mathbf{u}\times\mathbf{B}) - \nabla\cdot\overleftrightarrow{P} - \frac{mn(\mathbf{u}-\mathbf{u}_0)}{\tau}
\tag{8.9}\]</span></span></p>
<p>This can also be written as (including the pressure term and other forces) <span class="math display">\[
\rho\frac{\mathrm{d}\mathbf{u}}{\mathrm{d}t}=(\rho^\ast \mathbf{E}+\mathbf{J}\times\mathbf{B})-\nabla\cdot\overleftrightarrow{P}+\mathbf{f}_n
\]</span></p>
<p>or, in an equivalent conservative form, <span class="math display">\[
\frac{\partial (\rho\mathbf{u})}{\partial t}+\nabla\cdot(\rho\mathbf{u}\mathbf{u})=(\rho^\ast \mathbf{E}+\mathbf{J}\times\mathbf{B})-\nabla\cdot\overleftrightarrow{P}+\mathbf{f}_n
\]</span></p>
<p>Collisions between charged particles have not been included; these will be discussed in sec-collision ADD IT!.</p>
</section>
<section id="comparison-with-ordinary-hydrodynamics" class="level4" data-number="8.3.2.2">
<h4 data-number="8.3.2.2" class="anchored" data-anchor-id="comparison-with-ordinary-hydrodynamics"><span class="header-section-number">8.3.2.2</span> Comparison with Ordinary Hydrodynamics</h4>
<p>Ordinary fluids obey the Navier–Stokes equation</p>
<p><span id="eq-navier_stokes"><span class="math display">\[
\rho\Big[ \frac{\partial\mathbf{u}}{\partial t} + (\mathbf{u}\cdot\nabla)\mathbf{u} \Big] = -\nabla p + \rho\nu\nabla^2\mathbf{u}
\tag{8.10}\]</span></span></p>
<p>This is the same as <a href="#eq-momentum_single" class="quarto-xref">Equation&nbsp;<span>8.9</span></a> except for the absence of electromagnetic forces and collisions between species (there being only one species). The viscosity term <span class="math inline">\(\rho\nu\nabla^2\mathbf{u}\)</span>, where <span class="math inline">\(\nu\)</span> is the kinematic viscosity coefficient, is just the collisional part of <span class="math inline">\(\nabla\cdot\overleftrightarrow{P} - \nabla p\)</span> in the absence of magnetic fields. <a href="#eq-navier_stokes" class="quarto-xref">Equation&nbsp;<span>8.10</span></a> describes a fluid in which there are frequent collisions between particles. <a href="#eq-momentum_single" class="quarto-xref">Equation&nbsp;<span>8.9</span></a>, on the other hand, was derived without any explicit statement of the collision rate. Since the two equations are identical except for the <span class="math inline">\(\mathbf{E}\)</span> and <span class="math inline">\(\mathbf{B}\)</span> terms, can <a href="#eq-momentum_single" class="quarto-xref">Equation&nbsp;<span>8.9</span></a> really describe a plasma species? The answer is a guarded yes, and the reasons for this will tell us the limitations of the fluid theory. This is extremely important to clarify — there are still quite many people think that collision is assumed for the fluid theory, therefore do not believe that MHD can be used to describe plasmas.</p>
<p>In the derivation of <a href="#eq-momentum_single" class="quarto-xref">Equation&nbsp;<span>8.9</span></a>, we did actually assume implicitly that there were many collisions. This assumption came in the derivation of the pressure tensor (<a href="kinetic.html#sec-kinetic-fluid-moments" class="quarto-xref"><span>Section 12.4</span></a>) when we took the velocity distribution to be Maxwellian. Such a distribution generally comes about as the result of frequent collisions. However, this assumption was used only to take the average of <span class="math inline">\(v^2\)</span>. Any other distribution with the same average would give us the same answer. The fluid theory, therefore, is not very sensitive to deviations from the Maxwellian distribution, but there are instances in which these deviations are important. Kinetic theory must then be used.</p>
<p>There is also an empirical observation by Irving Langmuir which helps the fluid theory. In working with the electrostatic probes which bear his name, Langmuir discovered that the electron distribution function was far more nearly Maxwellian than could be accounted for by the collision rate. This phenomenon, called <em>Langmuir’s paradox</em>, has been attributed at times to high-frequency oscillations. There has been no satisfactory resolution of the paradox, but this seems to be one of the few instances in plasma physics where nature works in our favor.</p>
<p>Another reason the fluid model works for plasmas is that the magnetic field, when there is one, can play the role of collisions in a certain sense. When a particle is accelerated, say by an <span class="math inline">\(\mathbf{E}\)</span> field, it would continuously increase in velocity if it were allowed to free-stream. When there are frequent collisions, the particle comes to a limiting velocity proportional to <span class="math inline">\(\mathbf{E}\)</span>. The electrons in a copper wire, for instance, drift together with a velocity <span class="math inline">\(\mathbf{v}=\mu\mathbf{E}\)</span>, where <span class="math inline">\(\mu\)</span> is the mobility. A magnetic field also limits free-streaming by forcing particles to gyrate in Larmor orbits. The electrons in a plasma also drift together with a velocity proportional to <span class="math inline">\(\mathbf{E}\)</span>, namely, <span class="math inline">\(\mathbf{v}_E=\mathbf{E}\times\mathbf{B}/B^2\)</span>. In this sense, a collisionless plasma behaves like a collisional fluid. Of course, particles do free-stream <em>along</em> the magnetic field, and the fluid picture is not particularly suitable for motions in that direction. <em>For motions perpendicular to <span class="math inline">\(\mathbf{B}\)</span>, the fluid theory is a good approximation</em>.</p>
</section>
</section>
<section id="equation-of-state" class="level3" data-number="8.3.3">
<h3 data-number="8.3.3" class="anchored" data-anchor-id="equation-of-state"><span class="header-section-number">8.3.3</span> Equation of State</h3>
<p>One more relation is needed to close the system of equations. A complete description requires the equation of energy. However, the simplest way is to use the thermodynamic equation of state relating <span class="math inline">\(p\)</span> to <span class="math inline">\(n\)</span>: <span id="eq-eos_adiabatic"><span class="math display">\[
p = C\rho^\gamma
\tag{8.11}\]</span></span></p>
<p>where <span class="math inline">\(C\)</span> is a constant and <span class="math inline">\(\gamma\)</span> is the ratio of specific heats <span class="math inline">\(C_p/C_\nu\)</span>. The term <span class="math inline">\(\nabla p\)</span> is therefore given by <span id="eq-eos_nabla_p"><span class="math display">\[
\frac{\nabla p}{p} = \gamma \frac{\nabla n}{n}
\tag{8.12}\]</span></span></p>
<p>For isothermal compression, we have <span class="math display">\[
\nabla p = \nabla(nk_B T) = k_B T\nabla n
\]</span></p>
<p>so that, clearly, <span class="math inline">\(\gamma=1\)</span>. For adiabatic compression, <span class="math inline">\(k_B T\)</span> will also change, giving <span class="math inline">\(\gamma\)</span> a value larger than one. If <span class="math inline">\(N\)</span> is the number of degrees of freedom, <span class="math inline">\(\gamma\)</span> is given by <span class="math display">\[
\gamma = (2+N)/N
\]</span></p>
<p>The validity of the equation of state requires that heat flow be negligible; that is, that thermal conductivity be low. Again, this is more likely to be true in directions perpendicular to <span class="math inline">\(\mathbf{B}\)</span> than parallel to it. Fortunately, most basic phenomena can be described adequately by the crude assumption of the equation of state.</p>
</section>
</section>
<section id="sec-2fluid" class="level2" data-number="8.4">
<h2 data-number="8.4" class="anchored" data-anchor-id="sec-2fluid"><span class="header-section-number">8.4</span> Two-Fluid Model</h2>
<p>Besides the Vlasov theory (<a href="kinetic.html" class="quarto-xref"><span>Chapter 12</span></a>), we can apply the simpler but equally powerful 2-fluid model, in which electrons and ions are treated as two different fluids. Depending on the form of the pressure term, we have the 5/6/10-moment equations.</p>
<section id="five-moment" class="level3" data-number="8.4.1">
<h3 data-number="8.4.1" class="anchored" data-anchor-id="five-moment"><span class="header-section-number">8.4.1</span> Five-moment</h3>
<p>Five-moment refers to <span class="math inline">\((\rho, \mathbf{u}, p)\)</span>. Under either adiabatic or isothermal assumptions, we can get rid of the pressure/energy equation and replace it with an equation of state. For simplicity, let the plasma have only two species: ions and electrons; extension to more species is trivial. The charge and current densities are then given by <span class="math display">\[
\begin{aligned}
\sigma &amp;= n_i q_i + n_e q_e \\
\mathbf{J} &amp;= n_i q_i \mathbf{v}_i + n_e q_e \mathbf{v}_e
\end{aligned}
\]</span></p>
<p>We shall neglect collisions and viscosity. The complete equation set is: <span id="eq-fluid_set"><span class="math display">\[
\begin{aligned}
\epsilon_0\nabla\cdot\mathbf{E} = n_i q_i + n_e q_e \\
\nabla\times\mathbf{E} = -\dot{\mathbf{B}} \\
\nabla\cdot\mathbf{B} = 0 \\
\mu_0^{-1}\nabla\times\mathbf{B} = n_i q_i \mathbf{u}_i + n_e q_e \mathbf{u}_e + \epsilon_0\dot{\mathbf{E}} \\
m_jn_j\Big[ \frac{\partial\mathbf{u}_j}{\partial t}+(\mathbf{u}_j\cdot\nabla)\mathbf{u}_j\Big] = q_j n_j (\mathbf{E}+\mathbf{u}_j\times\mathbf{B}) - \nabla p_j\quad j=i,e \\
\frac{\partial n_j}{\partial t} + \nabla\cdot(n_j\mathbf{u}_j) = 0\quad j=i,e \\
p_j = C_j n_j^\gamma\quad j=i,e
\end{aligned}
\tag{8.13}\]</span></span> where <span class="math inline">\(C_j\)</span> is a constant and <span class="math inline">\(\gamma\)</span> is the adiabatic index with the approximations in <a href="#tbl-eos-approx" class="quarto-xref">Table&nbsp;<span>8.1</span></a>.</p>
<div id="tbl-eos-approx" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-eos-approx-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;8.1: Equation of state approximations.
</figcaption>
<div aria-describedby="tbl-eos-approx-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 24%">
<col style="width: 57%">
<col style="width: 18%">
</colgroup>
<thead>
<tr class="header">
<th>Regime</th>
<th>Equation of state</th>
<th>Name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(v_\mathrm{ph} \gg v_{ts}\)</span></td>
<td><span class="math inline">\(p_s\sim n_s^\gamma\)</span></td>
<td>adiabatic</td>
</tr>
<tr class="even">
<td><span class="math inline">\(v_\mathrm{ph} \ll v_{ts}\)</span></td>
<td><span class="math inline">\(p_s=n_s k_B T_s\)</span>, <span class="math inline">\(T_s=\mathrm{const.}\)</span></td>
<td>isothermal</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>There are 16 scalar unknowns: <span class="math inline">\(n_i, n_e, p_i, p_e, \mathbf{u}_i, \mathbf{u}_e, \mathbf{E}\)</span>, and <span class="math inline">\(\mathbf{B}\)</span>. There are apparently 18 scalar equations if we count each vector equation as three scalar equations. However, two of Maxwell’s equations are superfluous, since the two of the equations can be recovered from the divergences of the other two. The simultaneous solution of this set of 16 equations in 16 unknowns gives a self-consistent set of fields and motions in the fluid approximation.</p>
</section>
<section id="six-moment" class="level3" data-number="8.4.2">
<h3 data-number="8.4.2" class="anchored" data-anchor-id="six-moment"><span class="header-section-number">8.4.2</span> Six-moment</h3>
<p>For monatomic gases, the six-moment equations for all charged fluids (indexed by <span class="math inline">\(s\)</span>) can be written as: <span id="eq-6-moment-fluids"><span class="math display">\[
\begin{aligned}
\frac{\partial \rho_s}{\partial t} + \nabla\cdot(\rho_s\mathbf{u}_s) = 0 \\
\frac{\partial (\rho_s\mathbf{u}_s)}{\partial t} + \nabla\cdot\left[ \rho_s\mathbf{u}_s\mathbf{u}_s + p_{s\perp}\pmb{I} + (p_{s\parallel} - p_{s\perp})\hat{b}\hat{b} \right] = \frac{q_s}{m_s}\rho_s(\mathbf{E} + \mathbf{u}_s\times\mathbf{B}) \\
\frac{\partial p_{s\parallel}}{\partial t} + \nabla\cdot(p_{s\parallel}\mathbf{u}_s) = -2p_{s\parallel}\hat{b}\cdot(\hat{b}\cdot\nabla)\mathbf{u}_s \\
\frac{\partial p_{s\perp}}{\partial t} + \nabla\cdot(p_{s\perp}\mathbf{u}_s) = -p_{s\perp}(\nabla\cdot\mathbf{u}_s) + p_{s\perp}\hat{b}\cdot(\hat{b}\cdot\nabla)\mathbf{u}_s
\end{aligned}
\tag{8.14}\]</span></span></p>
<p>The two pressure equations in <a href="#eq-6-moment-fluids" class="quarto-xref">Equation&nbsp;<span>8.14</span></a> can be combined to give the equation for the average pressure <span class="math inline">\(p=(2p_\perp + p_\parallel)/3\)</span>: <span id="eq-6-moment_average_p"><span class="math display">\[
\frac{\partial p_s}{\partial t} + \nabla\cdot(p_s\mathbf{u}_s) = (p_s - p_{s\parallel})\hat{b}\cdot(\hat{b}\cdot\nabla)\mathbf{u}_s - \left( p_s - \frac{p_{s\parallel}}{3} \right)\nabla\cdot\mathbf{u}_s
\tag{8.15}\]</span></span></p>
<p>Alternatively, we can solve for the hydrodynamic energy density <span class="math inline">\(e = \frac{n\mathbf{u}^2}{2} + \frac{3}{2}p\)</span> for each species: <span class="math display">\[
\frac{\partial e_s}{\partial t} + \nabla\cdot\left[ \mathbf{u}_s(e_s+p_s) + \mathbf{u}_s\cdot(p_{s\parallel} - p_{s\perp})\hat{b}\hat{b} \right] = \frac{q_s}{m_s}\rho_s \mathbf{u}_s\cdot\mathbf{E}
\]</span></p>
<p>which is more of a conservative form and can be beneficial to get better jump conditions across shock waves. Note, however, that the parallel pressure equation is still solved with the adiabatic assumption, so non-adiabatic heating is not properly captured. In addition, the magnetic energy is not included into the energy density, so the jump conditions are only approximate (I think this is more of a numerical consideration). In general, there can be many more source terms on the right hand sides of the above equations corresponding to gravity, charge exchange, chemical reactions, collisions, etc.</p>
<p>The electric field <span class="math inline">\(\mathbf{E}\)</span> and magnetic field <span class="math inline">\(\mathbf{B}\)</span> are obtained from Maxwell’s equations: <span class="math display">\[
\begin{aligned}
\frac{\partial \mathbf{B}}{\partial t} + \nabla\times\mathbf{E} &amp;= 0 \\
\frac{\partial \mathbf{E}}{\partial t} - c^2\nabla\times\mathbf{B} &amp;= -c^2\mu_0\mathbf{J} \\
\nabla\cdot\mathbf{E} &amp;= \frac{\rho_c}{\epsilon_0} \\
\nabla\cdot\mathbf{B} &amp;= 0
\end{aligned}
\]</span> where <span class="math inline">\(\rho_c = \sum_s (q_s/m_s)\rho_s\)</span> is the total charge density and <span class="math inline">\(\mathbf{J}=\sum_s(q_s/m_s)\rho_s\mathbf{u}_s\)</span> is the current density.</p>
<p>The last two equations are constraints on the initial conditions; these are not guaranteed to hold numerically. Classical tricks involves using hyperbolic/parabolic cleaning or a facially-collocated Yee-type mesh.</p>
</section>
<section id="fiveten-moment" class="level3" data-number="8.4.3">
<h3 data-number="8.4.3" class="anchored" data-anchor-id="fiveten-moment"><span class="header-section-number">8.4.3</span> Five/Ten-moment</h3>
<p><span class="citation" data-cites="wang2020exact">(<a href="#ref-wang2020exact" role="doc-biblioref">Wang et al. 2020</a>)</span></p>
<ul>
<li><p>Continuity equation for each species <span class="math display">\[
\frac{\partial(m_s n_s)}{\partial t} + \frac{\partial(m_sn_su_{j,s})}{\partial x_j} = 0
\]</span></p></li>
<li><p>Momentum equation for each species <span class="math display">\[
n_s m_s\frac{\mathrm{d}\mathbf{u}_s}{\mathrm{d}t} = n_s q_s(\mathbf{E}+\mathbf{u}\times\mathbf{B}) - \nabla\cdot\overleftrightarrow{P}_s - \mathbf{R}_{s\alpha}
\]</span> or in Einstein’s notation, <span class="math display">\[
\begin{aligned}
\frac{\partial(m_s n_s u_{i,s})}{\partial t} = n_s q_s (E_i + \epsilon_{ijk}u_{j,s}B_k) -\frac{\partial \mathcal{P}_{ij,s}}{\partial x_j} - R_{i,s\alpha}
\end{aligned}
\]</span> where <span class="math inline">\(\epsilon_{ijk}\)</span> is the Levi-Civita symbol. The moments are defined as <span class="math display">\[
\begin{aligned}
n_s(\mathbf{x}) &amp;\equiv \int f_s \mathrm{d}\mathbf{v} \\
u_{i,s}(\mathbf{x}) &amp;\equiv \frac{1}{n_s(\mathbf{x})}\int v_i f_s \mathrm{d}\mathbf{v} \\
\mathcal{P}_{ij,s}(\mathbf{x}) &amp;\equiv m_s \int v_i v_j f_s \mathrm{d}\mathbf{v}
\end{aligned}
\]</span> with <span class="math inline">\(f_s(\mathbf{x},\mathbf{v},t)\)</span> being the phase space distribution function. We will neglect the subscript <span class="math inline">\(s\)</span> hereinafter for convenience. For completeness, <span class="math inline">\(\mathcal{P}_{ij}\)</span> relates to the more familiar thermal pressure tensor <span class="math display">\[
P_{ij} \equiv m\int(v_i - u_i)(v_i - u_i)f\mathrm{d}\mathbf{v}
\]</span> by <span class="math display">\[
\mathcal{P}_{ij} = P_{ij} + nm u_i u_j
\]</span></p></li>
</ul>
<p>For simplicity, non-ideal effects like viscous dissipation are neglected. The electric and magnetic fields <span class="math inline">\(\mathbf{E}\)</span> and <span class="math inline">\(\mathbf{B}\)</span> are evolved using Maxwell equations <span class="math display">\[
\begin{aligned}
\frac{\partial\mathbf{B}}{\partial t} + \nabla\times\mathbf{E} = 0 \\
\frac{\partial\mathbf{E}}{\partial t} - c^2\nabla\times\mathbf{B} = -\frac{1}{\epsilon_0}\sum_s q_s n_s \mathbf{u}_s \\
\nabla\cdot\mathbf{B} = 0 \\
\nabla\cdot\mathbf{E} = \epsilon_0^{-1}\sum_s n_s q_s
\end{aligned}
\]</span> with <span class="math inline">\(c=1/\sqrt(\mu_0\epsilon_0)\)</span> being the speed of light.</p>
<p>To close the system, the second order moment <span class="math inline">\(\mathcal{P}_{ij}\)</span> or <span class="math inline">\(P_{ij}\)</span> must be specified. For example, a cold fluid closure simply sets <span class="math inline">\(P_{ij}=0\)</span>, while an isothermal equation of state (EOS) assumes that the temperature is constant. Or, assuming zero heat flux and that the pressure tensor is isotropic, we can write an adiabatic EOS for <span class="math inline">\(P_{ij} = p I_{ij}\)</span>, <span class="math display">\[
\frac{\partial\mathcal{\epsilon}}{\partial t} + \nabla\cdot\left[ (p+\mathcal{\epsilon})\mathbf{u} \right] = nq\mathbf{u}\cdot\mathbf{E}
\]</span> where <span class="math display">\[
\mathcal{\epsilon} \equiv \frac{p}{\gamma-1} + \frac{1}{2}mn\mathbf{u}^2
\]</span> is the total fluid (thermal + kinetic) energy and <span class="math inline">\(\gamma\)</span> is the adiabatic index, setting to <span class="math inline">\(5/3\)</span> for a fully ionized plasma. For a plasma with <span class="math inline">\(S\)</span> species (<span class="math inline">\(s=1,...,S\)</span>) this system is closed and has a total of <span class="math inline">\(5S+6\)</span> equations, and are here referred to as the <em>five-moment</em> model. More general models can be obtained by retaining the evolution equations for all six components of the pressure tensor in the so-called <em>ten-moment</em> model <span id="eq-ten-moment"><span class="math display">\[
\frac{\mathcal{P}_{ij,s}}{\partial t} + \frac{\partial \mathcal{Q}_{ijm,s}}{\partial x_m} = n_sq_su_{i,s}E_j + \frac{q_s}{m_s}\epsilon_{iml}\mathcal{P}_{mj,s}B_l
\tag{8.16}\]</span></span> where the third moment <span class="math display">\[
\mathcal{Q}_{ijm,s}(\mathbf{x}) \equiv m_s\int v_i v_j v_m f_s\mathrm{d}\mathbf{v}
\]</span> relates to the heat flux tensor defined in the fluid frame <span class="math display">\[
Q_{ijm} \equiv m\int (v_i-u_i)(v_j-u_j)(v_m-u_m)\mathrm{d}\mathbf{v}
\]</span> by <span class="math display">\[
\mathcal{Q}_{ijm} = Q_{ijm} + u_i\mathcal{P}_{jm} - 2nm u_i u_j u_m
\]</span></p>
<p>Again, the equations here must be closed by some approximation for the heat-flux tensor. Another option is to include evolution equations for even higher order moments, e.g., the ten independent components of the heat-flux tensor.</p>
<p>Theoretically, the multifluid-Maxwell equations approach the Hall magnetohydrodynamics (MHD) under asymptotic limits of vanishing electron mass (<span class="math inline">\(m_e \rightarrow 0\)</span>) and infinite speed of light (<span class="math inline">\(c\rightarrow\infty\)</span>). All waves and effects within the two-fluid picture are retained, for example, the light wave, electron and ion inertial effects like the ion cyclotron wave and whistler wave. Particularly, through properly devised heat-flux closures, the ten-moment model could partially capture nonlocal kinetic effects like Landau damping, in a manner similar to the gyrokinetic models.</p>
<p>Although multifluid-Maxwell models provide a more complete description of the plasma than reduced, asymptotic models like MHD, they are less frequently used. The reason for this is the fast kinetic scales involved. Retaining the electron inertia adds plasma-frequency and cyclotron time-scale, while non-neutrality adds Debye length spatial-scales. Further, inclusion of the displacement currents means that EM waves must be resolved when using an explicit scheme. Fortunately, the restrictions due to kinetic scales are introduced <em>only through the non-hyperbolic source terms</em> of the momentum equation, the Ampère’s law, and the pressure equation. Therefore we may eliminate these restrictions by <em>updating the source term separately either exactly</em> or <em>using an implicit algorithm</em> (Note: BATSRUS applies the point-implicit scheme.). This allows larger time steps and leads to significant speedup, especially with realistic electron/ion mass ratios. The speed of light constraint still exists, however, can be greatly relaxed, using reduced values for the speed of light and/or sub-cycling Maxwell equations. Of course, an implicit Maxwell solver, or a reduced set of electromagnetic equations like the Darwin approximation<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>, can also relax the time-step restrictions.</p>
</section>
<section id="characteristic-wave-speeds" class="level3" data-number="8.4.4">
<h3 data-number="8.4.4" class="anchored" data-anchor-id="characteristic-wave-speeds"><span class="header-section-number">8.4.4</span> Characteristic wave speeds</h3>
<p>The fastest wave speed in the 5/6/10-moment equations is the speed of light <span class="math inline">\(c\)</span>. Theoretically, the characteristic wave speeds shall be consistent and fallback to MHD in the isotropic 5-moment case.</p>
<p>Numerically, however, using <span class="math inline">\(c\)</span> in the numerical fluxes makes the scheme rather diffusive (?). The discretization time step is limited by the Courant-Friedrichs-Lewy (CFL) condition based on the speed of light. In practice, we can reduce the speed of light to a value that is a factor of 2-3 faster than the fastest flow and fast wave speed to speed up the simulation.</p>
</section>
</section>
<section id="generalized-ohms-law" class="level2" data-number="8.5">
<h2 data-number="8.5" class="anchored" data-anchor-id="generalized-ohms-law"><span class="header-section-number">8.5</span> Generalized Ohm’s Law</h2>
<p>The generalized Ohm’s law can be derived from two-fluid equations. Landau once pointed out that the validity of describing plasma behaviors with two-fluid equations is based on the fact that the time scale of ions and electrons to reach an equilibrium Maxwellian distribution is much smaller than that of the heat exchange between species. The Ohm’s law is established upon the collisions between electrons, ions and neutral species, and is used to describe the relation between <span class="math inline">\(\mathbf{J}\)</span> and <span class="math inline">\(\mathbf{E},\,\mathbf{B},\,\mathbf{u}\)</span>.</p>
<section id="basic-definitions-and-assumptions" class="level3" data-number="8.5.1">
<h3 data-number="8.5.1" class="anchored" data-anchor-id="basic-definitions-and-assumptions"><span class="header-section-number">8.5.1</span> Basic definitions and assumptions</h3>
<p>Assume plasma consists of electrons and ionized <span class="math inline">\(\textrm{H}^+\)</span>. We use <span class="math inline">\(e,\, i,\, a\)</span> as subscripts for electron, ion and neutral species respectively. <span class="math display">\[
\begin{aligned}
q_e=-q_i=-e \\
m_e\ll m_i \approx m_a
\end{aligned}
\]</span></p>
<p>With the definition of ionization degree in <a href="introduction.html#eq-saha" class="quarto-xref">Equation&nbsp;<span>2.1</span></a>, <span id="eq-ionization_degree"><span class="math display">\[
\alpha=\frac{n_i}{n_i+n_a}
\tag{8.17}\]</span></span> we have <span class="math display">\[
\begin{aligned}
\frac{n_i}{n_a}&amp;=\frac{\alpha}{1-\alpha}\\
\frac{n_i}{2n_i+n_a}&amp;=\frac{\alpha}{1+\alpha}\\
\frac{n_a}{2n_i+n_a}&amp;=\frac{1-\alpha}{1+\alpha}
\end{aligned}
\]</span></p>
<p>The quasi-neutrality assumption gives <span class="math display">\[
\begin{aligned}
\rho_e^\ast+\rho_i^\ast =0\ \Rightarrow\ n_e=n_i \\
\rho_e=m_e n_e \ll \rho_i=m_i n_i
\end{aligned}
\]</span></p>
<p>Assume a system of ideal gas in thermal equilibrium, <span class="math display">\[
\begin{aligned}
T_e=T_i=T_a \\
p=p_e+p_i+p_a
\end{aligned}
\]</span></p>
<p>Using the ionization degree defined in <a href="#eq-ionization_degree" class="quarto-xref">Equation&nbsp;<span>8.17</span></a>, we have <span class="math display">\[
\begin{aligned}
p_e = p_i = \frac{n_i}{2n_i+n_a} p = \frac{\alpha}{1+\alpha} p \\
p_a = \frac{n_a}{2n_i+n_a}p = \frac{1-\alpha}{1+\alpha}p
\end{aligned}
\]</span> Also, we have <span class="math display">\[
v_{e,th}\gg v_{i,th}
\]</span></p>
<p>Assume that the flow velocity is much smaller than the thermal speed, <span class="math display">\[
|\mathbf{v}_s|\ll |\mathbf{v}_{s,th}|,\quad s=e,\, i,\, a.
\]</span></p>
<p>Typical time scale must satisfy <span class="math inline">\(\tau_0\gg \tau_{\text{collision}}\)</span>.</p>
<p>Finally, we ignore viscosity and non-EM force in the derivation.</p>
<p>The average velocity of protons with respect to bulk velocity of the plasma, the velocity difference between electron and ion, and the average velocity of neutral particles are <span class="math display">\[
\begin{aligned}
\mathbf{v}_i&amp;=\mathbf{u}_i-\mathbf{u} \\
\mathbf{v}_{ei}&amp;=\mathbf{u}_e-\mathbf{u}_i \\
\mathbf{u}_a&amp;=\mathbf{u}-\frac{n_i}{n_a}\left(\mathbf{v}_i+\frac{m_e}{m_i}\mathbf{v}_{ei}\right)
\end{aligned}
\]</span></p>
<p>The average momenta of electrons relative to protons and neutral particles are <span class="math display">\[
\begin{aligned}
\mathbf{I}_{ei}&amp;=m_e\mathbf{v}_{ei} \\
\mathbf{I}_{ea}&amp;=m_e\left[\left( 1+\frac{n_im_e}{n_a m_i}\right)\mathbf{v}_{ei}+\left( 1+\frac{n_i}{n_a}\right)\mathbf{v}_i\right]\approx m_e\left[ \mathbf{v}_{ei}+\left(\frac{1}{1-\alpha}\right)\mathbf{v}_i \right] \\
\mathbf{I}_{ia}&amp;=m_i(\mathbf{u}_i-\mathbf{u}_a)=m_i (\mathbf{v}_i+\mathbf{u}-\mathbf{u}_a)=\frac{1}{1-\alpha}m_i\mathbf{v}_i+\frac{\alpha}{1-\alpha}m_e\mathbf{v}_{ei}
\end{aligned}
\]</span></p>
<p>Note that from Newton’s third law, <span class="math inline">\(\Delta \mathbf{I}_{sk}=-\Delta \mathbf{I}_{ks}\)</span>.</p>
</section>
<section id="equation-of-motion-for-each-species" class="level3" data-number="8.5.2">
<h3 data-number="8.5.2" class="anchored" data-anchor-id="equation-of-motion-for-each-species"><span class="header-section-number">8.5.2</span> Equation of motion for each species</h3>
<section id="for-electrons" class="level4" data-number="8.5.2.1">
<h4 data-number="8.5.2.1" class="anchored" data-anchor-id="for-electrons"><span class="header-section-number">8.5.2.1</span> For electrons</h4>
<p><span id="eq-electron_motion_ohm"><span class="math display">\[
\begin{aligned}
m_en_e\frac{d\mathbf{u}_e}{dt}&amp;=m_en_i\frac{d}{dt}\left(\mathbf{v}_{ei}+\mathbf{v}_i+\mathbf{u}\right) \\
&amp;=-\nabla p_e - n_i e \left[ \mathbf{E}+(\mathbf{v}_{ei}+\mathbf{v}_i+\mathbf{u})\times\mathbf{B} \right]+\mathbf{f}_e^c
\end{aligned}
\tag{8.18}\]</span></span> where the collisional force <span id="eq-electron_motion_ohm_f"><span class="math display">\[
\mathbf{f}_e^c=-n_i m_e\mathbf{v}_{ei}\left(\tau_{ei}^{-1}+\tau_{ea}^{-1}\right)-\frac{1}{1-\alpha}n_i m_e\mathbf{v}_i\tau_{ea}^{-1}
\tag{8.19}\]</span></span></p>
<p><em>Proof</em>:</p>
<p><span class="math inline">\(\mathbf{f}_{sk}^c\cdot\tau_{sk}=n_s\Delta \mathbf{I}_{sk}\)</span>, where <span class="math inline">\(\tau_{sk}\)</span> is the average collision interval. <span class="math display">\[
\Delta \mathbf{I}_{sk}=-\Delta \mathbf{I}_{ks}
\]</span></p>
<p>Assuming elastic collision, we have <span class="math display">\[
\begin{aligned}
\Delta\mathbf{I}_{sk}&amp;=-\frac{m_sm_k}{m_s+m_k}\mathbf{v}_{sk} \\
\Rightarrow \Delta\mathbf{I}_{ek}&amp;=-\frac{m_k}{m_e+m_k}m_e\mathbf{v}_{ek}\approx -\mathbf{I}_{ek}\text{(ignore electron mass)}\\
\Delta\mathbf{I}_{ia}&amp;=-\frac{m_a}{m_a+m_i}m_i\mathbf{v}_{ia}\approx -\frac{1}{2}\mathbf{I}_{ia}\text{(ion mass=neutron mass)}
\end{aligned}
\]</span></p>
<p>Therefore the collision force of electron is <span class="math display">\[
\mathbf{f}_e^c=-n_i\mathbf{I}_{ei}\tau_{ei}^{-1}-n_i\mathbf{I}_{ea}\tau_{ea}^{-1}=-n_i m_e\mathbf{v}_{ei}\left(\tau_{ei}^{-1}+\tau_{ea}^{-1}\right)-\frac{1}{1-\alpha}n_i m_e\mathbf{v}_i\tau_{ea}^{-1}
\]</span> The collision force between ion and neutral is <span class="math display">\[
\mathbf{f}_{ia}^c=-\frac{1}{2}n_i\mathbf{I}_{ia}\tau_{ia}^{-1}
\]</span> □</p>
</section>
<section id="for-protons" class="level4" data-number="8.5.2.2">
<h4 data-number="8.5.2.2" class="anchored" data-anchor-id="for-protons"><span class="header-section-number">8.5.2.2</span> For protons</h4>
<p><span id="eq-proton_motion_ohm"><span class="math display">\[
m_i n_i\frac{d\mathbf{u}_i}{dt}=m_i n_i\frac{d}{dt}(\mathbf{v}_i+\mathbf{u})=-\nabla p_i+n_i e\left[ \mathbf{E}+\left(\mathbf{v}_i+\mathbf{u}\times\mathbf{B}\right) \right]+\mathbf{f}_i^c
\tag{8.20}\]</span></span> where the collision force is <span id="eq-proton_motion_ohm_f"><span class="math display">\[
\mathbf{f}_{i}^c=\mathbf{f}_{ia}^c+\mathbf{f}_{ie}^c=n_im_e\mathbf{v}_{ei}\tau_{ei}^{-1}-\frac{\alpha}{2(1-\alpha)}n_im_e\mathbf{v}_{ei}\tau_{ia}^{-1}-\frac{1}{2(1-\alpha)}n_i m_i\mathbf{v}_i\tau_{ia}^{-1}
\tag{8.21}\]</span></span></p>
</section>
<section id="for-the-whole-plasma" class="level4" data-number="8.5.2.3">
<h4 data-number="8.5.2.3" class="anchored" data-anchor-id="for-the-whole-plasma"><span class="header-section-number">8.5.2.3</span> For the whole plasma</h4>
<p>If we do not consider the effect of other forces on plasma and ignore electron mass (<span class="math inline">\(m_en_e\ll m_in_i\)</span>), <span id="eq-plasma_motion_ohm"><span class="math display">\[
m_i(n_i+n_a)\frac{d\mathbf{u}}{dt}=-\nabla p+\mathbf{J}\times\mathbf{B}=-\nabla p-n_i e\mathbf{v}_{ei}\times\mathbf{B}
\tag{8.22}\]</span></span> where the total current density is <span class="math display">\[
\mathbf{J}=\sum_s{n_s q_s\mathbf{u}_s}=-n_i e(\mathbf{v}_{ei}+\mathbf{v}_i+\mathbf{u})+n_i e(\mathbf{v}_i+\mathbf{u})=-n_i e\mathbf{v}_{ei}
\]</span> Physically we usually think of current in plasma as the velocity difference between electrons and ions.</p>
</section>
</section>
<section id="preconditions" class="level3" data-number="8.5.3">
<h3 data-number="8.5.3" class="anchored" data-anchor-id="preconditions"><span class="header-section-number">8.5.3</span> Preconditions</h3>
<p>If an external B-field is present and the conductor is not at rest but moving at velocity <span class="math inline">\(\mathbf{u}\)</span>, then an extra term must be added to account for the current induced by the Lorentz force on the charge carriers: <span class="math display">\[
\mathbf{J}=\sigma(\mathbf{E}+\mathbf{u}\times\mathbf{B})
\]</span> where <span class="math inline">\(\sigma\)</span> is the electric conductivity.</p>
<p>In the rest frame of the moving conductor this term drops out because <span class="math inline">\(\mathbf{u}=0\)</span>. There is no contradiction because the electric field in the rest frame differs from the E-field in the lab frame: <span class="math inline">\(\mathbf{E}^\prime = \mathbf{E} + \mathbf{u}\times\mathbf{B}\)</span>. Electric and magnetic fields are relative and related by the Lorentz transformation.</p>
<p>If the current <span class="math inline">\(\mathbf{J}\)</span> is alternating because the applied voltage or E-field varies in time, then reactance must be added to resistance to account for self-inductance (see electrical impedance). The reactance may be strong if the frequency is high or the conductor is coiled. (hyzhou: This is related to the Ponderamotive force. I have some questions here because the time derivative of velocities are all neglected here, which in turn makes the derivation only applicable to a steady system. The obvious problem then is that the generalized Ohm’s law may not hold in a time-dependent system!)</p>
</section>
<section id="derivation" class="level3" data-number="8.5.4">
<h3 data-number="8.5.4" class="anchored" data-anchor-id="derivation"><span class="header-section-number">8.5.4</span> Derivation</h3>
<p>Negligible terms:</p>
<ul>
<li><p><span class="math inline">\(\frac{d\mathbf{v}_e}{dt}\)</span> in <a href="#eq-electron_motion_ohm" class="quarto-xref">Equation&nbsp;<span>8.18</span></a> and <span class="math inline">\(\frac{d\mathbf{v}_i}{dt}\)</span> in <a href="#eq-proton_motion_ohm" class="quarto-xref">Equation&nbsp;<span>8.20</span></a>, because <span class="math inline">\(|\mathbf{v}|\ll |\mathbf{v}_\mathrm{th}|\)</span></p></li>
<li><p><span class="math inline">\(\frac{d\mathbf{u}}{dt}\)</span> in <a href="#eq-electron_motion_ohm" class="quarto-xref">Equation&nbsp;<span>8.18</span></a>. From <a href="#eq-plasma_motion_ohm" class="quarto-xref">Equation&nbsp;<span>8.22</span></a> and <span class="math inline">\(m_e \ll m_i\)</span>, <span class="math display">\[
m_en_i\frac{d\mathbf{u}}{dt}=\frac{m_e}{m_i}\frac{n_i}{n_i+n_a}\left(-\nabla p-n_i e\mathbf{v}_{ei}\times\mathbf{B}\right)\ll 1
\]</span></p></li>
</ul>
<p>From <a href="#eq-electron_motion_ohm" class="quarto-xref">Equation&nbsp;<span>8.18</span></a>, <span class="math display">\[
m_e n_i\frac{d\mathbf{u}}{dt}=-\nabla p_e -n_i e\mathbf{v}_{ei}\times\mathbf{B}-n_ie [\mathbf{E}+(\mathbf{v}_i+\mathbf{u})\times\mathbf{B}]+\mathbf{f}_e^c
\]</span></p>
<p>The above two equations give <span id="eq-Ohm_derivation1"><span class="math display">\[
\begin{aligned}
0=&amp;-\nabla p_e -n_i e\mathbf{v}_{ei}\times\mathbf{B}-n_ie [\mathbf{E}+(\mathbf{v}_i+\mathbf{u})\times\mathbf{B}] \\
&amp; -n_i m_e\mathbf{v}_{ei}\left(\tau_{ei}^{-1}+\tau_{ea}^{-1}\right)-\frac{1}{1-\alpha}n_i m_e\mathbf{v}_i\tau_{ea}^{-1}
\end{aligned}
\tag{8.23}\]</span></span></p>
<p><a href="#eq-proton_motion_ohm" class="quarto-xref">Equation&nbsp;<span>8.20</span></a>, <a href="#eq-plasma_motion_ohm" class="quarto-xref">Equation&nbsp;<span>8.22</span></a> and <a href="#eq-Ohm_derivation1" class="quarto-xref">Equation&nbsp;<span>8.23</span></a> are the three main equations we need to derive the generalized Ohm’s law.</p>
<p>If we define the ratios of gyro-period and collision time as <span class="math display">\[
\begin{aligned}
\kappa_{ei} &amp;\equiv \frac{1}{\Omega_e \tau_{ei}}=\frac{m_e}{eB}\tau_{ei}^{-1} \\
\kappa_{ea} &amp;\equiv \frac{1}{\Omega_e \tau_{ea}}=\frac{m_e}{eB}\tau_{ea}^{-1} \\
\kappa_{ia}&amp;\equiv \frac{1}{2\Omega_i \tau_{ia}}=\frac{m_i}{2eB}\tau_{ia}^{-1}
\end{aligned}
\]</span> and ion current density as <span class="math display">\[
\mathbf{J}_i=n_i e\mathbf{v}_i
\]</span> we can write the three main equations above as <span id="eq-Ohm_derivation2"><span class="math display">\[
0=-\nabla p_e -n_i e(\mathbf{E}+\mathbf{u}\times\mathbf{B}) + \mathbf{J}\times\mathbf{B}-\mathbf{J}_i\times\mathbf{B}+(\kappa_{ei}+\kappa_{ea})B\mathbf{J}-\frac{1}{1-\alpha}\kappa_{ea}B\mathbf{J}_i
\tag{8.24}\]</span></span></p>
<p><span id="eq-Ohm_derivation3"><span class="math display">\[
\begin{aligned}
m_in_i\frac{d\mathbf{u}}{dt}=&amp;-\nabla p_i+n_i e(\mathbf{E}+\mathbf{u}\times\mathbf{B})+\mathbf{J}_i\times\mathbf{B} \\ &amp;-(\kappa_{ei}-\frac{\alpha}{1-\alpha}\frac{m_e}{m_i}\kappa_{ia})B\mathbf{J}-\frac{1}{1-\alpha}\kappa_{ia}B\mathbf{J}_i
\end{aligned}
\tag{8.25}\]</span></span></p>
<p><span id="eq-Ohm_derivation4"><span class="math display">\[
\frac{1}{\alpha}m_i n_i\frac{d\mathbf{u}}{dt}=-\nabla p+\mathbf{J}\times\mathbf{B}
\tag{8.26}\]</span></span></p>
<p>Subtracting <a href="#eq-Ohm_derivation3" class="quarto-xref">Equation&nbsp;<span>8.25</span></a> from <a href="#eq-Ohm_derivation4" class="quarto-xref">Equation&nbsp;<span>8.26</span></a> and <a href="#eq-Ohm_derivation2" class="quarto-xref">Equation&nbsp;<span>8.24</span></a>, we get the ion current density as <span class="math display">\[
\begin{aligned}
\mathbf{J}_i&amp;=\frac{1-\alpha}{(\kappa_{ea}+\kappa_{ia})B}\left[ \alpha\nabla p -\nabla(p_e+p_i)+(1-\alpha)\mathbf{J}\times\mathbf{B}+(\kappa_{ea}+\frac{\alpha}{1-\alpha}\frac{m_e}{m_i}\kappa_{ia})B\mathbf{J}\right] \\
&amp;=\frac{1-\alpha}{(\kappa_{ea}+\kappa_{ia})B}\left[ \frac{\alpha(\alpha-1)}{\alpha+1}\nabla p+(1-\alpha)\mathbf{J}\times\mathbf{B}+(\kappa_{ea}+\frac{\alpha}{1-\alpha}\frac{m_e}{m_i}\kappa_{ia})B\mathbf{J}\right]
\end{aligned}
\]</span></p>
<p>Then we can eliminate <span class="math inline">\(\frac{d\mathbf{u}}{dt}\)</span> and <span class="math inline">\(\mathbf{J}_i\)</span> from the three main equations and get the generalized Ohm’s law <span class="math display">\[
\begin{aligned}
\nabla p_e +\frac{\alpha(\alpha-1)}{\alpha+1}r_e \nabla p=&amp;-n_i e(\mathbf{E}+\mathbf{u}\times\mathbf{B})
+\left[1-2r_e(1-\alpha)-\alpha\frac{m_e}{m_i}r_i\right]\mathbf{J}\times\mathbf{B} \\
&amp;+\left[\kappa_{ei}-(1-r_e)\kappa-\frac{\alpha}{1-\alpha}\frac{m_e}{m_i}r_e\kappa_{ia}\right]B\mathbf{J} \\
&amp;+\frac{(1-\alpha)^2}{(\kappa_{ea}+\kappa_{ia})B}\left[ \frac{\alpha}{\alpha+1}\nabla p\times\mathbf{B}-\mathbf{J}\times\mathbf{B}\times\mathbf{B} \right]
\end{aligned}
\]</span> where <span class="math display">\[
r_e=\frac{\kappa_{ea}}{\kappa_{ea}+\kappa_{ia}},\quad r_i=\frac{\kappa_{ia}}{\kappa_{ea}+\kappa_{ia}}
\]</span></p>
</section>
<section id="simplification-of-generalized-ohms-law" class="level3" data-number="8.5.5">
<h3 data-number="8.5.5" class="anchored" data-anchor-id="simplification-of-generalized-ohms-law"><span class="header-section-number">8.5.5</span> Simplification of Generalized Ohm’s Law</h3>
<ol type="1">
<li>If the mean free path of protons is much smaller than that of electrons, i.e.&nbsp;the cross section of proton is much smaller than that of electron, <span class="math display">\[
\begin{aligned}
&amp;\frac{\tau_{ia}}{\tau_{ea}}=\frac{l_{ia}\cdot v_{e,th}}{l_{ea}\cdot v_{i,th}}\propto \Big(\frac{m_i}{m_e}\Big)^{1/2}\cdot\frac{l_{ia}}{l_ea}\ll  \Big(\frac{m_i}{m_e}\Big)^{1/2} \\
\Rightarrow &amp;\frac{\kappa_{ea}}{\kappa_{ia}}=2\frac{\Omega_i \tau_{ia}}{\Omega_e\tau_{ea}}\propto 2\frac{m_e}{m_i}\cdot\frac{\tau_{ia}}{\tau_{ea}}\propto2\Big( \frac{m_e}{m_i}\Big)^{1/2}\cdot\frac{l_{ia}}{l_{ea}}\ll 1 \\
\Rightarrow &amp;r_e=\frac{\kappa_{ea}}{\kappa_{ea}+\kappa_{ia}}\ll1\quad
r_i=\frac{\kappa_{ia}}{\kappa_{ea}+\kappa_{ia}}\approx 1
\end{aligned}
\]</span></li>
</ol>
<p>Therefore we have <span class="math display">\[
\begin{aligned}
\nabla p_e=&amp;-n_i e(\mathbf{E}+\mathbf{u}\times\mathbf{B})+\mathbf{J}\times\mathbf{B}+(\kappa_{ei}+\kappa_{ea})B\mathbf{J}+
\frac{(1-\alpha)^2}{\kappa_{ia}B}\left[ \frac{\alpha}{\alpha+1}\nabla p\times\mathbf{B}-\mathbf{J}\times\mathbf{B}\times\mathbf{B} \right] \\
\mathbf{J}=&amp;\frac{n_i e}{(\kappa_{ei}+\kappa_{ea})B}\left(\mathbf{E}+\mathbf{u}\times\mathbf{B}\right)+
\frac{1}{(\kappa_{ei}+\kappa_{ea})B}\left( \nabla p_e-\mathbf{J}\times\mathbf{B}\right) \\
&amp;-\frac{(1-\alpha)^2}{\kappa_{ia}(\kappa_{ei}+\kappa_{ea})B}\left[ \frac{\alpha}{\alpha+1}\nabla p\times\mathbf{B}-\mathbf{J}\times\mathbf{B}\times\mathbf{B} \right]
\end{aligned}
\]</span></p>
<ol start="2" type="1">
<li><p>If EM field is dominant, i.e.&nbsp;EM force <span class="math inline">\(\gg\)</span> thermal pressure gradient, <span class="math inline">\(|\mathbf{J}\times\mathbf{B}|\gg |\nabla p|\sim |\nabla p_e|\)</span>, then <span class="math display">\[
\mathbf{J}=\sigma(\mathbf{E}+\mathbf{u}\times\mathbf{B})-\frac{\sigma}{n_i e}\mathbf{J}\times\mathbf{B}+
\frac{\sigma}{n_i e}\frac{2(1-\alpha)^2 \Omega_i\tau_{ia}}{B}\mathbf{J}\times\mathbf{B}\times\mathbf{B}
\]</span> where <span class="math inline">\(\sigma\)</span> is the electrical conductivity, <span class="math display">\[
\sigma=\frac{n_i e^2}{m_e(\tau_{ei}^{-1}+\tau_{ea}^{-1})}
\]</span></p></li>
<li><p>For a fully ionized plasma, <span class="math inline">\(\alpha=1\ \Rightarrow\ \kappa_{ea}=\kappa_{ia}=0\)</span>, we have <span class="math display">\[
\mathbf{J}=\sigma(\mathbf{E}+\mathbf{u}\times\mathbf{B})+\frac{\sigma}{n_i e}\left(\nabla p_e -\mathbf{J}\times\mathbf{B}\right)
\]</span> where <span class="math display">\[
\sigma=\frac{n_i e^2\tau_{ei}}{m_e}
\]</span></p></li>
</ol>
<p>Note that the electron pressure gradient term here shows an amazing effect: it can generate EM field out of nothing! This is one theory in astrophysics which describes the origin of EM field.</p>
<ol start="4" type="1">
<li><p>For a fully ionized plasma, if EM field is dominant, we have <span class="math display">\[
\begin{aligned}
\mathbf{J}=\sigma(\mathbf{E}+\mathbf{u}\times\mathbf{B}) -\frac{\sigma}{n_i e}\mathbf{J}\times\mathbf{B}=
\sigma(\mathbf{E}+\mathbf{u}\times\mathbf{B}) -\Omega_e \tau_{ei}\mathbf{J}\times\mathbf{b}
\end{aligned}
\]</span></p></li>
<li><p>If there is weak magnetic field and dense plasma, i.e.&nbsp;<span class="math inline">\(n_i \gg 1,\ |\mathbf{B}|\ll 1\)</span>, <span class="math display">\[
\mathbf{J}=\sigma(\mathbf{E}+\mathbf{u}\times\mathbf{B})
\]</span></p></li>
</ol>
</section>
<section id="discussions" class="level3" data-number="8.5.6">
<h3 data-number="8.5.6" class="anchored" data-anchor-id="discussions"><span class="header-section-number">8.5.6</span> Discussions</h3>
<p>In <a href="#sec-mhd-ohm" class="quarto-xref"><span>Section 8.6.1</span></a>, we will see that a relatively simple form can be obtained by assuming that the electron inertia is much smaller than the Lorentz force, which is a good approximation when considering only the perpendicular velocity to the magnetic field.</p>
<p><span id="eq-genearlized_ohm_law"><span class="math display">\[
\mathbf{E} = -\mathbf{u}\times\mathbf{B} + \eta\mathbf{J} + \frac{1}{en}\mathbf{J}\times\mathbf{B}-\frac{1}{en}\nabla\cdot\overleftrightarrow{P}_e +\frac{m_e}{ne^2}\Big[ \frac{\partial \mathbf{J}}{\partial t}+\nabla\cdot(\mathbf{J}\mathbf{u}+\mathbf{u}\mathbf{J}) \Big]
\tag{8.27}\]</span></span></p>
<p>where the first term on the right-hand side is the <em>convection term</em>, the second term is the <em>resistivity term</em> (<em>conductive term</em>), the third term is called the <em>Hall term</em>, the fourth term is the <em>electron pressure term</em>, and the fifth term is called the <em>electron inertia term</em>, since it is proportional to the mass of electrons.</p>
<p>Note that both <span class="math inline">\(\mathbf{u}\)</span> and <span class="math inline">\(\mathbf{J}\)</span> are the first-order moments, with <span class="math inline">\(\mathbf{u}\)</span> being the (weighted) sum of the first-order moment of electrons and ions while <span class="math inline">\(\mathbf{J}\)</span> being the difference between them. The generalized Ohm’s law is actually the difference between the electrons’ and ions’ first-order moment equations. <em>The generalized Ohm’s law is an equation that governs the time evolution of <span class="math inline">\(\mathbf{J}\)</span></em>. Also note that Ampère’s law, with the displacement current retained, is an equation governing the time evolution of <span class="math inline">\(\mathbf{E}\)</span>. However, in the approximation of the resistive MHD, the time derivative terms <span class="math inline">\(\partial \mathbf{E}/\partial t\)</span> and <span class="math inline">\(\partial \mathbf{J} /\partial t\)</span> are ignored in Ampère’s law and Ohm’s law, respectively. In this approximation, Ohm’s law is directly solved to determine <span class="math inline">\(\mathbf{E}\)</span> and Ampère’s law is directly solved to determine <span class="math inline">\(\mathbf{J}\)</span>. [Introduction to plasma physics: with space and laboratory applications, D. A. Gurnett and A. Bhattacharjee.]</p>
<p><span class="math display">\[
\underbrace{\mathbf{E}}_{a} + \underbrace{\mathbf{u}\times\mathbf{B}}_{b} - \underbrace{\frac{1}{\sigma}\mathbf{J}}_{c} - \underbrace{\frac{\mathbf{J}\times\mathbf{B}}{en_e}}_{d} + \underbrace{\frac{1}{n_e e}\nabla(n_e k_B T_e)}_{e} = 0
\]</span></p>
<p>Denote each term above with a to e. From the single-fluid MHD momentum equation, let <span class="math inline">\(\omega\)</span> be the oscillation frequency of the perturbed velocity, and variable in scalar form be the characteristic magnitude of that quantity, <span id="eq-mhd_scale"><span class="math display">\[
\begin{aligned}
\rho\big( \frac{\partial \mathbf{u}}{\partial t}+\mathbf{u}\cdot\nabla\mathbf{u}\big) = \mathbf{J}\times\mathbf{B} - \nabla p +\rho\mathbf{g} \\
\Rightarrow \omega\rho U\sim J B
\end{aligned}
\tag{8.28}\]</span></span></p>
<p>Using and the assumptions of MHD, the relations between each term in generalized Ohm’s law are <span class="math display">\[
\begin{aligned}
\frac{b}{d} &amp;= \frac{UB}{JB/en_e} = \frac{en_eUB}{\omega \rho U} = \frac{en_e B}{\omega n_e m_i} = \frac{\Omega_i}{\omega} \gg 1 \\
\frac{c}{d} &amp;= \frac{J/\sigma}{JB/en_e} = \frac{en_e}{B\sigma} = \frac{en_e}{Be^2 n_e/\nu_{ei} m_e} = \frac{\nu_{ei}}{\Omega_e} \ll 1 \\
\frac{b}{d} &amp;= \frac{U}{J/en_e} \ll 1,\ \text{if } \mathbf{J} \text{ is carried by } \mathbf{u}_e
\end{aligned}
\]</span> which generates direct contradiction with the MHD assumption that <span class="math inline">\(\mathbf{u}\ll \mathbf{u}_e\)</span> if currents are mostly carried by electrons. (WHAT ABOUT THE PRESSURE TERM SCALING? The gradient implies that it is related to the system size; the pressure implies that it is also related to thermal motion?)</p>
<p>There is an interesting point about the electron pressure term. If we assume an isotropic plasma with <span class="math inline">\(n_i=n_e\)</span> and an adiabatic process <span class="math inline">\(P/n^\gamma=C\)</span> where <span class="math inline">\(C\)</span> is a constant and <span class="math inline">\(\gamma\)</span> is the adiabatic index, we have <span id="eq-E_grad_pe"><span class="math display">\[
\begin{aligned}
\mathbf{E}_{\nabla P_e} &amp;= \frac{\nabla P_e}{n} = \frac{\nabla P_i}{n} = \frac{\nabla(Cn^\gamma)}{n} \\
&amp;= C\gamma n^{\gamma-2}\nabla n = C\frac{\gamma}{\gamma-1}\nabla n^{\gamma-1}
\end{aligned}
\tag{8.29}\]</span></span></p>
<p><a href="#eq-E_grad_pe" class="quarto-xref">Equation&nbsp;<span>8.29</span></a> indicates that the associated electric field is a potential field that only relates to density.</p>
</section>
<section id="ohms-law-in-a-multi-ion-system" class="level3" data-number="8.5.7">
<h3 data-number="8.5.7" class="anchored" data-anchor-id="ohms-law-in-a-multi-ion-system"><span class="header-section-number">8.5.7</span> Ohm’s Law in a Multi-Ion System</h3>
<p><span id="eq-genearlized_ohm_law_multiion"><span class="math display">\[
\begin{aligned}
\mathbf{E} &amp;= -\sum_i\mathbf{u}_i\times\mathbf{B} + \eta\mathbf{J} + \frac{1}{en_e}\mathbf{J}\times\mathbf{B}-\frac{1}{en_e}\nabla\cdot\overleftrightarrow{P}_e \\
&amp;+\frac{m_e}{n_e e^2}\Big[ \frac{\partial \mathbf{J}}{\partial t}+\nabla\cdot(\mathbf{J}\mathbf{u}+\mathbf{u}\mathbf{J}) \Big]
\end{aligned}
\tag{8.30}\]</span></span></p>
<p>where the quasi-neutrality holds <span class="math display">\[
en_e = \sum_i q_i n_i
\]</span></p>
</section>
</section>
<section id="sec-mhd" class="level2" data-number="8.6">
<h2 data-number="8.6" class="anchored" data-anchor-id="sec-mhd"><span class="header-section-number">8.6</span> Magnetohydrodynamics</h2>
<p>Particle motion in the two-fluid system was described by the individual species’ mean velocities <span class="math inline">\(\mathbf{u}_e, \mathbf{u}_i\)</span> and by the pressures <span class="math inline">\(\overleftrightarrow{P}_e, \overleftrightarrow{P}_i\)</span>, which provide an accounting for the mean square of the random deviation of the velocity from its average value. Magnetohydrodynamics is an alternate description of the plasma where, instead of using <span class="math inline">\(\mathbf{u}_e,\mathbf{u}_i\)</span> to describe mean motion, two new velocity variables that are a linear combination of <span class="math inline">\(\mathbf{u}_e,\mathbf{u}_i\)</span> are used. As will be seen below, this means a slightly different definition for pressure must also be used.</p>
<p>The new velocity-like variables are</p>
<ol type="1">
<li><p>the current density <span class="math display">\[
\mathbf{J} = \sum_s n_s q_s\mathbf{u}_s
\]</span> which is essentially the relative velocity between ions and electrons, and</p></li>
<li><p>the center-of-mass velocity <span class="math display">\[
\mathbf{u} = \frac{1}{\rho}\sum_s m_s n_s \mathbf{u}_s
\]</span> where <span class="math display">\[
\rho = \sum_s m_s n_s
\]</span> is the total mass density.</p></li>
</ol>
<p>Magnetohydrodynamics is primarily concerned with <em>low-frequency</em>, <em>long-wavelength</em>, <em>magnetic</em> behavior of the plasma. There are three basic assumptions in MHD: <span class="math display">\[
\begin{aligned}
\epsilon\omega/4\pi\sigma&amp; \ll 1, \\
(v/c)^2&amp;\ll 1,\\
\lambda/ L&amp; \ll 1,
\end{aligned}
\]</span> where <span class="math inline">\(\omega\)</span> is the plasma frequency, <span class="math inline">\(v\)</span> is the plasma bulk speed, <span class="math inline">\(\lambda\)</span> is the average free distance, and <span class="math inline">\(L\)</span> is the system characteristic length.</p>
<p>Standard orderings of ideal MHD can also be written as <span class="math display">\[
\epsilon \sim \omega/\Omega_c \sim k\rho
\]</span> where the plasma varies on frequency scales <span class="math inline">\(\omega\)</span> small compared to the gyrofrequency <span class="math inline">\(\Omega_c\)</span>, and varies on spatial scales <span class="math inline">\(1/k\)</span> long compared to the gyroradius <span class="math inline">\(\rho\)</span>. (Here, <span class="math inline">\(\epsilon\)</span> means a “small” value.) Thus it covers phenomenon related to compressional and shear Alfvén waves and instabilities, ion acoustic waves, and ion and electron kinetic effects such as Landau damping. However, it does not include drift-waves or other micro-instabilities because they result from finite Larmor radius (FLR) effects which vanish in the usual MHD ordering.</p>
<p>Single fluid MHD is somehow inconsistent since there is only one velocity. The definition of current using velocity cannot be applied, and the current can only be given by Ampère’s law (without the displacement current), <span class="math inline">\(\mathbf{J}=\nabla\times\mathbf{B}/\mu_0\)</span>.</p>
<p>Multiplying <a href="#eq-continuity-species" class="quarto-xref">Equation&nbsp;<span>8.5</span></a> by <span class="math inline">\(m_s\)</span> and summing over species gives the MHD continuity equation <span id="eq-continuity-mhd"><span class="math display">\[
\frac{\partial\rho}{\partial t} + \nabla\cdot(\rho\mathbf{u}) = 0
\tag{8.31}\]</span></span></p>
<p>To obtain an MHD equation of motion we take the first moment of the Vlasov equation and multiply the single species momentum equation by <span class="math inline">\(m_s\)</span> and sum over species, <span id="eq-1st-moment-vlasov-MHD"><span class="math display">\[
\frac{\partial}{\partial t}\sum_s m_s \int\mathbf{v}f_s\mathrm{d}\mathbf{v} + \frac{\partial}{\partial\mathbf{x}}\cdot\sum_s\int m_s \mathbf{v}\mathbf{v}f_s\mathrm{d}\mathbf{v} + \sum_s q_s \int\mathbf{v}\frac{\partial}{\partial\mathbf{v}}\cdot [(\mathbf{E}+\mathbf{v}\times\mathbf{B})f_s] = 0
\tag{8.32}\]</span></span></p>
<p>The right-hand side is zero since <span class="math inline">\(\mathbf{R}_{ei} + \mathbf{R}_{ie}=0\)</span>, i.e., the total plasma cannot exert drag on itself. We now define random velocities relative to <span class="math inline">\(\mathbf{u}\)</span> (rather than to <span class="math inline">\(\mathbf{u}_s\)</span> as was the case for the two-fluid equations) so that the second term can be written as <span id="eq-momentum-flux-vlasov-MHD"><span class="math display">\[
\sum_s\int m_s \mathbf{v}\mathbf{v}f_s\mathrm{d}\mathbf{v} = \sum_s\int m_s (\mathbf{v}^\prime + \mathbf{u})(\mathbf{v}^\prime + \mathbf{u})f_s\mathrm{d}\mathbf{v} = \sum_s\int m_s \mathbf{v}^\prime\mathbf{v}^\prime f_s\mathrm{d}\mathbf{v} + \rho\mathbf{u}\mathbf{u}
\tag{8.33}\]</span></span> where <span class="math inline">\(\sum_s\int m_s \mathbf{v}^\prime f\mathrm{d}\mathbf{v} = 0\)</span> has been used to eliminate terms linear in <span class="math inline">\(\mathbf{v}^\prime\)</span>. The MHD pressure tensor is now defined in terms of the random velocities relative to <span class="math inline">\(\mathbf{u}\)</span> and is given by <span id="eq-pressure-def-MHD"><span class="math display">\[
\overleftrightarrow{P}^{\mathrm{MHD}} = \sum_s \int m_s \mathbf{v}^\prime\mathbf{v}^\prime f_s\mathrm{d}\mathbf{v}
\tag{8.34}\]</span></span></p>
<p>We insert <a href="#eq-momentum-flux-vlasov-MHD" class="quarto-xref">Equation&nbsp;<span>8.33</span></a> and <a href="#eq-pressure-def-MHD" class="quarto-xref">Equation&nbsp;<span>8.34</span></a> in <a href="#eq-1st-moment-vlasov-MHD" class="quarto-xref">Equation&nbsp;<span>8.32</span></a>, integrate by parts on the acceleration term, and perform the summation over species to obtain the MHD equation of motion <span id="eq-momentum-MHD"><span class="math display">\[
\frac{\partial(\rho\mathbf{u})}{\partial t} + \nabla\cdot(\rho\mathbf{u}\mathbf{u}) = \left( \sum_s n_s q_s \right)\mathbf{E} + \mathbf{J}\times\mathbf{B} - \nabla\cdot\overleftrightarrow{P}^{\mathrm{MHD}}
\tag{8.35}\]</span></span></p>
<p>MHD is typically used to describe phenomena having spatial scales large enough for the plasma to be essentially neutral, i.e., <span class="math inline">\(\sum_s n_s q_s = 0\)</span> so that the <span class="math inline">\(\mathbf{E}\)</span> term can be dropped. Just as in the two-fluid situation, the left-hand side of <a href="#eq-momentum-MHD" class="quarto-xref">Equation&nbsp;<span>8.35</span></a> contains a factor times the MHD continuity equation, since the left-hand side can be expanded as <span class="math display">\[
\begin{aligned}
\frac{\partial(\rho\mathbf{u})}{\partial t} + \nabla\cdot(\rho\mathbf{u}\mathbf{u}) &amp;= \left[ \cancel{\frac{\partial\rho}{\partial t} + \nabla\cdot(\rho\mathbf{u})} \right]\mathbf{u} + \rho\frac{\partial\mathbf{u}}{\partial t} + \rho\mathbf{u}\cdot\nabla\mathbf{u} \\
&amp;= \rho \left( \frac{\partial\mathbf{u}}{\partial t} + \mathbf{u}\cdot\nabla\mathbf{u} \right)
\end{aligned}
\]</span></p>
<p>This leads to the standard form for the MHD equation of motion, <span id="eq-motion-MHD"><span class="math display">\[
\rho\frac{\mathrm{D}\mathbf{u}}{\mathrm{D}t} = \mathbf{J}\times\mathbf{B} - \nabla\cdot\overleftrightarrow{P}^{\mathrm{MHD}}
\tag{8.36}\]</span></span> where <span class="math display">\[
\frac{\mathrm{D}}{\mathrm{D}t} \equiv \frac{\partial}{\partial t} + \mathbf{u}\cdot\nabla
\]</span> is the convective derivative defined using the center-of-mass velocity. This notation is used to emphasize the difference from single species treatment. Scalar approximations of the MHD pressure tensor will be postponed until after discussing the MHD Ohm’s law and its implications.</p>
<section id="sec-mhd-ohm" class="level3" data-number="8.6.1">
<h3 data-number="8.6.1" class="anchored" data-anchor-id="sec-mhd-ohm"><span class="header-section-number">8.6.1</span> MHD Ohm’s law</h3>
<p><a href="#eq-motion-MHD" class="quarto-xref">Equation&nbsp;<span>8.36</span></a> provides one equation relating <span class="math inline">\(\mathbf{J}\)</span> and <span class="math inline">\(\mathbf{u}\)</span>; let us now find the other one. In order to do this, consider the two-fluid electron equation of motion, <span id="eq-electron-momentum-mhd"><span class="math display">\[
m_e\frac{\mathrm{d}\mathbf{u}_e}{\mathrm{d}t} = -e(\mathbf{E}+\mathbf{u}_e\times\mathbf{B}) - \frac{1}{n_e}\nabla(n_e k_B T_e) - \nu_{ei}m_e(\mathbf{u}_e - \mathbf{u}_i)
\tag{8.37}\]</span></span></p>
<p>In MHD we are interested in low-frequency phenomena with large spatial scales. If the characteristic time scale of the phenomenon is long compared to the electron cyclotron motion, then the electron inertia term <span class="math inline">\(m_e \mathrm{d}\mathbf{u}_e/\mathrm{d}t\)</span> can be dropped since it is small compared to the magnetic force term <span class="math inline">\(-e(\mathbf{u}_e\times\mathbf{B})\)</span>. This assumption is reasonable for velocities perpendicular to <span class="math inline">\(\mathbf{B}\)</span>, but can be a poor approximation for the velocity component parallel to <span class="math inline">\(\mathbf{B}\)</span>, since parallel velocities do not provide a magnetic force. Since <span class="math inline">\(\mathbf{u}_e - \mathbf{u}_i = -\mathbf{J}/n_e e\)</span> and <span class="math inline">\(\mathbf{u}_i\simeq \mathbf{u}\)</span>, <a href="#eq-electron-momentum-mhd" class="quarto-xref">Equation&nbsp;<span>8.37</span></a> reduces to the generalized Ohm’s law <span id="eq-ohm-law-mhd"><span class="math display">\[
\mathbf{E} + \mathbf{u}\times\mathbf{B} - \frac{1}{n_e e}\mathbf{J}\times\mathbf{B} + \frac{1}{n_e e}\nabla(n_e k_B T_e) = \eta\mathbf{J}
\tag{8.38}\]</span></span></p>
<p>(What if we consider ion species with charge larger than 1?) The term <span class="math inline">\(-\mathbf{J}\times\mathbf{B}/n_e e\)</span> on the left-hand side is called the <em>Hall term</em> and can be neglected in either of the following two cases:</p>
<ol type="1">
<li>The pressure term in the MHD equation of motion, <a href="#eq-motion-MHD" class="quarto-xref">Equation&nbsp;<span>8.36</span></a> is negligible compared to the other two terms, which therefore must balance, giving <span class="math display">\[
|\mathbf{J}|\sim \omega\rho|\mathbf{u}|/|\mathbf{B}|
\]</span></li>
</ol>
<p>Here <span class="math inline">\(\omega\sim\mathrm{D}/\mathrm{D}t\)</span> is the characteristic frequency of the phenomenon. In this case comparison of the Hall term with the U×B term shows that the Hall term is small by a factor <span class="math inline">\(\sim \omega/\omega_{ci}\)</span>, where <span class="math inline">\(\omega_{ci}=q_i B/m_i\)</span> is the ion cyclotron frequency. Thus dropping the Hall term is justified for phenomena having characteristic frequencies small compared to <span class="math inline">\(\omega_{ci}\)</span>.</p>
<ol start="2" type="1">
<li>The electron-ion collision frequency is large compared to the electron cyclotron frequency <span class="math inline">\(\omega_{ce}=q_e B /m_e\)</span>, in which case the Hall term may be dropped since it is small by a factor <span class="math inline">\(\omega_{ce}/\nu_{ei}\)</span> compared to the right-hand side resistive term <span class="math inline">\(\eta\mathbf{J}=(m_e\nu_{ei}/n_e e^2)\mathbf{J}\)</span>.</li>
</ol>
</section>
<section id="ideal-mhd" class="level3" data-number="8.6.2">
<h3 data-number="8.6.2" class="anchored" data-anchor-id="ideal-mhd"><span class="header-section-number">8.6.2</span> Ideal MHD</h3>
<p>If the Hall term is dropped, the system is called ideal MHD. Typically, <a href="#eq-ohm-law-mhd" class="quarto-xref">Equation&nbsp;<span>8.38</span></a> will not be used directly; instead its curl will be used to provide the induction equation <span class="math display">\[
-\frac{\partial\mathbf{B}}{\partial t} + \nabla\times(\mathbf{u}\times\mathbf{B}) - \frac{1}{n_e e}\nabla n_e\times\nabla k_B T_e = \nabla\times\left( \frac{\eta}{\mu_0}\nabla\times\mathbf{B} \right)
\]</span></p>
<p>Usually the density gradient is parallel to the temperature gradient so that the thermal electromotive force term <span class="math inline">\((n_e e)^{-1}\nabla n_e\times\nabla k_B T_e\)</span> can be dropped, or the thermal term is often simply ignored, in which case the induction equation reduces to <span id="eq-mhd-induction"><span class="math display">\[
-\frac{\partial\mathbf{B}}{\partial t} + \nabla\times(\mathbf{u}\times\mathbf{B}) = \nabla\times\left( \frac{\eta}{\mu_0}\nabla\times\mathbf{B} \right)
\tag{8.39}\]</span></span> or written in the form of Ohm’s law <span id="eq-ideal-mhd-ohm-law"><span class="math display">\[
\mathbf{E} + \mathbf{u}\times\mathbf{B} = \eta\mathbf{J}
\tag{8.40}\]</span></span></p>
<p>If the resistive term <span class="math inline">\(\eta\mathbf{J}\)</span> is so small as to be negligible compared to the other terms in <a href="#eq-ideal-mhd-ohm-law" class="quarto-xref">Equation&nbsp;<span>8.40</span></a>, then the plasma is said to be <em>ideal</em> or <em>perfectly conducting</em>. From the Lorentz transformation of electromagnetic theory we realize that <span class="math display">\[
\mathbf{E}+\mathbf{u}\times\mathbf{B} = \mathbf{E}^\prime
\]</span> where <span class="math inline">\(\mathbf{E}^\prime\)</span> is the electric field observed in the frame moving with velocity <span class="math inline">\(\mathbf{u}\)</span>. This implies that the magnetic flux in ideal plasmas is time-invariant in the frame moving with velocity <span class="math inline">\(\mathbf{u}\)</span>, because otherwise Faraday’s law would imply the existence of an electric field in the moving frame. The frozen-in flux concept is the essential “bed-rock” concept underlying ideal MHD. While this concept is often an excellent approximation, it must be kept in mind that the concept becomes invalid in situations when any one of the electron inertia, electron pressure, or Hall terms becomes important and leads to different, more complex behavior.</p>
<p>The frozen-in flux concept is frequently expressed in a slightly different form as a frozen-in field concept, i.e., it is often said that magnetic field lines are frozen into the plasma so that the plasma and magnetic field lines move together as an ensemble. While this point of view can be quite intuitive and useful, it contains some ambiguity because an ideal plasma can actually move across magnetic field lines in certain situations. These situations are such that magnetic flux is preserved within the plasma even though it is moving across field lines.</p>
<p>A formal proof of the frozen-in flux property will now be established by direct calculation of the rate of change of the magnetic flux through a surface <span class="math inline">\(S(t)\)</span> bounded by a material line <span class="math inline">\(C(t)\)</span>, i.e., a closed contour that moves with the plasma. This magnetic flux is <span class="math display">\[
\Phi(t) = \int_{S(t)} \mathbf{B}(\mathbf{x},t)\cdot\mathrm{d}\mathbf{s}
\]</span> and the flux changes with respect to time due to either (i) the explicit time dependence of <span class="math inline">\(\mathbf{B}(t)\)</span> or (ii) changes in the surface <span class="math inline">\(S(t)\)</span> resulting from plasma motion. The rate of change of flux is thus <span class="math display">\[
\frac{\mathrm{D}\Phi}{\mathrm{D}t} = \lim_{\delta t\rightarrow 0}\left( \frac{ \int_{S(t+\delta t)} \mathbf{B}(\mathbf{x},t+\delta t)\cdot\mathrm{d}\mathbf{s} - \int_{S(t)} \mathbf{B}(\mathbf{x},t)\cdot\mathrm{d}\mathbf{s} }{\delta t} \right)
\]</span></p>
<p>The displacement of a segment <span class="math inline">\(\mathrm{d}\mathbf{l}\)</span> of the bounding contour <span class="math inline">\(C\)</span> is <span class="math inline">\(\mathbf{u}\delta t\)</span>, where <span class="math inline">\(\mathbf{u}\)</span> is the velocity of this segment. The incremental change in surface area due to this displacement is <span class="math inline">\(\Delta S = \mathbf{u}\delta t\times\mathrm{d}\mathbf{l}\)</span>. The rate of change of flux can thus be expressed as <span class="math display">\[
\begin{aligned}
\frac{\mathrm{D}\Phi}{\mathrm{D}t} &amp;= \lim_{\delta t\rightarrow 0}\left( \frac{ \int_{S(t+\delta t)} \left(\mathbf{B}+\delta t\frac{\partial\mathbf{B}}{\partial t}\right)\cdot\mathrm{d}\mathbf{s} - \int_{S(t)} \mathbf{B}\cdot\mathrm{d}\mathbf{s} }{\delta t} \right) \\
&amp;= \lim_{\delta t\rightarrow 0}\left( \frac{ \int_{S(t)} \left(\mathbf{B}+\delta t\frac{\partial\mathbf{B}}{\partial t}\right)\cdot\mathrm{d}\mathbf{s} + \oint_C\mathbf{B}\cdot\mathbf{u}\delta t\times\mathrm{d}\mathbf{l} - \int_{S(t)} \mathbf{B}\cdot\mathrm{d}\mathbf{s} }{\delta t} \right) \\
&amp;= \int_{S(t)}\frac{\partial\mathbf{B}}{\partial t}\cdot\mathrm{d}\mathbf{s} + \oint_C\mathbf{B}\cdot\mathbf{u}\times\mathrm{d}\mathbf{l} \\
&amp;= \int_{S(t)}\frac{\partial\mathbf{B}}{\partial t}\cdot\mathrm{d}\mathbf{s} + \oint_C\mathrm{d}\mathbf{l}\cdot(\mathbf{B}\cdot\mathbf{u}) \\
&amp;= \int_{S(t)}\left[ \frac{\partial\mathbf{B}}{\partial t} + \nabla\times(\mathbf{B}\times\mathbf{u}) \right]\cdot\mathrm{d}\mathbf{S}
\end{aligned}
\]</span></p>
<p>Thus, if <span id="eq-induction-ideal-mhd"><span class="math display">\[
\frac{\partial\mathbf{B}}{\partial t} + \nabla\times(\mathbf{B}\times\mathbf{u}) = 0
\tag{8.41}\]</span></span> then <span class="math display">\[
\frac{\mathrm{D}\Phi}{\mathrm{D}t} = 0
\]</span> so that the magnetic flux linked by any closed material line is constant. Therefore, magnetic flux is frozen into an ideal plasma because <a href="#eq-mhd-induction" class="quarto-xref">Equation&nbsp;<span>8.39</span></a> reduces to <a href="#eq-induction-ideal-mhd" class="quarto-xref">Equation&nbsp;<span>8.41</span></a> if <span class="math inline">\(\eta = 0\)</span>. <a href="#eq-induction-ideal-mhd" class="quarto-xref">Equation&nbsp;<span>8.41</span></a> is called the ideal MHD induction equation.</p>
<section id="equation-of-state-1" class="level4" data-number="8.6.2.1">
<h4 data-number="8.6.2.1" class="anchored" data-anchor-id="equation-of-state-1"><span class="header-section-number">8.6.2.1</span> Equation of state</h4>
<p><strong>Double adiabatic laws</strong></p>
<p>A procedure analogous to that which led to <a href="#eq-eos_adiabatic" class="quarto-xref">Equation&nbsp;<span>8.11</span></a> or <a href="kinetic.html#eq-adiabatic1" class="quarto-xref">Equation&nbsp;<span>12.28</span></a> gives the MHD adiabatic relation <span class="math display">\[
\frac{p^{\mathrm{MHD}}}{\rho^\gamma} = \mathrm{const}.
\]</span> where again <span class="math inline">\(\gamma=(N+2)/N\)</span> and <span class="math inline">\(N\)</span> is the number of dimensions of the system. It was shown in the previous section that magnetic flux is conserved in the plasma frame. This means that, as shown in <a href="#fig-b-flux-tube" class="quarto-xref">Figure&nbsp;<span>8.1</span></a>, a tube of plasma initially occupying the same volume as a magnetic flux tube is constrained to evolve in such a way that <span class="math inline">\(\int\mathbf{B}\cdot\mathrm{d}\mathbf{s}\)</span> stays constant over the plasma tube cross-section. For a flux tube of infinitesimal cross-section, the magnetic field is approximately uniform over the cross-section and we may write this as <span class="math inline">\(BA = \mathrm{const}\)</span>, where <span class="math inline">\(A\)</span> is the cross-sectional area.</p>
<div id="fig-b-flux-tube" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-b-flux-tube-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="../images/magnetic_flux_tube.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-b-flux-tube-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8.1: Magnetic flux tube with flux <span class="math inline">\(\Phi=BA\)</span>.
</figcaption>
</figure>
</div>
<p>Let us define two temperatures for this magnetized plasma, namely <span class="math inline">\(T_\perp\)</span>, the temperature corresponding to motions perpendicular to the magnetic field, and <span class="math inline">\(T_\parallel\)</span>, the temperature corresponding to motions parallel to the magnetic field. If for some reason (e.g., anisotropic heating or compression) the temperature develops an anisotropy such that <span class="math inline">\(T_\perp \neq T_\parallel\)</span> and if collisions are infrequent, this anisotropy will persist for a long time, since collisions are the means by which the two temperatures equilibrate. Thus, rather than assuming that the MHD pressure is fully isotropic, we consider the less restrictive situation where the MHD pressure tensor is given by <span class="math display">\[
\overleftrightarrow{P}^{\mathrm{MHD}} =
\begin{bmatrix}
p_\perp &amp; 0 &amp; 0 \\ 0 &amp; p_\perp &amp; 0 \\ 0 &amp; 0 &amp; p_\parallel
\end{bmatrix} =
p_\perp\mathbf{I} + (p_\parallel - p_\perp)\hat{b}\hat{b}
\]</span></p>
<p>The first two coordinates (<span class="math inline">\(x, y\)</span>-like) in the above matrix refer to the directions perpendicular to the local magnetic field <span class="math inline">\(\mathbf{B}\)</span> and the third coordinate (<span class="math inline">\(z\)</span>-like) refers to the direction parallel to <span class="math inline">\(\mathbf{B}\)</span>. The tensor expression on the right-hand side is equivalent (here <span class="math inline">\(\mathbf{I}\)</span> is the unit tensor) but allows for arbitrary, curvilinear geometry. We now develop separate adiabatic relations for the perpendicular and parallel directions:</p>
<ul>
<li><p>Parallel direction: here the number of dimensions is <span class="math inline">\(N = 1\)</span> so that <span class="math inline">\(\gamma = 3\)</span> and so the adiabatic law gives <span id="eq-parallel-p-rho-1D"><span class="math display">\[
\frac{p_\parallel^{1D}}{\rho_{1D}^3}=\mathrm{const.}
\tag{8.42}\]</span></span> where <span class="math inline">\(\rho_{1D}\)</span> is the <em>one-dimensional</em> mass density; i.e., <span class="math inline">\(\rho_{1D}\sim 1/L\)</span>, where <span class="math inline">\(L\)</span> is the length along the flux tube in <a href="#fig-b-flux-tube" class="quarto-xref">Figure&nbsp;<span>8.1</span></a>. The three-dimensional mass density, which has been used implicitly until now, has the proportionality <span class="math inline">\(\rho\sim 1/LA\)</span>, where <span class="math inline">\(A\)</span> is the cross-section of the flux tube; similarly the three-dimensional pressure has the proportionality <span class="math inline">\(p_\parallel \sim \rho T_\parallel\)</span>. However, we must be careful to realize that <span class="math inline">\(p_\parallel^{1D}\sim\rho_{1D}T_\parallel\)</span> so, using <span class="math inline">\(BA=\mathrm{const.}\)</span>, <a href="#eq-parallel-p-rho-1D" class="quarto-xref">Equation&nbsp;<span>8.42</span></a> can be recast as <span class="math display">\[
\mathrm{const.} = \frac{p_\parallel^{1D}}{\rho_{1D}^3} \sim \frac{\rho_{1D}T_\parallel}{\rho_{1D}^3} \sim T_\parallel \rho_{1D}^2 \sim \left( \frac{1}{LA} \right) T_\parallel (LA)^3 B^2
\]</span> or <span id="eq-CGL-par"><span class="math display">\[
\frac{p_\parallel B^2}{\rho^3} = \mathrm{const.}
\tag{8.43}\]</span></span></p></li>
<li><p>Perpendicular direction: here the number of dimensions is <span class="math inline">\(N = 2\)</span> so that <span class="math inline">\(\gamma = 2\)</span> and the adiabatic law gives <span id="eq-perpendicular-p-rho-2D"><span class="math display">\[
\frac{p_\perp^{2D}}{\rho_{2D}^2}=\mathrm{const.}
\tag{8.44}\]</span></span> where <span class="math inline">\(p_\perp^{2D}\)</span> is the 2-D perpendicular pressure, and has dimensions of energy per unit area, while <span class="math inline">\(\rho_{2D}\)</span> is the 2-D mass density and has dimensions of mass per unit area. Thus, <span class="math inline">\(\rho_{2D}\sim 1/A\)</span> so <span class="math inline">\(p_\perp^{2D}\sim\rho_{2D}T_\perp \sim T_\perp/A\)</span>, in which case <a href="#eq-perpendicular-p-rho-2D" class="quarto-xref">Equation&nbsp;<span>8.44</span></a> can be recast as <span class="math display">\[
\mathrm{const.} = \frac{p_\parallel B^2}{\rho^3} = T_\perp A \sim \left( \frac{1}{LA} \right) T_\perp \frac{LA}{B}
\]</span> or <span id="eq-CGL-perp"><span class="math display">\[
\frac{p_\perp}{\rho B} = \mathrm{const.}
\tag{8.45}\]</span></span></p></li>
</ul>
<p><a href="#eq-CGL-par" class="quarto-xref">Equation&nbsp;<span>8.43</span></a> and <a href="#eq-CGL-perp" class="quarto-xref">Equation&nbsp;<span>8.45</span></a> are called the double adiabatic or CGL laws after Chew, Goldberger, and Low <span class="citation" data-cites="cgl1956">(<a href="#ref-cgl1956" role="doc-biblioref">Chew, Goldberger, and Low 1956</a>)</span> who first developed these laws.</p>
<p><strong>Single adiabatic law</strong></p>
<p>If collisions are sufficiently frequent to equilibrate the perpendicular and parallel temperatures, then the pressure tensor becomes fully isotropic and the dimensionality of the system is <span class="math inline">\(N = 3\)</span> so that <span class="math inline">\(\gamma = 5/3\)</span>. There is now just one pressure and one temperature and the adiabatic relation becomes <span id="eq-single-adiabatic"><span class="math display">\[
\frac{p}{\rho^{5/3}} = \mathrm{const.}
\tag{8.46}\]</span></span></p>
</section>
<section id="mhd-approximations-for-maxwells-equations" class="level4" data-number="8.6.2.2">
<h4 data-number="8.6.2.2" class="anchored" data-anchor-id="mhd-approximations-for-maxwells-equations"><span class="header-section-number">8.6.2.2</span> MHD approximations for Maxwell’s equations</h4>
<p>The various assumptions contained in MHD lead to a simplifying approximation of Maxwell’s equations. In particular, the assumption of charge neutrality in MHD makes Poisson’s equation superfluous because Poisson’s equation prescribes the relationship between non-neutrality and the electrostatic component of the electric field. The assumption of charge neutrality also has implications for the current density. To see this, the two-fluid continuity equation is multiplied by <span class="math inline">\(q_s\)</span> and then summed over species to obtain the charge conservation equation <span id="eq-charge-conservation"><span class="math display">\[
\frac{\partial}{\partial t}\left( \sum_s n_s q_s \right) + \nabla\cdot\mathbf{J} = 0
\tag{8.47}\]</span></span></p>
<p>Thus, charge neutrality implies <span class="math display">\[
\nabla\cdot\mathbf{J} = 0
\]</span></p>
<p>Let us now consider Ampère’s law <span class="math display">\[
\nabla\times\mathbf{B} = \mu_0\mathbf{J} + \mu_0\epsilon_0\dot{\mathbf{E}}
\]</span></p>
<p>Taking the divergence gives <span class="math display">\[
\nabla\cdot
\]</span> which is equivalent to <a href="#eq-charge-conservation" class="quarto-xref">Equation&nbsp;<span>8.47</span></a> if Poisson’s equation is invoked.</p>
<p>Finally, MHD is restricted to phenomena having characteristic velocities <span class="math inline">\(V_{\mathrm{ph}}\)</span> slow compared to the speed of light in vacuum, <span class="math inline">\(c=(\mu_0 \epsilon_0)^{-1/2}\)</span>. Again, <span class="math inline">\(t_{\mathrm{char}}\)</span> is assumed to represent the characteristic time scale for a given phenomenon and <span class="math inline">\(l_{\mathrm{char}}\)</span> is assumed to represent the corresponding characteristic length scale so that <span class="math inline">\(V_{\mathrm{ph}}\sim l_{\mathrm{char}}/t_{\mathrm{char}}\)</span>. Faraday’s equation gives the scaling <span class="math display">\[
\nabla\times\mathbf{E} = -\dot{\mathbf{B}} \rightarrow E \sim B l_{\mathrm{char}}/t_{\mathrm{char}}
\]</span> On comparing the magnitude of the displacement current term in Ampère’s law to the left-hand side it is seen that <span class="math display">\[
\frac{\mu_0\epsilon_0|\dot{\mathbf{E}}|}{|\nabla\times\mathbf{B}|} \sim \frac{c^{-2} E/t_{\mathrm{char}}}{B/l_{\mathrm{char}}} \sim \left( \frac{V_{\mathrm{ph}}}{c} \right)^2
\]</span></p>
<p>Thus, if <span class="math inline">\(V_{\mathrm{ph}} \ll c\)</span> the displacement current term can be dropped from Amperè’s law resulting in the so-called “pre-Maxwell” form (i.e.&nbsp;Darwin approximation) <span id="eq-ampere-pre-maxwell"><span class="math display">\[
\nabla\times\mathbf{B} = \mu_0 \mathbf{J}
\tag{8.48}\]</span></span></p>
<p>The divergence of <a href="#eq-ampere-pre-maxwell" class="quarto-xref">Equation&nbsp;<span>8.48</span></a> gives <span class="math inline">\(\nabla\cdot\mathbf{J}=0\)</span> so it is unnecessary to specify it separately.</p>
</section>
<section id="complete-equation-set" class="level4" data-number="8.6.2.3">
<h4 data-number="8.6.2.3" class="anchored" data-anchor-id="complete-equation-set"><span class="header-section-number">8.6.2.3</span> Complete equation set</h4>
<p>In the most common sense, ideal MHD involves equations of compressible, adiabatic and inviscid fluid: <span id="eq-ideal-mhd"><span class="math display">\[
\begin{aligned}
\frac{\partial \rho}{\partial t} + \nabla\cdot(\rho\mathbf{u}) = 0 \\
\frac{\partial \rho\mathbf{u}}{\partial t} + \nabla\cdot\left( \rho\mathbf{u}\mathbf{u} - \frac{1}{\mu_0}\mathbf{B}\mathbf{B} + p^\ast \right) = 0 \\
\frac{\partial \mathcal{E}}{\partial t} + \nabla\cdot\left[ (\mathcal{E} + p^\ast)\mathbf{u} - \frac{1}{\mu_0}\mathbf{B}(\mathbf{B}\cdot\mathbf{u}) \right] = 0 \\
\frac{\partial \mathbf{B}}{\partial t} - \nabla\times(\mathbf{u}\times\mathbf{B}) = 0 \\
p^\ast = p + \frac{\mathbf{B}\cdot\mathbf{B}}{2\mu_0} \\
\mathcal{E} = \frac{p}{\gamma - 1} + \frac{\rho \mathbf{u}\cdot\mathbf{u}}{2} + \frac{\mathbf{B}\cdot\mathbf{B}}{2\mu_0}
\end{aligned}
\tag{8.49}\]</span></span> where <span class="math inline">\(\rho\)</span> is the mass density, <span class="math inline">\(\mathbf{u}\)</span> the velocity, <span class="math inline">\(\mathcal{E}\)</span> the total energy density, <span class="math inline">\(\mathbf{B}\)</span> the magnetic field, <span class="math inline">\(p\)</span> the thermal pressure, and <span class="math inline">\(\gamma\)</span> the adiabatic index (ratio of specific heats). Microscopic dissipations of any kind (viscosity, resistivity, or conduction) are not included in ideal MHD. Note that there is only one constant <span class="math inline">\(\mu_0\)</span> appeared in <a href="#eq-ideal-mhd" class="quarto-xref">Equation&nbsp;<span>8.49</span></a>. The introduction of temperature comes with a new constant <span class="math inline">\(R\equiv 2k_B/m\)</span>: <span class="math display">\[
p = \rho\, R\, T
\]</span></p>
<p>Many often in simulations, the dimensionless units are applied. <a href="#eq-ideal-mhd" class="quarto-xref">Equation&nbsp;<span>8.49</span></a> under the dimensionless units can be written as <span id="eq-ideal-mhd-dimensionless"><span class="math display">\[
\begin{aligned}
\frac{\partial \rho_\ast}{\partial t_\ast} + \nabla_\ast\cdot(\rho_\ast\mathbf{u}_\ast) = 0 \\
\frac{\partial \rho_\ast\mathbf{u}_\ast}{\partial t_\ast} + \nabla_\ast\cdot\left( \rho_\ast\mathbf{u}_\ast\mathbf{u}_\ast - \mathbf{B}_\ast\mathbf{B}_\ast + p_\ast^\ast \right) = 0 \\
\frac{\partial \mathcal{E}_\ast}{\partial t_\ast} + \nabla_\ast\cdot\left[ (\mathcal{E}_\ast + p_\ast^\ast)\mathbf{u}_\ast - \mathbf{B}_\ast(\mathbf{B}_\ast\cdot\mathbf{u}_\ast) \right] = 0 \\
\frac{\partial \mathbf{B}_\ast}{\partial t_\ast} - \nabla_\ast\times(\mathbf{u}_\ast\times\mathbf{B}_\ast) = 0 \\
p_\ast^\ast = p_\ast + \frac{\mathbf{B}_\ast\cdot\mathbf{B}_\ast}{2} \\
\mathcal{E}_\ast = \frac{p_\ast}{\gamma - 1} + \frac{\rho_\ast \mathbf{u}_\ast\cdot\mathbf{u}_\ast}{2} + \frac{\mathbf{B}_\ast\cdot\mathbf{B}_\ast}{2}
\end{aligned}
\tag{8.50}\]</span></span> where the subscripts <span class="math inline">\(\ast\)</span> denotes the variables in dimensionless units, and the adiabatic equation of state is given as <span class="math display">\[
p_\ast = \rho_\ast T_\ast
\]</span></p>
<p>In more theoretical derivations, for simplicity the energy equation is substituted with either single adiabatic law <a href="#eq-single-adiabatic" class="quarto-xref">Equation&nbsp;<span>8.46</span></a> or double adiabatic law <a href="#eq-CGL-par" class="quarto-xref">Equation&nbsp;<span>8.43</span></a> and <a href="#eq-CGL-perp" class="quarto-xref">Equation&nbsp;<span>8.45</span></a>.<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> If we drop the isotropic assumption and instead use separate pressure equations for the parallel and perpendicular components as in <a href="#eq-6-moment-fluids" class="quarto-xref">Equation&nbsp;<span>8.14</span></a>, we get the anisotropic MHD equations:<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a> <span id="eq-aniso-mhd"><span class="math display">\[
\begin{aligned}
\frac{\partial \rho_s}{\partial t} + \nabla\cdot(\rho_s\mathbf{u}_s) = 0 \\
\frac{\partial (\rho_s\mathbf{u}_s)}{\partial t} + \nabla\cdot\left[ \rho_s\mathbf{u}_s\mathbf{u}_s + p_{s\perp}\pmb{I} + (p_{s\parallel} - p_{s\perp})\hat{b}\hat{b} - \frac{1}{\mu_0}\left( \mathbf{B}\mathbf{B} - \frac{B^2}{2}\pmb{I} \right) \right] = 0 \\
\frac{\partial\mathbf{B}}{\partial t} - \nabla\times\left( \mathbf{u}_s \times\mathbf{B} \right) = 0 \\
\frac{\partial p_{s\parallel}}{\partial t} + \nabla\cdot(p_{s\parallel}\mathbf{u}_s) + 2p_{s\parallel}\hat{b}\cdot(\hat{b}\cdot\nabla)\mathbf{u}_s = \frac{\delta p_{s\parallel}}{\delta t} \\
\frac{\partial p_{s}}{\partial t} + \nabla\cdot(p_{s}\mathbf{u}_s) + \frac{2}{3}p_{s\perp}(\nabla\cdot\mathbf{u}_s) + \frac{2}{3}(p_\parallel - p_\perp)\hat{b}\cdot(\hat{b}\cdot\nabla)\mathbf{u}_s = 0
\end{aligned}
\tag{8.51}\]</span></span></p>
<p>For capturing jump conditions across a discontinuity, the conservative energy equation is needed to substitute the total pressure equation: <span id="eq-aniso-energy"><span class="math display">\[
\frac{\partial e}{\partial t} + \nabla\cdot\left[ \mathbf{u}\left( e+p_\perp + \frac{\mathbf{B}^2}{2\mu_0} + \mathbf{u}\cdot\left( (p_\parallel - p_\perp)\hat{b}\hat{b} - \frac{\mathbf{B}\mathbf{B}}{2\mu_0}  \right) \right) \right]
\tag{8.52}\]</span></span> with total energy density <span id="eq-aniso-e"><span class="math display">\[
e = \frac{\rho \mathbf{u}^2}{2} + \frac{\mathbf{B}^2}{2\mu_0} + \frac{3}{2}p
\tag{8.53}\]</span></span></p>
<p>The plasma instabilities associated with anisotropic pressure limit, i.e.&nbsp;firehose, mirror, and ion cyclotron instability may contain kinetic effects that cannot be fully described by MHD (<a href="kmhd.html" class="quarto-xref"><span>Chapter 14</span></a>). Moreover, the grid resolution in normal global MHD simulations may not be fine enough to resolve even hydromagnetic instabilities.</p>
<ul>
<li><p>Criterion for the firehose instability <span id="eq-firehose-threshold"><span class="math display">\[
\frac{p_\parallel}{p_\perp} &gt; 1 + \frac{\mathbf{B}^2}{\mu_0 p_\perp}
\tag{8.54}\]</span></span></p></li>
<li><p>Criterion for the mirror instability <span id="eq-mirror-threshold"><span class="math display">\[
\frac{p_\perp}{p_\parallel} &gt; 1 + \frac{\mathbf{B}^2}{2\mu_0 p_\perp}
\tag{8.55}\]</span></span></p></li>
<li><p>Criterion for the ion cyclotron instability <span id="eq-aic-threshold"><span class="math display">\[
\frac{p_\perp}{p_\parallel} &gt; 1 + C_1\left(\frac{\mathbf{B}^2}{2\mu_0 p_\parallel}\right)^{C_2}
\tag{8.56}\]</span></span> where from observations in the magnetosphere [Anderson+ 1996; Gary+ 1995] we can take the average values <span class="math inline">\(C_1 = 0.3\)</span> and <span class="math inline">\(C_2 = 0.5\)</span>.</p></li>
</ul>
<p>The effect of these instabilities is represented by the collision term of the parallel pressure on the RHS of the fourth equation in <a href="#eq-aniso-mhd" class="quarto-xref">Equation&nbsp;<span>8.51</span></a>: <span id="eq-aniso-relaxation"><span class="math display">\[
\frac{\delta p_\parallel}{\delta t} = \frac{\bar{p}_\parallel - p_\parallel}{\tau}
\tag{8.57}\]</span></span> where <span class="math inline">\(\bar{p}_\parallel\)</span> is the marginally stable parallel pressure obtained from <a href="#eq-firehose-threshold" class="quarto-xref">Equation&nbsp;<span>8.54</span></a>, <a href="#eq-mirror-threshold" class="quarto-xref">Equation&nbsp;<span>8.55</span></a>, and <a href="#eq-aic-threshold" class="quarto-xref">Equation&nbsp;<span>8.56</span></a>. <a href="#eq-aniso-relaxation" class="quarto-xref">Equation&nbsp;<span>8.57</span></a> is called the pressure relaxation term due to the instabilities, with the relaxation time <span class="math inline">\(\tau\)</span> related to their growth rates.</p>
<p>These equations provide a self-consistent description of phenomena that satisfy all the various assumptions we have made, namely:</p>
<ol type="1">
<li>The plasma is charge-neutral since characteristic lengths are much longer than a Debye length;</li>
<li>The characteristic velocity of the phenomenon under consideration is slow compared to the speed of light;</li>
<li>The pressure and density gradients are parallel, so there is no electrothermal EMF;</li>
<li>The time scale is long compared to both the electron and ion cyclotron periods.</li>
</ol>
<p>Even though these assumptions are self-consistent, they may not accurately portray a real plasma and so MHD models, while intuitively appealing, must be used with caution.</p>
<p>Finally, it is worth mentioning that MHD plasmas can be categorized yet another way, namely according to the relative importance of the magnetic force <span class="math inline">\(\mathbf{J}\times\mathbf{B}\)</span> compared to the hydrodynamic force <span class="math inline">\(\nabla\cdot\overleftrightarrow{P}\)</span>. If the magnetic force is negligible compared to the hydrodynamic force, then there is not much point in using MHD because in this case the system of equations is simply classical hydrodynamics. Thus, the only non-trivial MHD situations are where the magnetic and hydrodynamic forces are of comparable importance or where the magnetic force is much more important than the hydrodynamic force. Using <a href="#eq-ampere-pre-maxwell" class="quarto-xref">Equation&nbsp;<span>8.48</span></a>, the nominal ratio of the hydrodynamic force to the magnetic force is defined as <span class="math display">\[
\beta = \frac{p}{B^2/2\mu_0} \sim \frac{\nabla\cdot\overleftarrow{P}}{\mathbf{J}\times\mathbf{B}} \sim \frac{p/L}{B^2/2\mu_0 L}
\]</span></p>
<p>The characteristic gradient scale length <span class="math inline">\(L\)</span> is assumed to be comparable for both types of forces and so cancels out in the comparison. Low-<span class="math inline">\(\beta\)</span> plasmas are those where <span class="math inline">\(B^2/2\mu_0\)</span> is much larger than <span class="math inline">\(p\)</span> so the hydrodynamic force is negligible compared to the magnetic force, whereas <span class="math inline">\(\beta = \mathcal{O}(1)\)</span> plasmas are those where the magnetic and hydrodynamic forces are comparable. The different <span class="math inline">\(\beta\)</span> regime has important implications on the validity of many approximations seen in later chapters.</p>
</section>
</section>
<section id="hall-mhd" class="level3" data-number="8.6.3">
<h3 data-number="8.6.3" class="anchored" data-anchor-id="hall-mhd"><span class="header-section-number">8.6.3</span> Hall MHD</h3>
<p>As an extension to the ideal/resistive MHD model, Hall MHD decouples the electron and ion motions by retrieving the Hall term in the generalized Ohm’s law <span id="eq-ohm-law-hall"><span class="math display">\[
\mathbf{E} = -\mathbf{u}\times\mathbf{B}+\eta\mathbf{J}+\frac{1}{en}\mathbf{J}\times\mathbf{B} - \frac{\nabla p_e}{ne}
\tag{8.58}\]</span></span> where the first term on the right-hand-side is the convective term, the second is the resistive term, the third is the Hall term, and the fourth is the electron pressure gradient term. The electron pressure scalar is simplified from the electron pressure tensor, which is obtained from an independent electron pressure equation.</p>
<p>The Hall MHD equations are <span id="eq-hall_mhd"><span class="math display">\[
\begin{aligned}
\frac{\partial\rho}{\partial t}&amp;=-\nabla\cdot \left(\rho \mathbf{u} \right) \\
\frac{\partial (\rho\mathbf{u})}{\partial t}&amp;=-\nabla\cdot \left(\rho\mathbf{u}\mathbf{u}+(p+p_e)\bar{\bar{I}}+\frac{B^2}{2\mu_0}\bar{\bar{I}}-\frac{\mathbf{B}\mathbf{B}}{\mu_0} \right) \\
\frac{\partial e}{\partial t}&amp;=-\nabla\cdot\left[ \left(\epsilon+p\right)\mathbf{u} +(\epsilon_e + p_e)\mathbf{u}_e+\mathbf{u}_e\cdot\left(\frac{\mathbf{B}^2}{\mu_0}\bar{\bar{I}}-\frac{\mathbf{B}\mathbf{B}}{\mu_0}\right) - \mathbf{B}\times\eta\mathbf{J} \right] \\
\frac{\partial \mathbf{B}}{\partial t} &amp;= -\nabla\times\left[ \mathbf{u}_e \times\mathbf{B} + \eta\mathbf{J} - \frac{\nabla p_e}{ne}\right] \\
\frac{\partial p_e}{\partial t} + \nabla\cdot \left(p_e\mathbf{u}_e \right)&amp;=-(\gamma-1)p_e\nabla\cdot\mathbf{u}_e
\end{aligned}
\tag{8.59}\]</span></span> where <span class="math inline">\(\bar{\bar{I}}\)</span> is the identity matrix, <span class="math inline">\(\rho\)</span> is the mass density, <span class="math inline">\(\mathbf{u}\)</span> is the plasma bulk velocity, <span class="math inline">\(\mathbf{B}\)</span> is the magnetic field, <span class="math inline">\(p_e\)</span> is the electron pressure, <span class="math inline">\(p\)</span> is the ion thermal pressure, <span class="math inline">\(\mathbf{J}=\nabla\times\mathbf{B}/\mu_0\)</span> is the current density, <span class="math inline">\(\epsilon=\rho\mathbf{u}^2/2\)</span> is the hydrodynamic energy density, and <span class="math inline">\(\epsilon_e=\rho\mathbf{u}_e^2/2\)</span> is the electron hydrodynamic energy density. The Hall velocity is defined as <span id="eq-hall-velocity"><span class="math display">\[
\mathbf{v}_H=-\frac{\mathbf{J}}{ne}
\tag{8.60}\]</span></span> and the electron bulk velocity is given by <span id="eq-hall-electron-velocity"><span class="math display">\[
\mathbf{u}_e = \mathbf{u} + \mathbf{v}_H
\tag{8.61}\]</span></span></p>
<p>The total energy density is (I may have a coefficient error here for <span class="math inline">\(p_e\)</span>!) <span class="math display">\[
e= \frac{1}{2}\rho \mathbf{u}^2+\frac{1}{\gamma-1}(p+p_e)+\frac{\mathbf{B}^2}{2\mu_0}
\]</span> where <span class="math inline">\(\gamma\)</span> is the adiabatic index. Note that in Hall MHD only <span class="math inline">\((\rho,\mathbf{u},\mathbf{B},p,p_e)\)</span> are unknowns; all others are derived quantities.</p>
<p>One important thing to recognize is that while ideal MHD has no intrinsic scales, Hall MHD introduces a new characteristic length scale into the system – the ion skin depth <span class="math inline">\(d_i\)</span>. In ideal MHD, when the plasma beta is low, the speed of the shear Alfvén mode and the fast magnetosonic mode become approximately equal. This is known as <em>degeneracy</em>, which means it is difficult to distinguish between the two modes, as they essentially travel at the same speed. In Hall MHD, when the wavelength of the waves becomes comparable to <span class="math inline">\(d_i\)</span>, the distinction between the shear Alfvén and the fast magnetosonic modes becomes clear:</p>
<ol type="1">
<li>Fast magnetosonic waves (whistler waves) are affected by electron dynamics and propagate at higher frequencies within the Hall-MHD framework.</li>
<li>Shear Alfvén waves (kinetic Alfvén waves, or Alfvén-ion-cyclotron waves) are predominantly driven by ion dynamics and tend to propagate at lower frequencies.</li>
</ol>
</section>
</section>
<section id="sec-fluid-drift-perp" class="level2" data-number="8.7">
<h2 data-number="8.7" class="anchored" data-anchor-id="sec-fluid-drift-perp"><span class="header-section-number">8.7</span> Fluid Drifts Perpendicular to B</h2>
<p>Since a fluid element is composed of many individual particles, one would expect the fluid to have drifts perpendicular to <span class="math inline">\(\mathbf{B}\)</span> if the individual guiding centers have such drifts. However, since the <span class="math inline">\(\nabla p\)</span> term appears only in the fluid equations, there is a drift associated with it which the fluid elements have but the particles do not have. For each species, we have an equation of motion <span id="eq-momentum_single_fluid_ratio"><span class="math display">\[
mn\Big[ \underbrace{\frac{\partial\mathbf{u}}{\partial t}}_{1}+\underbrace{(\mathbf{u}\cdot\nabla)\mathbf{u}}_{2}\Big] = q n (\mathbf{E}+\underbrace{\mathbf{u}\times\mathbf{B}}_{3}) - \nabla p
\tag{8.62}\]</span></span></p>
<p>Consider the ratio of term 1 to term 3: <span class="math display">\[
\frac{\text{term }1}{\text{term }3} \approx \bigg\lvert\frac{mni\omega v_\perp}{qnv_\perp B}\bigg\rvert \approx \frac{\omega}{\omega_c}
\]</span></p>
<p>Here we have taken <span class="math inline">\(\partial/\partial t=i\omega\)</span> and are concerned only with <span class="math inline">\(\mathbf{v}_\perp\)</span>. For drifts slow compared with the time scale associated with <span class="math inline">\(\omega_c\)</span>, we may neglect term 1. We shall also neglect the <span class="math inline">\((\mathbf{u}\cdot\nabla)\mathbf{u}\)</span> term and show a <em>posteriori</em> that this is all right. Let <span class="math inline">\(\mathbf{E}\)</span> and <span class="math inline">\(\mathbf{B}\)</span> be uniform, but let <span class="math inline">\(n\)</span> and <span class="math inline">\(p\)</span> have a gradient. This is the usual situation in a magnetically confined plasma column (Fig. 3.4 ADD FIGURE!). Taking the cross product of <a href="#eq-momentum_single_fluid_ratio" class="quarto-xref">Equation&nbsp;<span>8.62</span></a> with B, we have (neglecting the left-hand side)</p>
<p><span class="math display">\[
\begin{aligned}
0 &amp;= qn[\mathbf{E}\times\mathbf{B}+(\mathbf{u}_\perp\times\mathbf{B})\times\mathbf{B}] - \nabla p\times\mathbf{B} \\
&amp;= qn[\mathbf{E}\times\mathbf{B}+\mathbf{B}(\cancel{\mathbf{u}_\perp\cdot\mathbf{B}})-\mathbf{u}_\perp\mathbf{B}^2] - \nabla p\times\mathbf{B} \\
&amp;= qn[\mathbf{E}\times\mathbf{B}-\mathbf{u}_\perp\mathbf{B}^2] - \nabla p\times\mathbf{B}
\end{aligned}
\]</span></p>
<p>Therefore, <span class="math display">\[
\mathbf{u}_\perp = \frac{\mathbf{E}\times\mathbf{B}}{B^2} -\frac{\nabla p \times\mathbf{B}}{qnB^2} \equiv \mathbf{u}_E + \mathbf{u}_D
\]</span> where <span class="math display">\[
\mathbf{u}_E\equiv\frac{\mathbf{E}\times\mathbf{B}}{B^2}\quad\mathbf{E}\times\mathbf{B}\,\text{drift}
\]</span></p>
<p><span id="eq-diamagnetic_drift"><span class="math display">\[
\mathbf{u}_D\equiv-\frac{\nabla p\times\mathbf{B}}{qnB^2}\quad\text{Diamagnetic drift}
\tag{8.63}\]</span></span></p>
<p>The drift <span class="math inline">\(\mathbf{u}_E\)</span> is the same as for guiding centers, but there is now a new drift <span class="math inline">\(\mathbf{u}_D\)</span>, called the diamagnetic drift. Since <span class="math inline">\(\mathbf{u}_D\)</span> is perpendicular to the direction of the gradient, our neglect of <span class="math inline">\((\mathbf{u}\cdot\nabla)\mathbf{u}\)</span> is justified if <span class="math inline">\(\mathbf{E}=0\)</span>. If <span class="math inline">\(\mathbf{E}=-\nabla\phi\neq 0\)</span> (i.e.&nbsp;a potential field), <span class="math inline">\((\mathbf{u}\cdot\nabla)\mathbf{u}\)</span> is still zero if <span class="math inline">\(\nabla\phi\)</span> and <span class="math inline">\(\nabla p\)</span> are in the same direction; otherwise, there could be a more complicated solution involving <span class="math inline">\((\mathbf{u}\cdot\nabla)\mathbf{u}\)</span>.</p>
<p>With the help of <a href="#eq-eos_nabla_p" class="quarto-xref">Equation&nbsp;<span>8.12</span></a>, we can write the diamagnetic drift as <span id="eq-diamagnetic_drift_eos"><span class="math display">\[
\mathbf{u}_D = \pm \frac{\gamma k_B T}{eB}\frac{\hat{z}\times\nabla n}{n}
\tag{8.64}\]</span></span></p>
<p>In particular, for an isothermal plasma in the geometry of Fig.3.4 (ADD IT!), in which <span class="math inline">\(\nabla n = \partial n\partial r\hat{r} = n^\prime\hat{r}\)</span> (<span class="math inline">\(n^\prime &lt; 0\)</span>), we have the following formulas familiar to experimentalists who have worked with Q-machines <span class="math display">\[
\begin{aligned}
\mathbf{u}_{Di} &amp;= \frac{k_B T_i}{eB}\frac{n^\prime}{n}\hat{\theta} \\
\mathbf{u}_{De} &amp;= -\frac{k_B T_e}{eB}\frac{n^\prime}{n}\hat{\theta}
\end{aligned}
\]</span></p>
<p>The physical reason for this drift can be seen from <a href="#fig-diamagnetic-drift" class="quarto-xref">Figure&nbsp;<span>8.2</span></a>. Here we have drawn the orbits of ions gyrating in a magnetic field. There is a density gradient toward the left, as indicated by the density of orbits. Through any fixed volume element there are more ions moving downward than upward, since the downward-moving ions come from a region of higher density. There is, therefore, a fluid drift perpendicular to <span class="math inline">\(\nabla n\)</span> and <span class="math inline">\(\mathbf{B}\)</span>, <em>even though the guiding centers are stationary</em>. The diamagnetic drift reverses sign with <span class="math inline">\(q\)</span> because the direction of gyration reverses. The magnitude of <span class="math inline">\(\mathbf{u}_D\)</span> does not depend on mass because the <span class="math inline">\(m^{-1/2}\)</span> dependence of the velocity is cancelled by the <span class="math inline">\(m^{1/2}\)</span> dependence of the Larmor radius—less of the density gradient is sampled during a gyration if the mass is small.</p>
<div id="fig-diamagnetic-drift" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-diamagnetic-drift-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="../images/origin_diamagnetic_drift.jpeg" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-diamagnetic-drift-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8.2: Origin of the diamagnetic drift.
</figcaption>
</figure>
</div>
<p>Since ions and electrons drift in opposite directions, there is a diamagnetic current. For <span class="math inline">\(\gamma=Z=1\)</span>, this is given by <span id="eq-diamagnetic_curent"><span class="math display">\[
\mathbf{J}_D = ne(\mathbf{u}_{Di} + \mathbf{u}_{De}) = \frac{\mathbf{B}}{B^2}\times\nabla\left( p_i + p_e \right) = (k_B T_i + k_B T_e)\frac{\mathbf{B}\times\nabla n}{B^2}
\tag{8.65}\]</span></span></p>
<p>In the particle picture, one would not expect to measure a current if the guiding centers do not drift. In the fluid picture, the current <span class="math inline">\(\mathbf{J}_D\)</span> flows wherever there is a pressure gradient. These two viewpoints can be reconciled if one considers that all experiments must be carried out in a finite-sized plasma. Suppose the plasma were in a rigid box (Fig. 3.6 ADD IT!). If one were to calculate the current from the single-particle picture, one would have to take into account the particles at the edges which have cycloidal paths. Since there are more particles on the left than on the right, there is a net current downward, in agreement with the fluid picture.</p>
<p>The reader may not be satisfied with this explanation because it was necessary to specify reflecting walls. If the walls were absorbing or if they were removed, one would find that electric fields would develop because more of one species—the one with larger Larmor radius—would collected than the other. Then the guiding centers would drift, and the simplicity of the model would be lost. Alternatively, one could imagine trying to measure the diamagnetic current with a current probe (Fig. 3.7 ADD IT!). This is just a transformer with a core of magnetic material. The primary winding is the plasma current threading the core, and the secondary is a multiturn winding all around the core. Let the whole thing be infinitesimally thin, so it does not intercept any particles. It is clear from Fig. 3.7 that a net upward current would be measured, there being higher density on the left than on the right, so that the diamagnetic current is a real current. From this example, one can see that it can be quite tricky to work with the single-particle picture. The fluid theory usually gives the right results when applied straightforwardly, even though it contains “fictitious” drifts like the diamagnetic drift.</p>
<p>What about the grad-B and curvature drifts which appeared in the single-particle picture? The curvature drift also exists in the fluid picture, since the centrifugal force is felt by all the particles in a fluid element as they move around a bend in the magnetic field. A term <span class="math inline">\(\bar{F}_{cf} = \overline{nmv_\parallel^2}/R_c = nk_B T_\parallel / R_c\)</span> has to be added to the right-hand side of the fluid equation of motion. This is equivalent to a gravitational force <span class="math inline">\(mng\)</span>, with <span class="math inline">\(g = k_BT_\parallel/m R_c\)</span>, and leads to a drift <span class="math inline">\(\mathbf{u}_g=(m/q)(\mathbf{g}\times\mathbf{B})/B^2\)</span>, as in the particle picture (<a href="single.html#eq-gravity_drift" class="quarto-xref">Equation&nbsp;<span>7.5</span></a>).</p>
<div id="fig-nonuniform-B-no-grad-drift" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-nonuniform-B-no-grad-drift-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="../images/grad-B_no_drift_nonuniform_B.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-nonuniform-B-no-grad-drift-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8.3: In a nonuniform B field the guiding centers drift but the fluid elements do not.
</figcaption>
</figure>
</div>
<p>The grad-B drift, however, does not exist for fluids. It can be shown on thermodynamic grounds that a magnetic field does not affect a Maxwellian distribution. This is because the Lorentz force is perpendicular to <span class="math inline">\(\mathbf{v}\)</span> and cannot change the energy of any particle. The most probable distribution <span class="math inline">\(f(\mathbf{v})\)</span> in the absence of <span class="math inline">\(\mathbf{B}\)</span> is also the most probable distribution in the presence of <span class="math inline">\(\mathbf{B}\)</span>. If <span class="math inline">\(f(\mathbf{v})\)</span> remains Maxwellian in a nonuniform <span class="math inline">\(\mathbf{B}\)</span> field, and there is no density gradient, then the net momentum carried into any fixed fluid element is zero. There is no fluid drift even though the individual guiding centers have drifts; the particle drift in any fixed fluid element cancel out. To see this pictorially, consider the orbits of two particles moving through a fluid element in a nonuniform <span class="math inline">\(\mathbf{B}\)</span> field (<a href="#fig-nonuniform-B-no-grad-drift" class="quarto-xref">Figure&nbsp;<span>8.3</span></a>). Since there is no <span class="math inline">\(\mathbf{E}\)</span> field, the Larmor radius changes only because of the gradient in B; there is no acceleration, and the particle energy remains constant during the motion. If the two particles have the same energy, they will have the same velocity and Larmor radius while inside the fluid element. There is thus a perfect cancellation between particle pairs when their velocities are added to give the fluid velocity.</p>
<p>When there is a nonuniform <span class="math inline">\(\mathbf{E}\)</span> field, it is not easy to reconcile the fluid and particle pictures. Then the finite-Larmor-radius effect of <a href="single.html#sec-nonuniform_E" class="quarto-xref"><span>Section 7.3</span></a> causes both a guiding center drift and a fluid drift, but these are not the same; in fact, they have opposite signs! The particle drift was calculated in <a href="single.html" class="quarto-xref"><span>Chapter 7</span></a>, and the fluid drift can be calculated from the off-diagonal elements of <span class="math inline">\(\mathbf{P}\)</span>. It is extremely difficult to explain how the finite-Larmor-radius effects differ. A simple picture like Fig. 3.6 will not work because one has to take into account subtle points like the following: in the absence of a density gradient, the density of guiding centers is not the same as the density of particles! (???)</p>
<p>(I need to think carefully about these pictures.)</p>
</section>
<section id="fluid-drifts-parallel-to-b" class="level2" data-number="8.8">
<h2 data-number="8.8" class="anchored" data-anchor-id="fluid-drifts-parallel-to-b"><span class="header-section-number">8.8</span> Fluid Drifts Parallel to B</h2>
<p>The <span class="math inline">\(z\)</span> component of the fluid equation of motions is <span id="eq-fluid_momentum_parallel"><span class="math display">\[
mn\left[ \frac{\partial u_z}{\partial t} + (\mathbf{u}\cdot\nabla)u_z\right] = qn E_z - \frac{\partial\phi}{\partial z}
\tag{8.66}\]</span></span></p>
<p>The convective term can often be neglected because it is much smaller than the <span class="math inline">\(\partial u_z/\partial t\)</span> term. We shall avoid complicated arguments here and simply consider cases in which <span class="math inline">\(u_z\)</span> is spatially uniform. Using <a href="#eq-fluid_momentum_parallel" class="quarto-xref">Equation&nbsp;<span>8.66</span></a>, we have <span id="eq-fluid_momentum_parallel_simple"><span class="math display">\[
\frac{\partial u_z}{\partial t} = \frac{q}{m}E_z - \frac{\gamma k_B T}{mn}\frac{\partial n}{\partial z}
\tag{8.67}\]</span></span></p>
<p>This shows that the fluid is accelerated along <span class="math inline">\(\mathbf{B}\)</span> under the combined electrostatic and pressure gradient forces. A particularly important result is obtained by applying <a href="#eq-fluid_momentum_parallel_simple" class="quarto-xref">Equation&nbsp;<span>8.67</span></a> to massless electrons. Taking the limit <span class="math inline">\(m\rightarrow 0\)</span> and specifying <span class="math inline">\(q=-e\)</span> and <span class="math inline">\(\mathbf{E}=-\nabla\phi\)</span>, we have <span class="math display">\[
qE_z = e\frac{\partial\phi}{\partial z} = \frac{\gamma k_B T_e}{n}\frac{\partial n}{\partial z}
\]</span></p>
<p>Electrons are so mobile that their heat conductivity is almost infinite. We may then assume isothermal electrons and take <span class="math inline">\(\gamma = 1\)</span>. Integrating, we have <span class="math display">\[
e\phi = k_B T_e \ln n + C
\]</span> or <span id="eq-boltzmann_relation"><span class="math display">\[
n = n_0 \exp(e\phi/k_B T_e)
\tag{8.68}\]</span></span></p>
<p>This is just the <em>Boltzmann relation</em> for electrons.</p>
<p>What this means physically is that electrons, being light, are very mobile and would be accelerated to high energies very quickly if there were a net force on them. Since electrons cannot leave a region en masse without leaving behind a large ion charge, the electrostatic and pressure gradient forces on the electrons must be closely in balance. This condition leads to the Boltzmann relation. Note that <a href="#eq-boltzmann_relation" class="quarto-xref">Equation&nbsp;<span>8.68</span></a> <em>applies to each magnetic field lines separately</em>. Different field lines may be charged to different potentials arbitrarily unless a mechanism is provided for the electrons to move across <span class="math inline">\(\mathbf{B}\)</span>. The conductors on which field lines terminate can provide such a mechanism, and the experimentalist has to take these end effects into account carefully.</p>
<div id="fig-boltzmann-relation" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-boltzmann-relation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="../images/boltzmann_relation.png" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-boltzmann-relation-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8.4: Physical reason for the Boltzmann relation between density and potential.
</figcaption>
</figure>
</div>
<p><a href="#fig-boltzmann-relation" class="quarto-xref">Figure&nbsp;<span>8.4</span></a> shows graphically what occurs when there is a local density clump in the plasma. Let the density gradient be toward the center of the diagram, and suppose <span class="math inline">\(k_B T\)</span> is constant. There is then a pressure gradient toward the center. Since the plasma is quasineutral, the gradient exists for both the electron and ion fluids. Consider the pressure gradient force <span class="math inline">\(\mathbf{F}_p\)</span> on the electron fluid. It drives the mobile electrons away from the center, leaving the ions behind. The resulting positive charge generates a field <span class="math inline">\(\mathbf{E}\)</span> whose force <span class="math inline">\(\mathbf{F}_E\)</span> on the electrons opposes <span class="math inline">\(\mathbf{F}_p\)</span>. Only when <span class="math inline">\(\mathbf{F}_E = -\mathbf{F}_p\)</span> is a steady state achieved. If <span class="math inline">\(\mathbf{B}\)</span> is a constant, <span class="math inline">\(\mathbf{E}\)</span> is an electrostatic field <span class="math inline">\(\mathbf{E}=-\nabla\phi\)</span>, and <span class="math inline">\(\phi\)</span> must be large at the center, where <span class="math inline">\(n\)</span> is large. This is just what <a href="#eq-boltzmann_relation" class="quarto-xref">Equation&nbsp;<span>8.68</span></a> tells us. The deviation from stric neutrality adjusts itself so that there is just enough charge to set up the <span class="math inline">\(\mathbf{E}\)</span> field required to balance the forces on the electrons.</p>
</section>
<section id="sec-plasma_approximation" class="level2" data-number="8.9">
<h2 data-number="8.9" class="anchored" data-anchor-id="sec-plasma_approximation"><span class="header-section-number">8.9</span> The Plasma Approximation</h2>
<p>The previous example reveals an important characteristic of plasmas that has wide application. We are used to solving for <span class="math inline">\(\mathbf{E}\)</span> from Poisson’s equation when we are given the charge density <span class="math inline">\(\sigma\)</span>. In a plasma, the opposite procedure is generally used. <span class="math inline">\(\mathbf{E}\)</span> is found from the equations of motion, and Poisson’s equation is used only to find <span class="math inline">\(\sigma\)</span>. The reason is that a plasma has an overriding tendency to remain neutral. If the ions move, the electrons will follow. <span class="math inline">\(\mathbf{E}\)</span> must adjust itself so that the orbits of the electrons and ions preserve neutrality. The charge density is of secondary importance; it will adjust itself so that Poisson’s equation is satisfied. This is true, of course, only for low-frequency motions in which the electron inertia is not a factor.</p>
<p>In a plasma, it is usually possible to assume <span class="math inline">\(n_i=n_e\)</span> and <span class="math inline">\(\nabla\cdot\mathbf{E}\neq 0\)</span> at the same time. We shall call this the <em>plasma approximation</em>. It is a fundamental trait of plasmas, one which is difficult for the novice to understand. <em>Do not use Poisson’s equation to obtain <span class="math inline">\(\mathbf{E}\)</span> unless it is unavoidable</em>! In the set of fluid equations <a href="#eq-fluid_set" class="quarto-xref">Equation&nbsp;<span>8.13</span></a>, we may now eliminate Poisson’s equation and also eliminate one of the unknowns by setting <span class="math inline">\(n_i = n_e = n\)</span>.</p>
<p>The <em>plasma approximation</em> is almost the same as the condition of quasineutrality discussed earlier but has a more exact meaning. Whereas quasineutrality refers to a general tendency for a plasma to be neutral in its state of rest, the plasma approximation is a mathematical shortcut that one can use even for wave motions. As long as these motions are slow enough that both ions and electrons have time to move, it is a good approximation to replace Poisson’s equation by the equation <span class="math inline">\(n_i=n_e\)</span>. Of course, if only one species can move and the other cannot follow, such as in high-frequency electron waves, then the plasma approximation is not valid, and <span class="math inline">\(\mathbf{E}\)</span> must be found from Maxwell’s <a href="#eq-maxwell_vacuum" class="quarto-xref">Equation&nbsp;<span>8.1</span></a> rather than from the ion and electron equations of motion. Ampère’s law with the displacement current retained gives the time evolution of <span class="math inline">\(\mathbf{E}\)</span>:</p>
<p><span class="math display">\[
\frac{\mathrm{d}\mathbf{E}}{\mathrm{d}t} = \frac{1}{\epsilon_0}\left( \frac{\nabla\times\mathbf{B}}{\mu_0} - \mathbf{J} \right)
\]</span></p>
<p>We shall return to the question of the validity of the plasma approximation when we come to the theory of ion waves. At that time, it will become clear why we had to use Poisson’s equation in the derivation of Debye shielding. For electron waves, we can also show that with a simple “modified” electron test particle model that updates the electric field while keeping the magnetic field constant, we can retain the plasma oscillation and electron Berstein wave.</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-bellan2008fundamentals" class="csl-entry" role="listitem">
Bellan, Paul M. 2008. <em>Fundamentals of Plasma Physics</em>. Cambridge University Press.
</div>
<div id="ref-chen2016introduction" class="csl-entry" role="listitem">
Chen, Francis F. 2016. <em>Introduction to Plasma Physics and Controlled Fusion</em>. Vol. 1. Springer.
</div>
<div id="ref-cgl1956" class="csl-entry" role="listitem">
Chew, GF, ML Goldberger, and FE Low. 1956. <span>“The Boltzmann Equation and the One-Fluid Hydromagnetic Equations in the Absence of Particle Collisions.”</span> <em>Proceedings of the Royal Society of London. Series A. Mathematical and Physical Sciences</em> 236 (1204): 112–18. <a href="https://doi.org/10.1098/rspa.1956.0116">https://doi.org/10.1098/rspa.1956.0116</a>.
</div>
<div id="ref-wang2020exact" class="csl-entry" role="listitem">
Wang, Liang, Ammar H Hakim, Jonathan Ng, Chuanfei Dong, and Kai Germaschewski. 2020. <span>“Exact and Locally Implicit Source Term Solvers for Multifluid-Maxwell Systems.”</span> <em>Journal of Computational Physics</em> 415: 109510. <a href="https://doi.org/10.1016/j.jcp.2020.109510">https://doi.org/10.1016/j.jcp.2020.109510</a>.
</div>
</div>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>We have put a subscript m on the permeability to distinguish it from the adiabatic invariant <span class="math inline">\(\mu\)</span>.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>the Darwin approximation ignores light waves by neglecting <span class="math inline">\(\partial\mathbf{E}\partial t\)</span> in Amperè’s law.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>In the case of discontinuities, adiabatic laws fail to describe the jump, and the energy equation needs to be used due to its conservation property.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>This is slightly different in some terms compared to <a href="#eq-6-moment-fluids" class="quarto-xref">Equation&nbsp;<span>8.14</span></a>. Meng Xing mentioned in the BATSRUS anistropic MHD paper that the polytropic index is taken to be 5/3. Also note that here the unknown is the total pressure <span class="math inline">\(p\)</span> instead of perpendicular pressure <span class="math inline">\(p_\perp\)</span>.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../contents/single.html" class="pagination-link" aria-label="Single-Particle Motions">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Single-Particle Motions</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../contents/diffres.html" class="pagination-link" aria-label="Diffusion and Resisvity">
        <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Diffusion and Resisvity</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/henry2004y/KeyNotes/edit/master/contents/fluid.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li></ul></div></div></div></footer></body></html>